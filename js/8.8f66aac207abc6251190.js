(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{579:function(e,t,a){(t=a(5)(!1)).push([e.i,".error{color:var(--pf-global--danger-color--100)}.pf-c-content h3{margin-top:var(--pf-global--spacer--xl);margin-bottom:var(--pf-global--spacer--md)}@media screen and (min-width: 576px){.pf-c-content dl{grid-template:1fr / 25% 1fr;grid-gap:var(--pf-global--spacer--sm)}}\n",""]),e.exports=t},618:function(e,t,a){var n=a(579);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0},r=a(6)(n,i);n.locals&&(e.exports=n.locals),e.hot.accept(579,(function(){var t=a(579);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var a,n=0;for(a in e){if(!t||e[a]!==t[a])return!1;n++}for(a in t)n--;return 0===n}(n.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");r(t)})),e.hot.dispose((function(){r()}))},619:function(e,t,a){"use strict";a.r(t);var n=a(614),i=a.n(n),r=a(243),s=a.n(r),o=a(343),l=a.n(o),u=a(177),c=a.n(u),p=a(178),d=a.n(p),b=a(420),m=a.n(b),h=a(179),v=a.n(h),f=a(133),g=a.n(f),E=a(180),y=a.n(E),w=a(21),S=a.n(w),R=a(1),k=a.n(R),N=a(120),x=a(164),C=a(591),U=a(388),_=a(358),z=a(331),j=a(359),A=a(354),I=a(360),q=function(e){return k.a.createElement(_.a,null,k.a.createElement(z.a,{headingLevel:"h2",size:"xl"},"Image output"),k.a.createElement(j.a,{isRequired:!0,label:"Release",fieldId:"release-select"},k.a.createElement(A.a,{value:e.value,onChange:function(t){return e.setRelease(t)},isRequired:!0,"aria-label":"Select release input",id:"release-select","data-testid":"release-select"},[{value:"rhel-8",label:"Red Hat Enterprise Linux (RHEL) 8.3"}].map((function(e){return k.a.createElement(I.a,{key:e.value,value:e.value,label:e.label})})))),k.a.createElement(j.a,{isRequired:!0,label:"Target environment",fieldId:"upload-destination"},k.a.createElement(A.a,{value:e.upload.type||"",id:"upload-destination","data-testid":"upload-destination",isRequired:!0,onChange:function(t){return e.setUpload({type:t,options:e.upload.options})},"aria-label":"Select upload destination"},[{value:"aws",label:"Amazon Web Services"}].map((function(e){return k.a.createElement(I.a,{key:e.value,value:e.value,label:e.label})})))))};q.propTypes={setRelease:S.a.func,value:S.a.string,upload:S.a.object,setUpload:S.a.func};var O=q,T=a(353),D=function(e){return k.a.createElement(_.a,null,k.a.createElement(z.a,{headingLevel:"h2",size:"xl"},"Upload to AWS"),k.a.createElement("p",null,"Your image will be uploaded to a temporary account on Amazon Web Services. The image will be shared with the account ID you provide below. ",k.a.createElement("br",null),"Within the next 14 days you will need to copy the shared image to your own account. After 14 days it will be unavailable and will have to be regenerated."),k.a.createElement(j.a,{isRequired:!0,label:"AWS account ID",fieldId:"aws-account-id",helperTextInvalid:e.errors["aws-account-id"]&&e.errors["aws-account-id"].value||"",validated:e.errors["aws-account-id"]?"error":"default"},k.a.createElement(T.a,{value:e.upload.options.share_with_accounts||"",type:"text","aria-label":"AWS account ID",id:"aws-account-id","data-testid":"aws-account-id",isRequired:!0,onChange:function(t){return e.setUploadOptions(Object.assign(e.upload.options,{share_with_accounts:[t]}))}})))};D.propTypes={setUploadOptions:S.a.func,upload:S.a.object,errors:S.a.object};var W=D,L=a(363),F=function(e){return k.a.createElement(_.a,null,k.a.createElement(z.a,{headingLevel:"h2",size:"xl"},"Registration"),k.a.createElement(j.a,{isRequired:!0,label:"Register the system"},k.a.createElement(L.a,{name:"subscribe-now-radio",isChecked:e.subscribeNow,id:"subscribe-now-radio",label:"Embed an activation key and register systems on first boot",onChange:function(){return e.setSubscribeNow(!0)},"data-testid":"register-now-radio-button"}),k.a.createElement(L.a,{name:"subscribe-later-radio",isChecked:!e.subscribeNow,label:"Register the system later",id:"subscribe-later-radio",onChange:function(){return e.setSubscribeNow(!1)},"data-testid":"register-later-radio-button"})),e.subscribeNow&&k.a.createElement(k.a.Fragment,null,k.a.createElement(j.a,{label:"Organization ID",fieldId:"subscription-organization"},k.a.createElement(T.a,{isDisabled:!0,value:e.subscription.organization||"",type:"text",id:"subscription-organization","aria-label":"Subscription organization ID","data-testid":"organization-id"})),k.a.createElement(j.a,{isRequired:!0,label:"Activation key",fieldId:"subscription-activation",helperTextInvalid:e.errors["subscription-activation"]&&e.errors["subscription-activation"].value||"",validated:e.errors["subscription-activation"]?"error":"default"},k.a.createElement(T.a,{value:e.subscription["activation-key"]||"",type:"password","data-testid":"subscription-activation",isRequired:!0,id:"subscription-activation","aria-label":"Subscription activation key",onChange:function(t){return e.setSubscription(Object.assign(e.subscription,{"activation-key":t}))}}))))};F.propTypes={setSubscription:S.a.func,setSubscribeNow:S.a.func,subscription:S.a.object,subscribeNow:S.a.bool,errors:S.a.object};var H=F,J=a(580),M=a.n(J),B=a(386),G=a(364),P=a(108),Y=(a(618),function(e){return k.a.createElement(k.a.Fragment,null,(Object.keys(e.uploadErrors).length>0||Object.keys(e.subscriptionErrors).length>0)&&k.a.createElement(B.a,{variant:"danger",className:"pf-u-mb-xl",isInline:!0,title:"Required information is missing"}),k.a.createElement(z.a,{headingLevel:"h2",size:"xl"},"Create image"),k.a.createElement(G.a,null,k.a.createElement("small",null,"Review the information and click Create image to create the image using the following criteria."),k.a.createElement("h3",null,"Image output"),k.a.createElement("dl",null,k.a.createElement("dt",null,"Release"),k.a.createElement("dd",null,{"rhel-8":"Red Hat Enterprise Linux (RHEL) 8.3"}[e.release]),k.a.createElement("dt",null,"Target environment"),k.a.createElement("dd",null,e.upload&&k.a.createElement(k.a.Fragment,null,{aws:"Amazon Web Services"}[e.upload.type]))),Object.entries(e.uploadErrors).length>0&&k.a.createElement("h3",null,"Upload to AWS"),k.a.createElement("dl",null,Object.entries(e.uploadErrors).map((function(e){var t=M()(e,2),a=t[0],n=t[1];return k.a.createElement(k.a.Fragment,{key:a},k.a.createElement("dt",null,n.label),k.a.createElement("dd",null,k.a.createElement(P.a,{className:"error"})," ",n.value))}))),k.a.createElement("h3",null,"Registration"),k.a.createElement("dl",null,k.a.createElement("dt",null,"Subscription"),!e.subscribeNow&&k.a.createElement("dd",null,"Register the system later"),e.subscribeNow&&k.a.createElement("dd",null,"Register the system on first boot"),Object.entries(e.subscriptionErrors).map((function(e){var t=M()(e,2),a=t[0],n=t[1];return k.a.createElement(k.a.Fragment,{key:a},k.a.createElement("dt",null,n.label),k.a.createElement("dd",null,k.a.createElement(P.a,{className:"error"})," ",n.value))})))))});Y.propTypes={release:S.a.string,upload:S.a.object,subscription:S.a.object,subscribeNow:S.a.bool,uploadErrors:S.a.object,subscriptionErrors:S.a.object};var K=Y,Q=a(592);function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var X=function(e){y()(r,e);var t,a,n=(t=r,function(){var e,a=g()(t);if(V()){var n=g()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return v()(this,e)});function r(e){var t;return c()(this,r),(t=n.call(this,e)).setRelease=t.setRelease.bind(m()(t)),t.setUpload=t.setUpload.bind(m()(t)),t.setUploadOptions=t.setUploadOptions.bind(m()(t)),t.setSubscription=t.setSubscription.bind(m()(t)),t.setSubscribeNow=t.setSubscribeNow.bind(m()(t)),t.onStep=t.onStep.bind(m()(t)),t.onSave=t.onSave.bind(m()(t)),t.onClose=t.onClose.bind(m()(t)),t.validate=t.validate.bind(m()(t)),t.validateUploadAmazon=t.validateUploadAmazon.bind(m()(t)),t.validateSubscription=t.validateSubscription.bind(m()(t)),t.state={release:"rhel-8",upload:{type:"aws",options:{share_with_accounts:[]}},subscription:{organization:null,"activation-key":null,"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/",insights:!0},subscribeNow:!0,uploadErrors:{},subscriptionErrors:{}},t}return d()(r,[{key:"componentDidMount",value:(a=l()(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.chrome.auth.getUser();case 2:t=e.sent,this.setState({subscription:{organization:Number(t.identity.internal.org_id)}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onStep",value:function(e){"Review"===e.name&&this.validate()}},{key:"validate",value:function(){"aws"===this.state.upload.type?this.validateUploadAmazon():this.setState({uploadErrors:{}}),this.state.subscribeNow?this.validateSubscription():this.setState({subscriptionErrors:{}})}},{key:"validateUploadAmazon",value:function(){var e={},t=this.state.upload.options.share_with_accounts;(0===t.length||12!==t[0].length||isNaN(t[0]))&&(e["aws-account-id"]={label:"AWS account ID",value:"A 12-digit number is required"}),this.setState({uploadErrors:e})}},{key:"validateSubscription",value:function(){var e={};this.state.subscription["activation-key"]||(e["subscription-activation"]={label:"Activation key",value:"A value is required"}),this.setState({subscriptionErrors:e})}},{key:"setRelease",value:function(e){this.setState({release:e})}},{key:"setUpload",value:function(e){this.setState({upload:e})}},{key:"setUploadOptions",value:function(e){this.setState((function(t){return{upload:{type:t.upload.type,options:e}}}))}},{key:"setSubscribeNow",value:function(e){this.setState({subscribeNow:e})}},{key:"setSubscription",value:function(e){this.setState({subscription:e},this.validate)}},{key:"onSave",value:function(){var e=this,t={distribution:this.state.release,image_requests:[{architecture:"x86_64",image_type:"qcow2",upload_requests:[{type:"aws",options:{share_with_accounts:this.state.upload.options.share_with_accounts}}]}],customizations:{subscription:this.state.subscription}},a=this.props.updateCompose;Q.a.composeImage(t).then((function(n){var i={};i[n.id]={status:"request sent",distribution:t.distribution,architecture:t.image_requests[0].architecture,image_type:t.image_requests[0].image_type},a(i),e.props.history.push("/landing")}))}},{key:"onClose",value:function(){this.props.history.push("/landing")}},{key:"render",value:function(){var e={name:"Image output",component:k.a.createElement(O,{value:this.state.release,upload:this.state.upload,setRelease:this.setRelease,setUpload:this.setUpload})},t={name:"Upload to AWS",component:k.a.createElement(W,{upload:this.state.upload,setUploadOptions:this.setUploadOptions,errors:this.state.uploadErrors})},a=[e].concat(i()("aws"===this.state.upload.type?[t]:[]),[{name:"Registration",component:k.a.createElement(H,{subscription:this.state.subscription,subscribeNow:this.state.subscribeNow,setSubscription:this.setSubscription,setSubscribeNow:this.setSubscribeNow,errors:this.state.subscriptionErrors})},{name:"Review",component:k.a.createElement(K,{release:this.state.release,upload:this.state.upload,subscription:this.state.subscription,subscribeNow:this.state.subscribeNow,uploadErrors:this.state.uploadErrors,subscriptionErrors:this.state.subscriptionErrors}),nextButtonText:"Create"}]);return k.a.createElement(k.a.Fragment,null,k.a.createElement(U.a,{title:"Create image",onNext:this.onStep,onGoToStep:this.onStep,steps:a,onClose:this.onClose,onSave:this.onSave,isOpen:!0}))}}]),r}(R.Component);X.propTypes={updateCompose:S.a.func,history:S.a.object};t.default=Object(x.connect)(null,(function(e){return{updateCompose:function(t){return e(C.a.updateCompose(t))}}}))(Object(N.o)(X))}}]);
//# sourceMappingURL=8.8f66aac207abc6251190.js.map