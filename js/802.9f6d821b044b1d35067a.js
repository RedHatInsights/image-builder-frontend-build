(self.webpackChunkimage_builder=self.webpackChunkimage_builder||[]).push([[802],{19697:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ft});var a=n(4942),r=n(29439),i=n(15861),o=n(93433),l=n(64687),s=n.n(l),c=n(93264),u=n.n(c),m=n(96354),d=n(83215),p=n(86706),g=n(74175),f=n(87462),v=n(45987),h=n(80124),b=n(67850),y=n(54915),E=n(79442),T=n(3669),w=n(45697),x=n.n(w),S=n(41693),k=n(48880),I=n(87248),Z=["label","isRequired"],C=function(e){var t,n,a=e.label,i=e.isRequired,o=(0,v.Z)(e,Z),l=(0,k.default)(),s=l.change,m=l.getState,d=(0,S.Z)(o).input,p=(0,c.useState)([]),g=(0,r.Z)(p,2),f=g[0],h=g[1],b=(0,c.useState)(!1),y=(0,r.Z)(b,2),E=y[0],w=y[1],x=(0,c.useState)(!1),C=(0,r.Z)(x,2),L=C[0],A=C[1],P=(0,c.useState)(null===(t=m())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["subscription-activation-key"]),_=(0,r.Z)(P,2),O=_[0],R=_[1];return(0,c.useEffect)((function(){A(!0),I.Z.getActivationKeys().then((function(e){h(e),A(!1)})),insights.chrome.isProd()?(s("subscription-server-url","subscription.rhsm.redhat.com"),s("subscription-base-url","https://cdn.redhat.com/")):(s("subscription-server-url","subscription.rhsm.stage.redhat.com"),s("subscription-base-url","https://cdn.stage.redhat.com/"))}),[]),u().createElement(T.FormGroup,{isRequired:i,label:a,"data-testid":"subscription-activation-key"},u().createElement(T.Select,{variant:T.SelectVariant.typeahead,onToggle:function(){return w(!E)},onSelect:function(e,t){R(t),w(!1),s(d.name,t)},onClear:function(){R(),s(d.name,void 0)},selections:O,isOpen:E,placeholderText:"Select activation key",typeAheadAriaLabel:"Select activation key"},L&&u().createElement(T.SelectOption,{isNoResultsOption:!0,"data-testid":"activation-keys-loading"},u().createElement(T.Spinner,{isSVG:!0,size:"lg"})),f.map((function(e,t){return u().createElement(T.SelectOption,{key:t,value:e.name})}))))};C.propTypes={label:x().node,isRequired:x().bool},C.defaultProps={label:"",isRequired:!1};const L=C;var A=n(52183),P=["label","isRequired","className"],_=function(e){var t,n,a,i=e.label,o=e.isRequired,l=e.className,s=(0,v.Z)(e,P),m=(0,k.default)(),d=m.change,p=m.getState,g=(0,S.Z)(s).input,f=(0,c.useState)(!1),h=(0,r.Z)(f,2),b=h[0],y=h[1],E=(0,c.useState)(null===(t=p())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["aws-sources-select"]),w=(0,r.Z)(E,2),x=w[0],I=w[1],Z=(0,A.Xq)(),C=Z.data,L=Z.isFetching,_=Z.isSuccess,O=Z.isError,R=Z.refetch;return u().createElement(u().Fragment,null,u().createElement(T.FormGroup,{isRequired:o,label:i,"data-testid":"sources",className:l},u().createElement(T.Select,{ouiaId:"source_select",variant:T.SelectVariant.typeahead,onToggle:function(){b||R(),y(!b)},onSelect:function(e,t){var n=C.find((function(e){return e.name===t})).id;I(n),y(!1),d(g.name,n)},onClear:function(){I(),d(g.name,void 0)},selections:x?null===(a=C.find((function(e){return e.id===x})))||void 0===a?void 0:a.name:void 0,isOpen:b,placeholderText:"Select source",typeAheadAriaLabel:"Select source",menuAppendTo:"parent",maxHeight:"25rem",isDisabled:!_},_&&C.map((function(e){return u().createElement(T.SelectOption,{key:e.id,value:e.name,description:e.account_id})})),L&&u().createElement(T.SelectOption,{isNoResultsOption:!0},u().createElement(T.Spinner,{isSVG:!0,size:"lg"})))),u().createElement(u().Fragment,null,O&&u().createElement(T.Alert,{variant:"danger",isPlain:!0,isInline:!0,title:"Sources unavailable"},"Sources cannot be reached, try again later or enter an AWS account ID manually.")))};_.propTypes={className:x().string,label:x().node,isRequired:x().bool};const O=function(){var e,t,n=null===(e=(0,(0,k.default)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["azure-tenant-id"],a=new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i");return u().createElement(T.FormGroup,null,u().createElement(T.Button,{component:"a",target:"_blank",variant:"secondary",isDisabled:!a.test(n),href:"https://login.microsoftonline.com/"+n+"/oauth2/v2.0/authorize?client_id=b94bb246-b02c-4985-9c22-d44e66f657f4&scope=openid&response_type=code&response_mode=query&redirect_uri=https://portal.azure.com"},"Authorize Image Builder"))};var R=n(50470),z=function(){return u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://developers.redhat.com/about"},"Red Hat Developer Program")};const D=function(){return u().createElement(T.Alert,{variant:"info",isPlain:!0,isInline:!0,title:u().createElement(u().Fragment,null,"CentOS Stream builds are intended for the development of future versions of RHEL and are not supported for production workloads or other use cases.")},u().createElement("p",null,"Join the ",u().createElement(z,null)," to learn about paid and no-cost RHEL subscription options."))};var N=n(6468),j=function(){var e=(0,N.XQ)(),t=e.getState,n=e.change,a=t().values["aws-sources-select"],r=(0,A.Xq)().data;return(0,c.useEffect)((function(){if(a){var e,i=null===(e=r.find((function(e){var n,a;return e.id===(null===(n=t())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["aws-sources-select"])})))||void 0===e?void 0:e.account_id;n("aws-associated-account-id",i)}else n("aws-associated-account-id",void 0)}),[a]),null};const V=function(){return u().createElement(N.lP,{subcription:{values:!0}},(function(){return u().createElement(j,null)}))};var F=n(36459),q=n(34046),B=n(70710),G=n(20777),W=n(78632),M=n(63133),X=n(28721),H=n(26470),U=n.n(H),Q=function(e){var t=(0,f.Z)({},((0,F.Z)(e),e)),n=["/app","/boot","/data","/home","/opt","/srv","/tmp","/usr","/usr/local","/var","/"],a=(0,c.useState)(!1),i=(0,r.Z)(a,2),o=i[0],l=i[1],s=(0,c.useState)("/"),m=(0,r.Z)(s,2),d=m[0],p=m[1],g=(0,c.useState)(""),v=(0,r.Z)(g,2),h=v[0],b=v[1];return(0,c.useEffect)((function(){for(var e=0,a=n;e<a.length;e++){var r=a[e];if(t.mountpoint.startsWith(r))return p(r),void b(t.mountpoint.substring(r.length))}}),[]),(0,c.useEffect)((function(){var e=h,n=d;e&&("/"!==n&&"/"!==e[0]&&(e="/"+e),n+=e),t.onChange(U().normalize(n))}),[d,h]),u().createElement(u().Fragment,null,u().createElement(T.Select,{className:"pf-u-w-50",isOpen:o,onToggle:function(e){l(e)},onSelect:function(e,t){p(t),l(!1)},selections:d,variant:T.SelectVariant.single},n.map((function(e,t){return u().createElement(T.SelectOption,{key:t,value:e})}))),"/"!==d&&u().createElement(T.TextInput,{className:"pf-u-w-50",type:"text",value:h,"aria-label":"Mount point suffix text input",onChange:function(e){return b(e)}}))};Q.propTypes={mountpoint:x().string.isRequired,onChange:x().func.isRequired};const K=Q;var Y=n(58061),$=function(e){var t=(0,f.Z)({},((0,F.Z)(e),e)),n=(0,c.useState)(!1),a=(0,r.Z)(n,2),i=a[0],o=a[1],l=(0,c.useState)(t.unit||Y.at),s=(0,r.Z)(l,2),m=s[0],d=s[1],p=(0,c.useState)(t.size||1),g=(0,r.Z)(p,2),v=g[0],h=g[1];return(0,c.useEffect)((function(){t.onChange(v,m)}),[m,v]),u().createElement(u().Fragment,null,u().createElement(T.TextInput,{className:"pf-u-w-50",type:"text",value:v,"aria-label":"Size text input",onChange:function(e){return h(isNaN(parseInt(e))?0:parseInt(e))}}),u().createElement(T.Select,{className:"pf-u-w-50",isOpen:i,onToggle:function(e){o(e)},onSelect:function(e,t){switch(t){case"KiB":d(Y.fI);break;case"MiB":d(Y.g7);break;case"GiB":d(Y.at)}o(!1)},selections:m===Y.fI?"KiB":m===Y.g7?"MiB":"GiB",variant:T.SelectVariant.single,"aria-label":"Unit select"},["KiB","MiB","GiB"].map((function(e,t){return u().createElement(T.SelectOption,{key:t,value:e})}))))};$.propTypes={size:x().number.isRequired,unit:x().number.isRequired,onChange:x().func.isRequired};const J=$;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ae={id:(0,X.Z)(),mountpoint:"/",fstype:"xfs",size:10,unit:Y.at};const re=function(e){var t=(0,f.Z)({},((0,F.Z)(e),e)),n=(0,k.default)(),a=n.change,i=n.getState,l=(0,S.Z)(t).input,s=(0,c.useState)(null),m=(0,r.Z)(s,2),d=m[0],p=m[1],g=(0,c.useState)(null),v=(0,r.Z)(g,2),h=v[0],b=v[1],y=(0,c.useState)(!1),E=(0,r.Z)(y,2),w=E[0],x=E[1],I=(0,c.useState)([ae.id]),Z=(0,r.Z)(I,2),C=Z[0],L=Z[1],A=(0,c.useState)([]),P=(0,r.Z)(A,2),_=P[0],O=P[1],z=(0,c.useRef)(),D=(0,c.useState)([ae]),j=(0,r.Z)(D,2),V=j[0],H=j[1];(0,c.useEffect)((function(){var e,t,n=null===(e=i())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["file-system-configuration"];if(n){var a=[],r=[];n.map((function(e){var t=(0,X.Z)();a.push({id:t,mountpoint:e.mountpoint,fstype:"xfs",size:e.size,unit:e.unit}),r.push(t)})),H(a),L(r)}}),[]);var U=function(){var e,t;return null===(e=i())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["file-system-config-show-errors"]};(0,c.useEffect)((function(){a(l.name,C.map((function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(V);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.id===e)return{mountpoint:a.mountpoint,size:a.size,unit:a.unit}}}catch(e){n.e(e)}finally{n.f()}})))}),[V,C]);var Q=function(){var e=(0,X.Z)();H(V.concat([{id:e,mountpoint:"/home",fstype:"xfs",size:1,unit:Y.at}])),L(C.concat([e]))},$=function(e){var t=z.current,n=Array.from(t.children);if(!n.map((function(e){return e.id})).every((function(t,n){return t===e[n]}))){for(;t.firstChild;)t.removeChild(t.lastChild);e.forEach((function(e){t.appendChild(n.find((function(t){return t.id===e})))}))}},ee=function(e){e.preventDefault();var t=e.target.closest("tr");if(!t||!z.current.contains(t))return null;var n=t.id,a=Array.from(z.current.children).findIndex((function(e){return e.id===n}));if(a!==h){var r=function(e,t,n){var a=e.indexOf(t);if(a===n)return e;var r=e.splice(a,1);return e.splice(n,0,r[0]),e}((0,o.Z)(C),d,a);$(r),b(a),O(r)}},re=function(e){var t=z.current.getBoundingClientRect();return e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height},ie=function(e){re(e)||($(C),b(null))},oe=function(e){re(e)&&L(_)},le=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.id),e.currentTarget.classList.add(W.Z.modifiers.ghostRow),e.currentTarget.setAttribute("aria-pressed","true"),p(e.currentTarget.id),x(!0)},se=function(e){e.target.classList.remove(W.Z.modifiers.ghostRow),e.target.setAttribute("aria-pressed","false"),p(null),b(null),x(!1)};return u().createElement(N.lP,null,(function(){var e,t,n,a,r,l,s;return u().createElement(u().Fragment,null,u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Configure partitions")),V.length>1&&0!==(null===(e=i())||void 0===e||null===(t=e.errors)||void 0===t||null===(n=t["file-system-configuration"])||void 0===n||null===(a=n.duplicates)||void 0===a?void 0:a.length)&&U()&&u().createElement(T.Alert,{variant:"danger",isInline:!0,title:"Duplicate mount points: All mount points must be unique. Remove the duplicate or choose a new mount point.","data-testid":"fsc-warning"}),V.length>=1&&!1===(null===(r=i())||void 0===r||null===(l=r.errors)||void 0===l||null===(s=l["file-system-configuration"])||void 0===s?void 0:s.root)&&U()&&u().createElement(T.Alert,{variant:"danger",isInline:!0,title:"No root partition configured."}),u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Create partitions for your image by defining mount points and minimum sizes. Image builder creates partitions with a logical volume (LVM) device type."),u().createElement(T.Text,null,"The order of partitions may change when the image is installed in order to conform to best practices and ensure functionality.",u().createElement("br",null),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-partitioning-naming-schemes-and-mount-points",className:"pf-u-pl-0"},"Partition naming schemes and mount points"))),u().createElement(M.TableComposable,{"aria-label":"File system table",className:w&&W.Z.modifiers.dragOver,variant:"compact"},u().createElement(M.Thead,null,u().createElement(M.Tr,null,u().createElement(M.Th,null),u().createElement(M.Th,null,"Mount point"),u().createElement(M.Th,null,"Type"),u().createElement(M.Th,null,"Minimum size",u().createElement(T.Popover,{hasAutoWidth:!0,bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},u().createElement(T.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},u().createElement(q.ZP,null)))),u().createElement(M.Th,null))),u().createElement(M.Tbody,{ref:z,onDragOver:ee,onDrop:ee,onDragLeave:ie,"data-testid":"file-system-configuration-tbody"},V.map((function(e,t){var n,a;return u().createElement(M.Tr,{key:t,id:e.id,draggable:!0,onDrop:oe,onDragEnd:se,onDragStart:le},u().createElement(M.Td,{draggableRow:{id:"draggable-row-".concat(e.id)}}),u().createElement(M.Td,{className:"pf-m-width-30"},u().createElement(K,{key:e.id+"-mountpoint",mountpoint:e.mountpoint,onChange:function(t){return function(e,t){for(var n=(0,o.Z)(V),a=0;a<n.length;a++)if(n[a].id===e){var r=te({},n[a]);r.mountpoint=t,n.splice(a,1,r);break}H(n)}(e.id,t)}}),0!==(null===(n=i().errors["file-system-configuration"])||void 0===n?void 0:n.duplicates.length)&&-1!==(null===(a=i().errors["file-system-configuration"])||void 0===a?void 0:a.duplicates.indexOf(e.mountpoint))&&U()&&u().createElement(T.Alert,{variant:"danger",isInline:!0,isPlain:!0,title:"Duplicate mount point."})),u().createElement(M.Td,{className:"pf-m-width-20"},e.fstype),u().createElement(M.Td,{className:"pf-m-width-30"},u().createElement(J,{key:e.id+"-sizeunit",size:e.size,unit:e.unit,onChange:function(t,n){return function(e,t,n){for(var a=(0,o.Z)(V),r=0;r<a.length;r++)if(a[r].id===e){var i=te({},a[r]);i.size=t,i.unit=n,a.splice(r,1,i);break}H(a)}(e.id,t,n)}})),u().createElement(M.Td,{className:"pf-m-width-10"},u().createElement(T.Button,{variant:"link",icon:u().createElement(B.ZP,null),onClick:function(){return function(e){var t=V.map((function(e){return e.id})).indexOf(e),n=(0,o.Z)(V);n.splice(t,1);var a=C.indexOf(e),r=(0,o.Z)(C);r.splice(a,1),H(n),L(r)}(e.id)},"data-testid":"remove-mount-point"})))})))),u().createElement(T.TextContent,null,u().createElement(T.Button,{"data-testid":"file-system-add-partition",className:"pf-u-text-align-left",variant:"link",icon:u().createElement(G.ZP,null),onClick:Q},"Add partition")))}))};var ie=function(e){var t=e.fields,n=e.minWidths,a=e.maxWidths,r=(0,N.XQ)().renderForm;return u().createElement(T.Gallery,{minWidths:n,maxWidths:a,hasGutter:!0},t.map((function(e){return u().createElement(T.GalleryItem,{key:e.name},r([e]))})))};ie.propTypes={fields:x().array,maxWidths:x().object,minWidths:x().object};const oe=ie,le=function(e){switch(e){case Y.F2:case Y.PV:return!0;default:return!1}};var se=["label","isRequired"],ce=function(e){var t,n,a,i=e.label,l=e.isRequired,s=(0,v.Z)(e,se),m=(0,k.default)(),d=m.change,p=m.getState,g=(0,S.Z)(s).input,h=(0,c.useState)(!1),b=(0,r.Z)(h,2),y=b[0],E=b[1],w=(0,c.useState)(!1),x=(0,r.Z)(w,2),I=x[0],Z=x[1];return u().createElement(T.FormGroup,{isRequired:l,label:i},u().createElement(T.Select,(0,f.Z)({ouiaId:"release_select",variant:T.SelectVariant.single,onToggle:function(){return E(!y)},onSelect:function(e,t){d(g.name,t),E(!1)},selections:Y.rh.get(null===(t=p())||void 0===t||null===(n=t.values)||void 0===n?void 0:n[g.name]),isOpen:y},!I&&{loadingVariant:{text:"Show options for further development of RHEL",onClick:function(){Z(!0)}}}),(a=[],new Map((0,o.Z)(Y.rh).filter((function(e){var t=(0,r.Z)(e,1)[0];return!!I||le(t)}))).forEach((function(e,t){a.push(u().createElement(T.SelectOption,{key:e,value:t},Y.rh.get(t)))})),a)))};ce.propTypes={label:x().node,isRequired:x().bool};const ue=ce;var me=n(70363),de=n(70196),pe=n(6569),ge=n(5866),fe=n(95511);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ee=function(e){var t,n,a=e.defaultArch,r=(0,k.default)().getState,o=null===(t=r())||void 0===t||null===(n=t.values)||void 0===n?void 0:n.release,l=(0,A.YC)(o),c=l.data,m=l.isSuccess,d=function(){var e=(0,i.Z)(s().mark((function e(t){var n,i,o,l,u,m,d,p,g,f,v,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!insights.chrome.isBeta()){e.next=8;break}return n=c.find((function(e){return"x86_64"===e.arch})),i=n.repositories.map((function(e){return e.baseurl})),e.next=5,I.Z.getPackagesContentSources(i,t);case 5:return e.abrupt("return",e.sent);case 8:return p=[null===(o=r())||void 0===o||null===(l=o.values)||void 0===l?void 0:l.release,(null===(u=r())||void 0===u||null===(m=u.values)||void 0===m?void 0:m.architecture)||a,t],e.next=11,I.Z.getPackages.apply(I.Z,p);case 11:if(g=e.sent,f=g.data,v=g.meta,(null===(d=f)||void 0===d?void 0:d.length)!==v.count){e.next=18;break}return e.abrupt("return",f);case 18:if(!f){e.next=24;break}return e.next=21,I.Z.getPackages.apply(I.Z,p.concat([v.count]));case 21:return h=e.sent,f=h.data,e.abrupt("return",f);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return u().createElement(we,{getAllPackages:d,isSuccess:m})},Te=function(){var e=(0,k.default)().getState,t=function(){var t=(0,i.Z)(s().mark((function t(n){var a,r,i,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=null===(a=e())||void 0===a||null===(r=a.values)||void 0===r?void 0:r["custom-repositories"],o=null==i?void 0:i.map((function(e){return e.baseurl})),t.next=4,I.Z.getPackagesContentSources(o,n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return u().createElement(we,{getAllPackages:t})},we=function(e){var t,n,a=e.getAllPackages,o=e.isSuccess,l=(0,c.useContext)(me.default).currentStep,m=(0,k.default)(),d=m.change,p=m.getState,g=(0,c.useState)(void 0),f=(0,r.Z)(g,2),v=f[0],h=f[1],b=(0,c.useState)(""),y=(0,r.Z)(b,2),E=y[0],w=y[1],x=(0,c.useState)({}),S=(0,r.Z)(x,2),I=S[0],Z=S[1],C=(0,c.useState)(""),L=(0,r.Z)(C,2),A=L[0],P=L[1],_=null===(t=p())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["selected-packages"],O=(0,c.useState)(void 0),R=(0,r.Z)(O,2),z=R[0],D=R[1],N=(0,c.useState)(new Set),j=(0,r.Z)(N,2),V=j[0],F=j[1],q=(0,c.useState)(new Set),B=(0,r.Z)(q,2),G=B[0],W=B[1],M=(0,c.useRef)(null);(0,c.useEffect)((function(){if(_){var e,t={},n=be(_);try{for(n.s();!(e=n.n()).done;){var a=e.value;t[a.name]=a}}catch(e){n.e(e)}finally{n.f()}Z(t)}}),[]),(0,c.useEffect)((function(){var e;o&&(null===(e=M.current)||void 0===e||e.focus())}),[o]);var X=(0,c.useCallback)((function(e){return function(t,n){return t=t.name.toLowerCase(),n=n.name.toLowerCase(),t===e?-1:n===e?1:t.startsWith(e)&&!n.startsWith(e)?-1:n.startsWith(e)&&!t.startsWith(e)?1:t<n?-1:n<t?1:0}})),H=(0,c.useMemo)((function(){return void 0===z?[]:Object.values(z).sort(X(v))}),[z]),U=(0,c.useMemo)((function(){return Object.values(I).filter((function(e){return!!e.name.includes(E)})).sort(X(E))}),[I,E]),Q=function(){var e=(0,i.Z)(s().mark((function e(){var t,n,r,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(v);case 2:if(t=e.sent){n={},r=be(t);try{for(r.s();!(i=r.n()).done;)o=i.value,n[o.name]=o}catch(e){r.e(e)}finally{r.f()}D(n)}else D([]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(e){"Enter"===e.key&&"available"===A&&(e.stopPropagation(),Q())};(0,c.useEffect)((function(){return document.addEventListener("keydown",K,!0),function(){document.removeEventListener("keydown",K,!0)}}));var Y=function(e){F(new Set),W(new Set),Z(e),d("selected-packages",Object.values(e))};return u().createElement(T.DualListSelector,null,u().createElement(T.DualListSelectorPane,{title:"Available packages",searchInput:u().createElement(T.SearchInput,{placeholder:"Search for a package","data-testid":"search-available-pkgs-input",value:v,ref:M,onFocus:function(){return P("available")},onBlur:function(){return P("")},onChange:function(e,t){return h(t)},submitSearchButtonLabel:"Search button for available packages",onSearch:Q,resetButtonLabel:"Clear available packages search",onClear:function(){h(""),D(void 0)},isDisabled:"packages"===l.name&&!o})},u().createElement(T.DualListSelectorList,{"data-testid":"available-pkgs-list"},void 0===z?u().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"Search above to add additional",u().createElement("br",null),"packages to your image"):0===H.length?u().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages found"):H.map((function(e){return u().createElement(T.DualListSelectorListItem,{"data-testid":"available-pkgs-".concat(e.name),key:e.name,isDisabled:!!I[e.name],isSelected:V.has(e.name),onOptionSelect:function(t){return n=e.name,(a=new Set(V)).has(n)?a.delete(n):a.add(n),void F(a);var n,a}},u().createElement(T.TextContent,{key:"".concat(e.name)},u().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),u().createElement("small",null,e.summary)))})))),u().createElement(T.DualListSelectorControlsWrapper,{"aria-label":"Selector controls"},u().createElement(T.DualListSelectorControl,{isDisabled:0===V.size,onClick:function(){return function(){var e,t=he({},I),n=be(V);try{for(n.s();!(e=n.n()).done;){var a=e.value;t[a]=he({},z[a])}}catch(e){n.e(e)}finally{n.f()}Y(t)}()},"aria-label":"Add selected",tooltipContent:"Add selected"},u().createElement(fe.ZP,null)),u().createElement(T.DualListSelectorControl,{isDisabled:0===H.length,onClick:function(){return e=he(he({},I),z),void Y(e);var e},"aria-label":"Add all",tooltipContent:"Add all"},u().createElement(pe.ZP,null)),u().createElement(T.DualListSelectorControl,{isDisabled:0===Object.values(I).length,onClick:function(){Y({})},"aria-label":"Remove all",tooltipContent:"Remove all"},u().createElement(de.ZP,null)),u().createElement(T.DualListSelectorControl,{onClick:function(){return function(){var e={};for(var t in I)G.has(t)||(e[t]=he({},I[t]));Y(e)}()},isDisabled:0===G.size,"aria-label":"Remove selected",tooltipContent:"Remove selected"},u().createElement(ge.ZP,null))),u().createElement(T.DualListSelectorPane,{title:"Chosen packages",searchInput:u().createElement(T.SearchInput,{placeholder:"Search for a package","data-testid":"search-chosen-pkgs-input",value:E,onFocus:function(){return P("chosen")},onBlur:function(){return P("")},onChange:function(e,t){return w(t)},resetButtonLabel:"Clear chosen packages search",onClear:function(){w("")}}),isChosen:!0},u().createElement(T.DualListSelectorList,{"data-testid":"chosen-pkgs-list"},0===Object.values(I).length?u().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages added"):0===U.length?u().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages found"):U.map((function(e){return u().createElement(T.DualListSelectorListItem,{"data-testid":"selected-pkgs-".concat(e.name),key:e.name,isSelected:G.has(e.name),onOptionSelect:function(t){return n=e.name,(a=new Set(G)).has(n)?a.delete(n):a.add(n),void W(a);var n,a}},u().createElement(T.TextContent,{key:"".concat(e.name)},u().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),u().createElement("small",null,e.summary)))})))))};Ee.propTypes={defaultArch:x().string},we.propTypes={getAllPackages:x().func,isSuccess:x().bool};var xe=n(41626),Se=["Popover"],ke=function(e){var t=e.Popover,n=(0,v.Z)(e,Se),a=(0,c.useRef)();return u().createElement(xe.Z,(0,f.Z)({},n,{label:u().createElement("span",{ref:a,className:"ins-c-image--builder__popover"},n.label,u().createElement(t,null))}))};ke.propTypes={Popover:x().elementType.isRequired,label:x().node};const Ie=ke;var Ze=["label"],Ce=function(){return u().createElement(T.Popover,{headerContent:"About Red Hat Subscription Management",position:"right",minWidth:"25rem",bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Registered systems are entitled to support services, as well as errata, patches, and upgrades."),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/products/red-hat-subscription-management"},"Read more"))},u().createElement(T.Button,{variant:"plain",className:"pf-c-form__group-label-help","aria-label":"About Remote Host Configuration (RHC)",isInline:!0},u().createElement(q.ZP,null)))},Le=function(){return u().createElement(T.Popover,{headerContent:"About Red Hat Insights",position:"right",minWidth:"25rem",bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Insights client is a tool which provides actionable intelligence about your Red Hat Enterprise Linux environments, helping to identify and address operational and vulnerability risks before an issue results in downtime."),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/products/red-hat-insights"},"Read more"))},u().createElement(T.Button,{variant:"plain",className:"pf-c-form__group-label-help","aria-label":"About Remote Host Configuration (RHC)",isInline:!0},u().createElement(q.ZP,null)))},Ae=function(){return u().createElement(T.Popover,{headerContent:"About Remote Host Configuration (RHC)",position:"right",minWidth:"25rem",bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"RHC is a tool that allows RHEL hosts to connect to the Insights services. It is required for the Insights Remediations service."),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/articles/rhc"},"Read more"))},u().createElement(T.Button,{variant:"plain",className:"pf-c-form__group-label-help","aria-label":"About Remote Host Configuration (RHC)",isInline:!0},u().createElement(q.ZP,null)))},Pe=function(e){var t,n,a=e.label,i=(0,v.Z)(e,Ze),o=(0,k.default)(),l=o.change,s=o.getState,m=(0,S.Z)(i).input,d=(0,c.useState)(!1),p=(0,r.Z)(d,2),g=p[0],f=p[1],h=(0,c.useState)(!0),b=(0,r.Z)(h,2),y=b[0],E=b[1],w=(0,c.useState)(!0),x=(0,r.Z)(w,2),I=x[0],Z=x[1],C=null===(t=s())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["register-system"];return(0,c.useEffect)((function(){"register-now-insights"===C&&(f(!0),E(!0),Z(!1)),"register-now"===C&&(f(!0),E(!1),Z(!1))}),[]),(0,c.useEffect)((function(){y&&I?l(m.name,"register-now-rhc"):y&&!I?l(m.name,"register-now-insights"):y||I||l(m.name,"register-now")}),[y,I]),u().createElement(N.lP,null,(function(){return u().createElement(T.FormGroup,{label:a},u().createElement(T.Radio,{autoFocus:!0,label:g?u().createElement(u().Fragment,null,"Monitor & manage subscriptions and access to Red Hat content",u().createElement(Ce,null)):"Automatically register and enable advanced capabilities","data-testid":"registration-radio-now",name:"register-system",id:"register-system-now",checked:C.startsWith("register-now"),onChange:function(){I?l(m.name,"register-now-rhc"):(E(!0),Z(!0))},description:!g&&u().createElement(T.Button,{component:"a","data-testid":"registration-additional-options",variant:"link",isDisabled:!C.startsWith("register-now"),isInline:!0,onClick:function(){return f(!g)}},"Show additional connection options"),body:g&&u().createElement(T.Checkbox,{className:"pf-u-ml-lg",label:u().createElement(u().Fragment,null,"Enable predictive analytics and management capabilities",u().createElement(Le,null)),"data-testid":"registration-checkbox-insights",isChecked:y,onChange:function(e){E(e),e||Z(!y)},id:"register-system-now-insights",name:"register-system-insights",body:u().createElement(T.Checkbox,{label:u().createElement(u().Fragment,null,"Enable remote remediations and system management with automation",u().createElement(Ae,null)),"data-testid":"registration-checkbox-rhc",isChecked:I,onChange:function(e){Z(e),y||E(!0)},id:"register-system-now-rhc",name:"register-system-rhc"})})}),u().createElement(T.Radio,{name:"register-system",className:"pf-u-mt-md","data-testid":"registration-radio-later",id:"register-system-later",label:"Register later",checked:"register-later"===C,onChange:function(){f(!1),l(m.name,"register-later")}}))}))};Pe.propTypes={label:x().node};const _e=Pe;var Oe=n(21551);const Re=function(){var e,t,n=null===(e=(0,(0,N.XQ)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["subscription-activation-key"],a=(0,c.useState)(void 0),o=(0,r.Z)(a,2),l=o[0],m=o[1],d=(0,c.useState)(void 0),p=(0,r.Z)(d,2),g=p[0],f=p[1],v=(0,c.useState)(void 0),h=(0,r.Z)(v,2),b=h[0],y=h[1],E=(0,c.useState)(void 0),w=(0,r.Z)(E,2),x=w[0],S=w[1];return(0,c.useEffect)((function(){var e=function(){var e=(0,i.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.Z.getActivationKey(n);case 2:t=e.sent,m(null==t?void 0:t.role),f(null==t?void 0:t.serviceLevel),y(null==t?void 0:t.usage),S(null==t?void 0:t.additionalRepositories);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),u().createElement(u().Fragment,null,u().createElement(T.TextContent,null,u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Name:"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},n),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Role:"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},l||"Not defined"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"SLA:"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},g||"Not defined"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Usage:"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},b||"Not defined"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Additional repositories:",u().createElement(T.Popover,{bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"The core repositories for your operating system version are always enabled and do not need to be explicitly added to the activation key."))},u().createElement(T.Button,{variant:"plain","aria-label":"About additional repositories",className:"pf-u-pl-sm pf-u-pt-0 pf-u-pb-0",isSmall:!0},u().createElement(q.ZP,null)))),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd,className:"pf-u-display-flex pf-u-align-items-flex-end"},(null==x?void 0:x.length)>0?u().createElement(T.Popover,{bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Additional repositories"),u().createElement(M.TableComposable,{"aria-label":"Additional repositories table",variant:"compact"},u().createElement(M.Thead,null,u().createElement(M.Tr,null,u().createElement(M.Th,null,"Name"))),u().createElement(M.Tbody,{"data-testid":"additional-repositories-table"},null==x?void 0:x.map((function(e,t){return u().createElement(M.Tr,{key:t},u().createElement(M.Td,null,e.repositoryLabel))})))))},u().createElement(T.Button,{"data-testid":"repositories-popover-button",variant:"link","aria-label":"Show additional repositories",className:"pf-u-pl-0 pf-u-pt-0 pf-u-pb-0"},null==x?void 0:x.length," repositories")):"None"))))};var ze=function(e){var t=e.label,n=e.valueReference;return u().createElement(N.lP,null,(function(e){var a=e.values;return(0,Oe.isEmpty)(a[n])?null:u().createElement(T.FormGroup,{label:t},u().createElement(Re,null))}))};ze.propTypes={label:x().node,valueReference:x().node};const De=ze;var Ne=n(82342),je=n(36595);function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ge=function(e){var t=e.selected,n=e.count,a=e.filteredCount,i=e.perPage,o=e.handleSelectAll,l=e.handleSelectPage,s=e.handleDeselectAll,m=(0,c.useState)(!1),d=(0,r.Z)(m,2),p=d[0],g=d[1],f=t.length,v=f>0,h=!!(0!==n?f===n:void 0)||!!v&&null,b=[u().createElement(T.DropdownItem,{key:"none",onClick:s},"Select none (0 items)"),u().createElement(T.DropdownItem,{key:"page",onClick:l},"Select page (".concat(i>a?a:i," items)")),u().createElement(T.DropdownItem,{key:"all",onClick:o},"Select all (".concat(n," items)"))];return u().createElement(T.Dropdown,{onSelect:function(){},toggle:u().createElement(T.DropdownToggle,{id:"stacked-example-toggle",splitButtonItems:[u().createElement(T.DropdownToggleCheckbox,{id:"example-checkbox-1",key:"split-checkbox","aria-label":"Select all",isChecked:h,onClick:function(){v?s():o()}})],onToggle:function(){return g(!p)}},0!==f?"".concat(f," selected"):null),isOpen:p,dropdownItems:b})},We=function(e){var t={url:e.baseurl,rhsm:!1};return e.gpgkey&&(t.gpg_key=e.gpgkey),t};Ge.propTypes={selected:x().array,count:x().number,filteredCount:x().number,perPage:x().number,handleSelectAll:x().func,handleSelectPage:x().func,handleDeselectAll:x().func};const Me=function(e){var t,n,a=(0,N.XQ)().getState,i=(0,N.CP)(e).input,l=(0,c.useState)(function(){var e,t,n=(0,p.v9)((function(e){return(0,je.Gb)(e)})),r=null===(e=a())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["original-payload-repositories"],i=r?function(e,t){var n,a={},r=qe(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a[i.baseurl]=We(i),a[i.baseurl].name=""}}catch(e){r.e(e)}finally{r.f()}return Fe(Fe({},a),e)}(n,r):n;return i}()),s=(0,r.Z)(l,1)[0],m=(0,c.useState)(""),d=(0,r.Z)(m,2),g=d[0],f=d[1],v=(0,c.useState)(10),h=(0,r.Z)(v,2),b=h[0],y=h[1],E=(0,c.useState)(1),w=(0,r.Z)(E,2),x=w[0],S=w[1],k=(0,c.useState)(null!==(t=a())&&void 0!==t&&null!==(n=t.values)&&void 0!==n&&n["custom-repositories"]?a().values["custom-repositories"].map((function(e){return e.baseurl})):[]),I=(0,r.Z)(k,2),Z=I[0],C=I[1],L=function(e){return Z.includes(e)},A=(0,c.useMemo)((function(){return Object.values(s).filter((function(e){return e.name.toLowerCase().includes(g.toLowerCase())})).map((function(e){return e.url}))}),[g]),P=function(e){C(e),function(e){var t,n=[],a=qe(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.push(s[r])}}catch(e){a.e(e)}finally{a.f()}var o=n.map((function(e){return function(e){var t={baseurl:e.url,rhsm:!1};return e.gpg_key&&(t.gpgkey=e.gpg_key,t.check_gpg=!0),t}(e)}));i.onChange(o)}(e)},_=function(){return b*(x-1)},O=function(){return b*x};return u().createElement(u().Fragment,null,0===Object.values(s).length?u().createElement(T.EmptyState,{variant:T.EmptyStateVariant.large,"data-testid":"empty-state"},u().createElement(T.EmptyStateIcon,{icon:Ne.ZP}),u().createElement(T.Title,{headingLevel:"h4",size:"lg"},"No Custom Repositories"),u().createElement(T.EmptyStateBody,null,"Custom repositories managed via the Red Hat Insights Repositories app will be available here to select and use to search for additional packages."),u().createElement(T.Button,{variant:"primary",component:"a",href:insights.chrome.isBeta()?"/beta/settings/content":"/settings/content"},"Repositories")):u().createElement(u().Fragment,null,u().createElement(T.Toolbar,null,u().createElement(T.ToolbarContent,null,u().createElement(T.ToolbarItem,{variant:"bulk-select"},u().createElement(Ge,{selected:Z,count:Object.values(s).length,filteredCount:A.length,perPage:b,handleSelectAll:function(){P(Object.keys(s))},handleSelectPage:function(){var e=A.slice(_(),O()),t=(0,o.Z)(e.filter((function(e){return!Z.includes(e)})));P([].concat((0,o.Z)(Z),(0,o.Z)(t)))},handleDeselectAll:function(){P([])}})),u().createElement(T.ToolbarItem,{variant:"search-filter"},u().createElement(T.SearchInput,{"aria-label":"Search repositories",onChange:function(e,t){S(1),f(t)},value:g,onClear:function(){f("")}})),u().createElement(T.ToolbarItem,{variant:"pagination"},u().createElement(T.Pagination,{itemCount:A.length,perPage:b,page:x,onSetPage:function(e,t){S(t)},widgetId:"compact-example",onPerPageSelect:function(e,t,n){y(t),S(n)},isCompact:!0})))),u().createElement(M.TableComposable,{variant:"compact","data-testid":"repositories-table"},u().createElement(M.Thead,null,u().createElement(M.Tr,null,u().createElement(M.Th,null),u().createElement(M.Th,{width:50},"Name"),u().createElement(M.Th,null,"Architecture"),u().createElement(M.Th,null,"Versions"),u().createElement(M.Th,null,"Packages"))),u().createElement(M.Tbody,null,A.slice().sort((function(e,t){return s[e].name<s[t].name?-1:s[t].name<s[e].name?1:0})).slice(_(),O()).map((function(e,t){var n=s[e];return u().createElement(M.Tr,{key:n.url},u().createElement(M.Td,{select:{isSelected:L(n.url),rowIndex:t,onSelect:function(e,t){return function(e,t,n){!0===n?P([].concat((0,o.Z)(Z),[e])):!1===n&&P(Z.filter((function(t){return t!==e})))}(n.url,0,t)}}}),u().createElement(M.Td,{dataLabel:"Name"},n.name,u().createElement("br",null),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:n.url},n.url)),u().createElement(M.Td,{dataLabel:"Architecture"},n.distribution_arch),u().createElement(M.Td,{dataLabel:"Version"},n.distribution_versions),u().createElement(M.Td,{dataLabel:"Packages"},n.package_count))}))))))};var Xe=n(64124);const He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["target-environment"],n=e.release,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.skipAws,i=a.skipGoogle,o=a.skipAzure;return!r&&null!=t&&t.aws?"aws-target-env":!i&&null!=t&&t.gcp?"google-cloud-target-env":!o&&null!=t&&t.azure?"ms-azure-target-env":le(n)?"registration":"File system configuration"};var Ue=function(e){var t=e.id,n=e.formFields,a=e.formRef,r=e.title,i=e.customTitle,o=e.showTitle,l=e.showTitles;return u().createElement("div",{id:t,ref:a,className:"pf-c-form"},(l&&!1!==o||o)&&(i||u().createElement(T.Title,{headingLevel:"h1",size:"xl"},r)),n)};Ue.propTypes={id:x().string,title:x().node,customTitle:x().node,formFields:x().array.isRequired,formOptions:x().shape({renderForm:x().func.isRequired}).isRequired,showTitles:x().bool,showTitle:x().bool,formRef:x().oneOfType([x().func,x().shape({current:x().instanceOf(Element)})])};const Qe=Ue;var Ke=function(e){var t=e.buttonLabels,n=t.cancel,a=t.next,i=t.submit,o=t.back,l=e.handleNext,s=e.handlePrev,m=e.nextStep,d=(0,c.useState)(!1),p=(0,r.Z)(d,2),g=p[0],f=p[1],v=(0,c.useContext)(me.default),h=v.currentStep,b=v.formOptions,y=function(){"wizard-review"===h.id?b.onSubmit({values:b.getState().values,setIsSaving:f}):l("function"==typeof m?m({values:b.getState().values}):m)};return u().createElement(N.lP,null,(function(){return u().createElement(u().Fragment,null,u().createElement(T.Button,{id:"".concat(h.id,"-next-button"),variant:"primary",type:"button",isDisabled:!b.valid||b.getState().validating||g,isLoading:"wizard-review"===h.id?g:null,onClick:y},"wizard-review"===h.id?g?"Creating image":i:a),u().createElement(T.Button,{id:"".concat(h.id,"-previous-button"),type:"button",variant:"secondary",onClick:s,isDisabled:g},o),u().createElement("div",{className:"pf-c-wizard__footer-cancel"},u().createElement(T.Button,{id:"".concat(h.id,"-cancel-button"),type:"button",variant:"link",onClick:b.onCancel,isDisabled:g},n)))}))};Ke.propTypes={buttonLabels:x().shape({cancel:x().node,submit:x().node,back:x().node,next:x().node}),handleNext:x().func,handlePrev:x().func,nextStep:x().oneOfType([x().string,x().func]),isSaving:x().bool};const Ye=Ke;var $e={googleAccount:"Google account",serviceAccount:"Service account",googleGroup:"Google group",domain:"Domain"},Je=function(e){var t=e.appendTo;return u().createElement(T.Popover,{appendTo:t,hasAutoWidth:!0,maxWidth:"35rem",headerContent:"Valid account types",flipBehavior:["right","bottom","top","left"],bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"The following account types can have an image shared with them:"),u().createElement(T.TextList,{className:"pf-u-ml-0"},u().createElement(T.TextListItem,null,u().createElement("strong",null,"Google account:")," A Google account represents a developer, an administrator, or any other person who interacts with Google Cloud. For example: ",u().createElement("em",null,"`alice@gmail.com`"),"."),u().createElement(T.TextListItem,null,u().createElement("strong",null,"Service account:")," A service account is an account for an application instead of an individual end user. For example:"," ",u().createElement("em",null,"`myapp@appspot.gserviceaccount.com`"),"."),u().createElement(T.TextListItem,null,u().createElement("strong",null,"Google group:")," A Google group is a named collection of Google accounts and service accounts. For example:"," ",u().createElement("em",null,"`admins@example.com`"),"."),u().createElement(T.TextListItem,null,u().createElement("strong",null,"Google Workspace domain or Cloud Identity domain:")," ","A Google workspace or cloud identity domain represents a virtual group of all the Google accounts in an organization. These domains represent your organization's internet domain name. For example: ",u().createElement("em",null,"`mycompany.com`"),".")))},u().createElement(T.Button,{variant:"plain","aria-label":"Account info","aria-describedby":"google-account-type",className:"pf-c-form__group-label-help"},u().createElement(q.ZP,null)))};Je.propTypes={appendTo:x().any};const et={StepTemplate:Qe,id:"wizard-target-gcp",title:"Google Cloud Platform",customTitle:u().createElement(T.Title,{headingLevel:"h1",size:"xl"},"Target environment - Google Cloud Platform"),name:"google-cloud-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return He(t,{skipGoogle:!0,skipAws:!0})},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"google-cloud-text-component",label:u().createElement(T.Text,null,"Your image will be uploaded to Google Cloud Platform and shared with the account you provide below. ",u().createElement("br",null),"The shared image will expire within 14 days. To keep the image longer, copy it to your Google Cloud Platform account.")},{component:"radio-popover",label:"Type",isRequired:!0,Popover:Je,name:"google-account-type",initialValue:"googleAccount",options:Object.entries($e).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return{label:"domain"===n?"Google Workspace domain or Cloud Identity domain":a,value:n,autoFocus:"googleAccount"===n}})),validate:[{type:Xe.Z.REQUIRED}]},{component:m.Z.TEXT_FIELD,name:"google-email","data-testid":"input-google-email",type:"text",label:"Email address",condition:{or:[{when:"google-account-type",is:"googleAccount"},{when:"google-account-type",is:"serviceAccount"},{when:"google-account-type",is:"googleGroup"},{when:"google-account-type",is:null}]},isRequired:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.PATTERN,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",message:"Please enter a valid email address"}]},{component:m.Z.TEXT_FIELD,name:"google-domain",type:"text",label:"Domain",condition:{when:"google-account-type",is:"domain"},isRequired:!0,validate:[{type:Xe.Z.REQUIRED}]}]};function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var nt=function(e){var t=(0,f.Z)({},((0,F.Z)(e),e));return u().createElement(M.TableComposable,{"aria-label":"File system configuration table",variant:"compact"},u().createElement(M.Thead,null,u().createElement(M.Tr,null,u().createElement(M.Th,null,"Mount point"),u().createElement(M.Th,null,"File system type"),u().createElement(M.Th,null,"Minimum size"))),u().createElement(M.Tbody,{"data-testid":"file-system-configuration-tbody-review"},t.fsc.map((function(e,t){return u().createElement(M.Tr,{key:t},u().createElement(M.Td,{className:"pf-m-width-30"},e.mountpoint),u().createElement(M.Td,{className:"pf-m-width-30"},"xfs"),u().createElement(M.Td,{className:"pf-m-width-30"},e.size," ",e.unit===Y.at?"GiB":e.unit===Y.g7?"MiB":"KiB"))}))))};nt.propTypes={fsc:x().arrayOf(x().object).isRequired};const at=function(){var e,t,n,a,o,l,m,d,p,g,f,v,h,b,y,E,w,x,S,I,Z,C,L,P,_,O,R,z,D,N,j,V,F,B,G,W,M,X,H,U,Q,K,$,J,ee,te,ne,ae,re,ie,oe,se,ce,ue,me,de,pe,ge,fe,ve,he,be,ye,Ee,Te,we,xe,Se,ke,Ie,Ze,Ce,Le,Ae,Pe,_e=(0,c.useState)(0),Oe=(0,r.Z)(_e,2),ze=Oe[0],De=Oe[1],Ne=(0,c.useState)(),je=(0,r.Z)(Ne,2),Ve=je[0],Fe=je[1],qe=(0,k.default)(),Be=qe.change,Ge=qe.getState,We=(0,A.Xq)(),Me=We.data,Xe=We.isSuccess;return(0,c.useEffect)((function(){var e,t,n,a,r,o,l=null===(e=Ge())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["register-system"];if(null!=l&&l.startsWith("register-now")&&(0,i.Z)(s().mark((function e(){var t,n,a,r,i,o,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a?void 0:a.getUser();case 2:o=e.sent,l=null==o||null===(r=o.identity)||void 0===r||null===(i=r.internal)||void 0===i?void 0:i.org_id,Be("subscription-organization-id",l);case 5:case"end":return e.stop()}}),e)})))(),"manual"===(null===(n=Ge())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["file-system-config-radio"])&&null!==(r=Ge())&&void 0!==r&&null!==(o=r.values)&&void 0!==o&&o["file-system-configuration"]){var c,u=0,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(Ge().values["file-system-configuration"]);try{for(m.s();!(c=m.n()).done;){var d=c.value;u+=d.size*d.unit}}catch(e){m.e(e)}finally{m.f()}u=(u/Y.at).toFixed(1),Fe(u<1?"Less than 1 GiB":"".concat(u," GiB"))}})),u().createElement(u().Fragment,null,u().createElement(T.Text,null,'Review the information and click "Create image" to create the image using the following criteria.'),u().createElement(T.DescriptionList,{isCompact:!0},u().createElement(T.DescriptionListGroup,null,(null===(e=Ge())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["image-name"])&&u().createElement(u().Fragment,null,u().createElement(T.DescriptionListTerm,null,"Image name"),u().createElement(T.DescriptionListDescription,null,null===(n=Ge())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["image-name"])),u().createElement(T.DescriptionListTerm,null,"Release"),u().createElement(T.DescriptionListDescription,null,Y.rh.get(null===(o=Ge())||void 0===o||null===(l=o.values)||void 0===l?void 0:l.release)))),u().createElement(T.Tabs,{isFilled:!0,activeKey:ze,onSelect:function(e,t){De(t)},className:"pf-u-w-75"},u().createElement(T.Tab,{eventKey:0,title:u().createElement(T.TabTitleText,null,"Target environment"),"data-testid":"tab-target",autoFocus:!0},u().createElement(T.List,{isPlain:!0,iconSize:"large"},(null===(m=Ge())||void 0===m||null===(d=m.values)||void 0===d||null===(p=d["target-environment"])||void 0===p?void 0:p.aws)&&u().createElement(T.ListItem,{icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"})},u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Amazon Web Services"),u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt,className:"pf-u-min-width"},"aws-target-type-source"===(null===(g=Ge())||void 0===g||null===(f=g.values)||void 0===f?void 0:f["aws-target-type"])?"Source":null),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},Xe&&"aws-target-type-source"===(null===(v=Ge())||void 0===v||null===(h=v.values)||void 0===h?void 0:h["aws-target-type"])?null===(b=Me.find((function(e){var t,n;return e.id===(null===(t=Ge())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["aws-sources-select"])})))||void 0===b?void 0:b.name:null),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt,className:"pf-u-min-width"},"Account ID"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},Xe&&"aws-target-type-source"===(null===(y=Ge())||void 0===y||null===(E=y.values)||void 0===E?void 0:E["aws-target-type"])?null===(w=Me.find((function(e){var t,n;return e.id===(null===(t=Ge())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["aws-sources-select"])})))||void 0===w?void 0:w.account_id:null===(x=Ge())||void 0===x||null===(S=x.values)||void 0===S?void 0:S["aws-account-id"]),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Default Region"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},"us-east-1")))),(null===(I=Ge())||void 0===I||null===(Z=I.values)||void 0===Z||null===(C=Z["target-environment"])||void 0===C?void 0:C.gcp)&&u().createElement(T.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"})},u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Google Cloud Platform"),u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},null==$e?void 0:$e[null===(L=Ge())||void 0===L||null===(P=L.values)||void 0===P?void 0:P["google-account-type"]]),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},(null===(_=Ge())||void 0===_||null===(O=_.values)||void 0===O?void 0:O["google-email"])||(null===(R=Ge())||void 0===R||null===(z=R.values)||void 0===z?void 0:z["google-domain"]))))),(null===(D=Ge())||void 0===D||null===(N=D.values)||void 0===N||null===(j=N["target-environment"])||void 0===j?void 0:j.azure)&&u().createElement(T.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"})},u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Microsoft Azure"),u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Subscription ID"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},null===(V=Ge())||void 0===V||null===(F=V.values)||void 0===F?void 0:F["azure-subscription-id"]),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Tenant ID"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},null===(B=Ge())||void 0===B||null===(G=B.values)||void 0===G?void 0:G["azure-tenant-id"]),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Resource group"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},null===(W=Ge())||void 0===W||null===(M=W.values)||void 0===M?void 0:M["azure-resource-group"])))),(null===(X=Ge())||void 0===X||null===(H=X.values)||void 0===H||null===(U=H["target-environment"])||void 0===U?void 0:U.vsphere)&&u().createElement(T.ListItem,null,u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"VMWare"))),(null===(Q=Ge())||void 0===Q||null===(K=Q.values)||void 0===K||null===($=K["target-environment"])||void 0===$?void 0:$["guest-image"])&&u().createElement(T.ListItem,null,u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Virtualization - Guest image"))),(null===(J=Ge())||void 0===J||null===(ee=J.values)||void 0===ee||null===(te=ee["target-environment"])||void 0===te?void 0:te["image-installer"])&&u().createElement(T.ListItem,null,u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Bare metal - Installer"))))),le(null===(ne=Ge())||void 0===ne||null===(ae=ne.values)||void 0===ae?void 0:ae.release)&&u().createElement(T.Tab,{eventKey:1,title:u().createElement(T.TabTitleText,null,"Registration"),"data-testid":"tab-registration"},"register-later"===(null===(re=Ge())||void 0===re||null===(ie=re.values)||void 0===ie?void 0:ie["register-system"])&&u().createElement(T.TextContent,null,u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Registration type"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},"Register the system later"))),(null===(oe=Ge())||void 0===oe||null===(se=oe.values)||void 0===se||null===(ce=se["register-system"])||void 0===ce?void 0:ce.startsWith("register-now"))&&u().createElement(T.TextContent,null,u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Registration type"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd,"data-testid":"review-registration"},u().createElement(T.TextList,{isPlain:!0},(null===(ue=Ge())||void 0===ue||null===(me=ue.values)||void 0===me||null===(de=me["register-system"])||void 0===de?void 0:de.startsWith("register-now"))&&u().createElement(T.TextListItem,null,"Register with Red Hat Subscription Manager (RHSM)",u().createElement("br",null)),("register-now-insights"===(null===(pe=Ge())||void 0===pe||null===(ge=pe.values)||void 0===ge?void 0:ge["register-system"])||"register-now-rhc"===(null===(fe=Ge())||void 0===fe||null===(ve=fe.values)||void 0===ve?void 0:ve["register-system"]))&&u().createElement(T.TextListItem,null,"Connect to Red Hat Insights",u().createElement("br",null)),"register-now-rhc"===(null===(he=Ge())||void 0===he||null===(be=he.values)||void 0===be?void 0:be["register-system"])&&u().createElement(T.TextListItem,null,"Use remote host configuration (RHC) utility",u().createElement("br",null)))),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Activation key",u().createElement(T.Popover,{bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Activation keys enable you to register a system with appropriate subscriptions, system purpose, and repositories attached.",u().createElement("br",null),u().createElement("br",null),"If using an activation key with command line registration, you must provide your organization's ID. Your organization's ID is"," ",void 0!==(null===(ye=Ge())||void 0===ye||null===(Ee=ye.values)||void 0===Ee?void 0:Ee["subscription-organization-id"])?null===(Te=Ge())||void 0===Te||null===(we=Te.values)||void 0===we?void 0:we["subscription-organization-id"]:u().createElement(T.Spinner,{size:"md"})))},u().createElement(T.Button,{variant:"plain","aria-label":"About activation key",className:"pf-u-pl-sm pf-u-pt-0 pf-u-pb-0",isSmall:!0},u().createElement(q.ZP,null)))),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},u().createElement(Re,null))))),u().createElement(T.Tab,{eventKey:2,title:u().createElement(T.TabTitleText,null,"System configuration"),"data-testid":"tab-system"},u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"File system configuration"),u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Partitioning"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd,"data-testid":"partitioning-auto-manual"},"manual"===(null===(xe=Ge())||void 0===xe||null===(Se=xe.values)||void 0===Se?void 0:Se["file-system-config-radio"])?"Manual":"Automatic","manual"===(null===(ke=Ge())||void 0===ke||null===(Ie=ke.values)||void 0===Ie?void 0:Ie["file-system-config-radio"])&&u().createElement(u().Fragment,null," ",u().createElement(T.Popover,{position:"bottom",headerContent:"Partitions",hasAutoWidth:!0,minWidth:"30rem",bodyContent:u().createElement(nt,{fsc:Ge().values["file-system-configuration"]})},u().createElement(T.Button,{"data-testid":"file-system-configuration-popover",variant:"link","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-u-pt-0 pf-u-pb-0"},"View partitions")))),"manual"===(null===(Ze=Ge())||void 0===Ze||null===(Ce=Ze.values)||void 0===Ce?void 0:Ce["file-system-config-radio"])&&u().createElement(u().Fragment,null,u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Image size (minimum)",u().createElement(T.Popover,{hasAutoWidth:!0,bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},u().createElement(T.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},u().createElement(q.ZP,null)))),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd},Ve))),u().createElement(T.Text,{component:T.TextVariants.h3},"Additional packages"),u().createElement(T.TextList,{component:T.TextListVariants.dl},u().createElement(T.TextListItem,{component:T.TextListItemVariants.dt},"Chosen"),u().createElement(T.TextListItem,{component:T.TextListItemVariants.dd,"data-testid":"chosen-packages-count"},(null===(Le=Ge())||void 0===Le||null===(Ae=Le.values)||void 0===Ae||null===(Pe=Ae["selected-packages"])||void 0===Pe?void 0:Pe.length)||0))))))};var rt=["label","isRequired"];function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lt=function(e){var t=e.label,n=e.isRequired,i=(0,v.Z)(e,rt),o=(0,k.default)(),l=o.getState,s=o.change,m=(0,S.Z)(ot({label:t,isRequired:n},i)).input,d=(0,c.useState)({aws:!1,azure:!1,gcp:!1,vsphere:!1,"guest-image":!1,"image-installer":!1}),p=(0,r.Z)(d,2),g=p[0],f=p[1],h=(0,A.F7)("getAWSSources");(0,c.useEffect)((function(){var e,t;null!==(e=l())&&void 0!==e&&null!==(t=e.values)&&void 0!==t&&t[m.name]&&f(l().values[m.name])}),[]),(0,c.useEffect)((function(){!0===g.aws&&h()}),[g]);var b=function(e){return f((function(t){var n=ot(ot({},t),{},(0,a.Z)({},e,!t[e]));return s(m.name,n),n}))},y=function(e,t){" "===e.key&&b(t)};return u().createElement(u().Fragment,null,u().createElement(T.FormGroup,{isRequired:n,label:t,"data-testid":"target-select"},u().createElement(T.FormGroup,{label:u().createElement(T.Text,{component:T.TextVariants.small},"Public cloud"),"data-testid":"target-public"},u().createElement("div",{className:"tiles"},u().createElement(T.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-aws",title:"Amazon Web Services",icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"}),onClick:function(){return b("aws")},onKeyDown:function(e){return y(e,"aws")},isSelected:g.aws,isStacked:!0,isDisplayLarge:!0}),u().createElement(T.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-google",title:"Google Cloud Platform",icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"}),onClick:function(){return b("gcp")},isSelected:g.gcp,onKeyDown:function(e){return y(e,"gcp")},isStacked:!0,isDisplayLarge:!0}),u().createElement(T.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-azure",title:"Microsoft Azure",icon:u().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"}),onClick:function(){return b("azure")},onKeyDown:function(e){return y(e,"azure")},isSelected:g.azure,isStacked:!0,isDisplayLarge:!0}))),u().createElement(T.FormGroup,{label:u().createElement(T.Text,{component:T.TextVariants.small},"Private cloud"),"data-testid":"target-private"},u().createElement(T.Checkbox,{label:"VMWare (.vmdk)",isChecked:g.vsphere,onChange:function(){return b("vsphere")},"aria-label":"VMWare checkbox",id:"checkbox-vmware",name:"VMWare","data-testid":"checkbox-vmware"})),u().createElement(T.FormGroup,{label:u().createElement(T.Text,{component:T.TextVariants.small},"Other"),"data-testid":"target-other"},u().createElement(T.Checkbox,{label:"Virtualization - Guest image (.qcow2)",isChecked:g["guest-image"],onChange:function(){return b("guest-image")},"aria-label":"Virtualization guest image checkbox",id:"checkbox-guest-image",name:"Virtualization guest image","data-testid":"checkbox-guest-image"}),u().createElement(T.Checkbox,{label:"Bare metal - Installer (.iso)",isChecked:g["image-installer"],onChange:function(){return b("image-installer")},"aria-label":"Bare metal installer checkbox",id:"checkbox-image-installer",name:"Bare metal installer","data-testid":"checkbox-image-installer"}))))};lt.propTypes={label:x().node,isRequired:x().bool},lt.defaultProps={label:"",isRequired:!1};const st=lt;var ct=["schema","onSubmit","onClose","customComponentMapper","customValidatorMapper","defaultArch","className"];function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var dt=function(e){var t=e.schema,n=e.onSubmit,a=e.onClose,r=e.customComponentMapper,i=e.customValidatorMapper,o=e.defaultArch,l=e.className,s=(0,v.Z)(e,ct);return t?u().createElement(E.Z,(0,f.Z)({initialValues:s.initialValues,schema:t,className:"image-builder".concat(l?" ".concat(l):""),subscription:{values:!0},FormTemplate:function(e){return u().createElement(b.ZP,(0,f.Z)({},e,{showFormControls:!1}))},onSubmit:function(e){return n(e)},validatorMapper:mt({},i),componentMapper:mt(mt({},h.YS),{},{review:at,output:st,select:y.Z,"package-selector":{component:Ee,defaultArch:o},"package-selector-content-sources":{component:Te},"radio-popover":Ie,"azure-auth-button":O,"activation-keys":L,"activation-key-information":De,"file-system-configuration":re,"image-output-release-select":ue,"centos-acknowledgement":D,"repositories-table":Me,"aws-sources-select":_,"gallery-layout":oe,"field-listener":V,registration:_e},r),onCancel:a},s)):u().createElement(T.Spinner,null)};dt.propTypes={schema:x().object,onSubmit:x().func.isRequired,onClose:x().func.isRequired,customComponentMapper:x().shape((0,a.Z)({},x().string,x().oneOfType([x().node,x().shape({component:x().node})]))),customValidatorMapper:x().shape((0,a.Z)({},x().string,x().func)),defaultArch:x().string,className:x().string,initialValues:x().object};const pt=dt,gt={StepTemplate:Qe,id:"wizard-target-aws",title:"Amazon Web Services",customTitle:u().createElement(T.Title,{headingLevel:"h1",size:"xl"},"Target environment - Amazon Web Services"),name:"aws-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return He(t,{skipAws:!0})},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"plain-text-component",label:u().createElement("p",null,"Your image will be uploaded to AWS and shared with the account you provide below.")},{component:m.Z.PLAIN_TEXT,name:"plain-text-component",label:u().createElement("p",null,u().createElement("b",null,"The shared image will expire within 14 days.")," To permanently access the image, copy the image, which will be shared to your account by Red Hat, to your own AWS account.")},{component:m.Z.TEXT_FIELD,name:"aws-account-id",className:"pf-u-w-25","data-testid":"aws-account-id",type:"text",label:"AWS account ID",isRequired:!0,autoFocus:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.EXACT_LENGTH,threshold:12}]},{component:m.Z.TEXT_FIELD,name:"aws-default-region",className:"pf-u-w-25","data-testid":"aws-default-region",type:"text",label:"Default Region",value:Y.NF,isReadOnly:!0,isRequired:!0,helperText:u().createElement(T.HelperText,null,u().createElement(T.HelperTextItem,{component:"div",variant:"indeterminate",className:"pf-u-w-25"},"Images are built in the default region but can be copied to other regions later."))}]};var ft=function(){return u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"settings/sources"},"Create and manage sources here")};const vt={StepTemplate:Qe,id:"wizard-target-aws",title:"Amazon Web Services",customTitle:u().createElement(T.Title,{headingLevel:"h1",size:"xl"},"Target environment - Amazon Web Services"),name:"aws-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return He(t,{skipAws:!0})},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"plain-text-component",label:u().createElement("p",null,"Your image will be uploaded to AWS and shared with the account you provide below.")},{component:m.Z.PLAIN_TEXT,name:"plain-text-component",label:u().createElement("p",null,u().createElement("b",null,"The shared image will expire within 14 days.")," To permanently access the image, copy the image, which will be shared to your account by Red Hat, to your own AWS account.")},{component:m.Z.RADIO,label:"Share method:",name:"aws-target-type",initialValue:"aws-target-type-source",autoFocus:!0,options:[{label:"Use an account configured from Sources.",description:"Use a configured source to launch environments directly from the console.",value:"aws-target-type-source","data-testid":"aws-radio-source",autoFocus:!0},{label:"Manually enter an account ID.",value:"aws-target-type-account-id","data-testid":"aws-radio-account-id",className:"pf-u-mt-sm"}]},{component:"aws-sources-select",name:"aws-sources-select",className:"pf-u-max-width",label:"Source Name",isRequired:!0,validate:[{type:Xe.Z.REQUIRED}],condition:{when:"aws-target-type",is:"aws-target-type-source"}},{component:m.Z.PLAIN_TEXT,name:"aws-sources-select-description",label:u().createElement(ft,null),condition:{when:"aws-target-type",is:"aws-target-type-source"}},{component:m.Z.TEXT_FIELD,name:"aws-account-id",className:"pf-u-w-25","data-testid":"aws-account-id",type:"text",label:"AWS account ID",isRequired:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.EXACT_LENGTH,threshold:12}],condition:{when:"aws-target-type",is:"aws-target-type-account-id"}},{name:"gallery-layout",component:"gallery-layout",minWidths:{default:"12.5rem"},maxWidths:{default:"12.5rem"},fields:[{component:m.Z.TEXT_FIELD,name:"aws-default-region",value:Y.NF,"data-testid":"aws-default-region",type:"text",label:"Default Region",isReadOnly:!0,isRequired:!0,helperText:u().createElement(T.HelperText,null,u().createElement(T.HelperTextItem,{component:"div",variant:"indeterminate"},"Images are built in the default region but can be copied to other regions later."))},{component:m.Z.TEXT_FIELD,name:"aws-associated-account-id","data-testid":"aws-associated-account-id",type:"text",label:"Associated Account ID",isReadOnly:!0,isRequired:!0,helperText:u().createElement(T.HelperText,null,u().createElement(T.HelperTextItem,{component:"div",variant:"indeterminate"},"This is the account associated with the source.")),condition:{when:"aws-target-type",is:"aws-target-type-source"}},{component:"field-listener",name:"aws-associated-account-id-listener",hideField:!0}]}]},ht={StepTemplate:Qe,id:"wizard-target-msazure",title:"Microsoft Azure",customTitle:u().createElement(T.Title,{headingLevel:"h1",size:"xl"},"Target environment - Microsoft Azure"),name:"ms-azure-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return He(t,{skipAws:!0,skipGoogle:!0,skipAzure:!0})},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"azure-description",label:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Upon build, Image Builder sends the image to the selected authorized Azure account. The image will be uploaded to the resource group in the subscription you specify."),u().createElement(T.Text,null,'To authorize Image Builder to push images to Microsoft Azure, the account owner must configure Image Builder as an authorized application for a specific tenant ID and give it the role of "Contributor" to at least one resource group.',u().createElement("br",null),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow"},"Learn more about OAuth 2.0")))},{component:m.Z.TEXT_FIELD,name:"azure-tenant-id",className:"pf-u-w-50","data-testid":"azure-tenant-id",type:"text",label:"Azure Tenant GUID",required:!0,isRequired:!0,autoFocus:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid tenant ID"}]},{component:"azure-auth-button",name:"azure-auth-button","data-testid":"azure-auth-button",required:!0,isRequired:!0},{component:m.Z.TEXT_FIELD,name:"azure-subscription-id",className:"pf-u-w-50","data-testid":"azure-subscription-id",type:"text",label:"Subscription ID",isRequired:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid subscription ID"}]},{component:m.Z.TEXT_FIELD,name:"azure-resource-group",className:"pf-u-w-50","data-testid":"azure-resource-group",type:"text",label:"Resource group",isRequired:!0,validate:[{type:Xe.Z.REQUIRED},{type:Xe.Z.PATTERN,pattern:/^[-\w._()]+[-\w_()]$/,message:"Resource group names only allow alphanumeric characters, periods, underscores, hyphens, and parenthesis and cannot end in a period"}]}]},bt={StepTemplate:Qe,id:"wizard-systemconfiguration-packages",title:"Additional Red Hat packages",name:"packages",substepOf:"Content",nextStep:function(){return insights.chrome.isBeta()?"repositories":"image-name"},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"packages-text-component",label:u().createElement(T.Text,null,"Images built with Image Builder include all required packages.",u().createElement("br",null),'You can add additional packages to your image by searching "Available packages" and adding them to the "Chosen packages" list.')},{component:"package-selector",name:"selected-packages",label:"Available options"}]},yt={StepTemplate:Qe,id:"wizard-systemconfiguration-content-sources-packages",title:"Additional custom packages",name:"packages-content-sources",substepOf:"Content",nextStep:"image-name",fields:[{component:m.Z.PLAIN_TEXT,name:"packages-text-component",label:u().createElement(T.Text,null,"Images built with Image Builder include all required packages.",u().createElement("br",null),'You can add additional packages to your image by searching "Available packages" and adding them to the "Chosen packages" list.',u().createElement("br",null),"The available packages will return results from all repositories chosen on the previous page.")},{component:"package-selector-content-sources",name:"selected-packages-content-sources",label:"Available options"}]};var Et=function(){var e=(0,c.useState)(null),t=(0,r.Z)(e,2),n=t[0],a=t[1];return(0,c.useEffect)((function(){(0,i.Z)(s().mark((function e(){var t,n,r,i,o,l,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(r=n.auth)||void 0===r?void 0:r.getUser();case 2:l=e.sent,c=null==l||null===(i=l.identity)||void 0===i||null===(o=i.internal)||void 0===o?void 0:o.org_id,a(c);case 5:case"end":return e.stop()}}),e)})))()})),u().createElement(T.Popover,{hasAutoWidth:!0,maxWidth:"35rem",bodyContent:u().createElement(T.TextContent,null,u().createElement(T.Text,null,"Activation keys enable you to register a system with appropriate subscriptions, system purpose, and repositories attached."),u().createElement(T.Text,null,"If using an activation key with command line registration, you must provide your organization's ID.",n&&u().createElement("br",null),n&&"Your organization's ID is "+n))},u().createElement(T.Button,{variant:"plain","aria-label":"Activation key popover","aria-describedby":"subscription-activation-key",className:"pf-c-form__group-label-help"},u().createElement(q.ZP,null)))};const Tt={StepTemplate:Qe,id:"wizard-registration",title:"Register",customTitle:u().createElement(T.Title,{headingLevel:"h1",size:"xl"},"Register systems using this image"),name:"registration",nextStep:"File system configuration",buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"registration-general-description",label:"Automatically Register your systems with Red Hat to enhance security and track your spending."},{name:"register-system",component:"registration",label:"Registration method",initialValue:"register-now-rhc"},{component:"activation-keys",name:"subscription-activation-key",required:!0,label:u().createElement(u().Fragment,null,"Activation key to use for this image",u().createElement(Et,null)),condition:{or:[{when:"register-system",is:"register-now-rhc"},{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]},isRequired:!0,validate:[{type:Xe.Z.REQUIRED}]},{component:m.Z.PLAIN_TEXT,name:"subscription-activation-description",label:u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/management/activation_keys"},"Create and manage activation keys here"),condition:{or:[{when:"register-system",is:"register-now-rhc"},{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]}},{component:m.Z.PLAIN_TEXT,name:"subscription-register-later",label:u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Register Later"),u().createElement(T.Text,null,"On initial boot, systems will need to be registered manually before having access to updates or Red Hat services. Registering and connecting your systems during the image creation is recommended."),u().createElement(T.Text,null,"If you prefer to register later, review the instructions for manual registration with remote host configuration."),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/articles/rhc"},"Registering with remote host configuration")),condition:{or:[{when:"register-system",is:"register-later"}]}},{component:"activation-key-information",name:"subscription-activation-key-information",label:"Selected activation key",valueReference:"subscription-activation-key",condition:{or:[{when:"register-system",is:"register-now-rhc"},{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]}}]},wt={StepTemplate:Qe,id:"wizard-repositories",title:"Custom repositories",name:"repositories",substepOf:"Content",nextStep:function(e){return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["custom-repositories"];return(null==e?void 0:e.length)>0?"packages-content-sources":"image-name"}(e.values)},fields:[{component:m.Z.PLAIN_TEXT,name:"packages-text-component",label:u().createElement(T.Text,null,"Select custom repositories from which to search and add packages to this image.",u().createElement("br",null),"Custom repositories can be managed using the Repositories app on Red Hat Insights.")},{component:"repositories-table",name:"custom-repositories",label:"Custom repositories"}]},xt={StepTemplate:Qe,id:"wizard-review",name:"review",title:"Review",buttons:Ye,fields:[{name:"review",component:"review"}]};var St=n(77310);const kt={StepTemplate:Qe,id:"wizard-imageoutput",title:"Image output",name:"image-output",nextStep:function(e){var t=e.values;return He(t)},buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"image-output-plain-text",label:u().createElement(T.Text,null,"Image builder allows you to create a custom image and push it to target environments.",u().createElement("br",null),u().createElement(St.Z,null))},{component:"image-output-release-select",label:"Release",name:"release",initialValue:Y.PV,isRequired:!0,validate:[{type:Xe.Z.REQUIRED}]},{component:"centos-acknowledgement",name:"centos-acknowledgement",condition:{when:"release",pattern:/centos-*/,then:{set:{"register-system":null}},else:{visible:!1}}},{component:"output",name:"target-environment",label:"Select target environments",isRequired:!0,validate:[{type:Xe.Z.REQUIRED},{type:"targetEnvironmentValidator"}]}]};var It=function(e){var t,n,a=e.handleNext,i=e.handlePrev,o=e.nextStep,l=(0,c.useContext)(me.default),s=l.currentStep,m=l.formOptions,d=(0,N.XQ)(),p=d.change,g=d.getState,f=(0,c.useState)(!(null===(t=g())||void 0===t||null===(n=t.errors)||void 0===n||!n["file-system-configuration"])),v=(0,r.Z)(f,2),h=v[0],b=v[1],y=(0,c.useState)(!1),E=(0,r.Z)(y,2),w=E[0],x=E[1];return(0,c.useEffect)((function(){var e,t,n=null===(e=g())||void 0===e||null===(t=e.errors)||void 0===t?void 0:t["file-system-configuration"];b(!!n),n||(x(!1),p("file-system-config-show-errors",!1))})),u().createElement(u().Fragment,null,u().createElement(T.Button,{id:"".concat(s.id,"-next-button"),variant:"primary",type:"button",isDisabled:h&&w,onClick:function(){h||a(o),x(!0),p("file-system-config-show-errors",!0)}},"Next"),u().createElement(T.Button,{id:"".concat(s.id,"-previous-button"),variant:"secondary",type:"button",onClick:i},"Back"),u().createElement("div",{className:"pf-c-wizard__footer-cancel"},u().createElement(T.Button,{id:"".concat(s.id,"-cancel-button"),type:"button",variant:"link",onClick:m.onCancel},"Cancel")))};It.propTypes={handleNext:x().func,handlePrev:x().func,nextStep:x().string};const Zt={StepTemplate:Qe,id:"wizard-systemconfiguration-filesystem",title:"File system configuration",name:"File system configuration",buttons:It,nextStep:"packages",fields:[{component:m.Z.PLAIN_TEXT,name:"file-system-configuration-text-component",label:u().createElement(u().Fragment,null,u().createElement(T.Text,null,"Define the partitioning of the image"))},{component:m.Z.RADIO,name:"file-system-config-radio",initialValue:"automatic",options:[{label:u().createElement(u().Fragment,null,u().createElement(T.Text,null,u().createElement(T.Label,{isCompact:!0,color:"blue"},"Recommended")," ","Use automatic partitioning")),description:"Automatically partition your image to what is best, depending on the target environment(s)",value:"automatic","data-testid":"file-system-config-radio-automatic",autoFocus:!0},{label:"Manually configure partitions",description:"Manually configure the file system of your image by adding, removing, and editing partitions",value:"manual","data-testid":"file-system-config-radio-manual",className:"pf-u-mt-sm"}]},{component:"file-system-configuration",name:"file-system-configuration",label:"File system configurations",validate:[{type:"fileSystemConfigurationValidator"},{type:Xe.Z.REQUIRED}],condition:{when:"file-system-config-radio",is:"manual"}},{component:m.Z.PLAIN_TEXT,name:"automatic-partitioning-info",label:u().createElement(T.TextContent,null,u().createElement(T.Text,{component:T.TextVariants.h3},"Automatic partitioning"),u().createElement(T.Text,null,"Red Hat will automatically partition your image to what is best, depending on the target environment(s)."),u().createElement(T.Text,null,"The target environment sometimes dictates the partitioning scheme or parts of it, and sometimes the target environment is unknown (e.g., for the .qcow2 generic cloud image)."),u().createElement(T.Text,null,"Using automatic partitioning will apply the most current supported configuration.",u().createElement("br",null),u().createElement(T.Button,{component:"a",target:"_blank",variant:"link",icon:u().createElement(R.ZP,null),iconPosition:"right",href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_8_installation/partitioning-reference_installing-rhel#recommended-partitioning-scheme_partitioning-reference",className:"pf-u-pl-0"},"Learn more"))),condition:{or:[{when:"file-system-config-radio",is:"automatic"}]}}]},Ct={StepTemplate:Qe,id:"wizard-details",name:"image-name",title:"Name image",nextStep:"review",buttons:Ye,fields:[{component:m.Z.PLAIN_TEXT,name:"plain-text-component",label:u().createElement("p",null,"Optionally enter a name for your image. All images will have a UUID.")},{component:m.Z.TEXT_FIELD,name:"image-name",type:"text",label:"Image name",autoFocus:!0,validate:[{type:Xe.Z.MAX_LENGTH,threshold:100}]}]};function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const At=function(){return function(e){if(e){var t,n={},a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(e);try{for(a.s();!(t=a.n()).done;){var i=t.value.mountpoint;i in n?n[i]++:n[i]=1}}catch(e){a.e(e)}finally{a.f()}for(var o=[],l=0,s=Object.entries(n);l<s.length;l++){var c=(0,r.Z)(s[l],2),u=c[0];c[1]>1&&o.push(u)}var m=n["/"]>=1;return 0===o.length&&m?void 0:{duplicates:o===[]?void 0:o,root:m}}}},Pt=function(){return function(e){if(e)return Object.values(e).reduce((function(e,t){return t||e}),!1)?void 0:"Please select an image"}};var _t=n(89136),Ot=n(55808);function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var jt=function(e){var t,n;return e%Y.at==0?(t=e/Y.at,n=Y.at):e%Y.g7==0?(t=e/Y.g7,n=Y.g7):e%Y.fI==0&&(t=e/Y.fI,n=Y.fI),[t,n]},Vt=function(){var e=(0,i.Z)(s().mark((function e(t,n,a,r){var i,o,l,c,u,m,d,p,g,f,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!insights.chrome.isBeta()){e.next=7;break}return e.next=3,I.Z.getPackagesContentSources(a,r);case 3:l=e.sent,o=l.find((function(e){return r===e.name})),e.next=23;break;case 7:return u=[t,n,r],e.next=10,I.Z.getPackages.apply(I.Z,u);case 10:if(m=e.sent,d=m.data,p=m.meta,(null===(c=d[0])||void 0===c?void 0:c.name)!==r){e.next=17;break}o=d[0],e.next=23;break;case 17:if((null===(g=d)||void 0===g?void 0:g.length)===p.count){e.next=22;break}return e.next=20,I.Z.getPackages.apply(I.Z,u.concat([p.count]));case 20:f=e.sent,d=f.data;case 22:o=d.find((function(e){return r===e.name}));case 23:return v=null===(i=o)||void 0===i?void 0:i.summary,e.abrupt("return",v||"");case 25:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}();const Ft=function(){var e,t,n=insights.chrome.isBeta()?vt:gt,a=(0,p.I0)(),l=(0,g.useNavigate)(),f=(0,g.useLocation)(),v=null==f||null===(e=f.state)||void 0===e?void 0:e.composeRequest,h=function(e){if(e){var t,n,a,l,c,u=e.image_requests[0],m=u.upload_request,d={};if(d["image-name"]=e.image_name,d.release=null==e?void 0:e.distribution,d["target-environment"]={aws:!1,azure:!1,gcp:!1,"guest-image":!1},c="aws.s3"===m.type?u.image_type:m.type,d["target-environment"][c]=!0,"aws"===c){var p,g,f,v,h=null==m||null===(p=m.options)||void 0===p||null===(g=p.share_with_sources)||void 0===g?void 0:g[0],b=null==m||null===(f=m.options)||void 0===f||null===(v=f.share_with_accounts)||void 0===v?void 0:v[0];d["aws-sources-select"]=h,d["aws-account-id"]=b,d["aws-target-type"]=b&&!h?"aws-target-type-account-id":"aws-target-type-source"}else if("azure"===c){var y,E,T;d["azure-tenant-id"]=null==m||null===(y=m.options)||void 0===y?void 0:y.tenant_id,d["azure-subscription-id"]=null==m||null===(E=m.options)||void 0===E?void 0:E.subscription_id,d["azure-resource-group"]=null==m||null===(T=m.options)||void 0===T?void 0:T.resource_group}else if("gcp"===c){var w,x=(null==m||null===(w=m.options)||void 0===w?void 0:w.share_with_accounts[0]).split(":"),S=(0,r.Z)(x,2),k=S[0],I=S[1];switch(k){case"user":d["google-account-type"]="googleAccount",d["google-email"]=I;break;case"serviceAccount":d["google-account-type"]="serviceAccount",d["google-email"]=I;break;case"group":d["google-account-type"]="googleGroup",d["google-email"]=I;break;case"domain":d["google-account-type"]="domain",d["google-domain"]=I}}var Z=[],C=[],L=null==e?void 0:e.distribution,P=(0,A.YC)(L),_=P.data;if(P.isSuccess){var O,R,z,D;C=function(e){return e.find((function(e){return"x86_64"===e.arch})).repositories.map((function(e){return e.baseurl}))}(_);var N=null==e||null===(O=e.customizations)||void 0===O||null===(R=O.payload_repositories)||void 0===R?void 0:R.map((function(e){return e.baseurl})),j=(0,o.Z)(C);N&&j.push.apply(j,(0,o.Z)(N)),null==e||null===(z=e.customizations)||void 0===z||null===(D=z.packages)||void 0===D||D.forEach(function(){var e=(0,i.Z)(s().mark((function e(t){var n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt(L,null==u?void 0:u.architecture,j,t);case 2:n=e.sent,a={name:t,summary:n},Z.push(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d["selected-packages"]=Z}d["original-payload-repositories"]=null==e||null===(t=e.customizations)||void 0===t?void 0:t.payload_repositories,d["custom-repositories"]=null==e||null===(n=e.customizations)||void 0===n?void 0:n.payload_repositories;var V=null==e||null===(a=e.customizations)||void 0===a?void 0:a.filesystem;if(V){d["file-system-config-radio"]="manual";var F,q=[],B=Dt(V);try{for(B.s();!(F=B.n()).done;){var G=F.value,W=jt(G.min_size),M=(0,r.Z)(W,2),X=M[0],H=M[1];q.push({mountpoint:G.mountpoint,size:X,unit:H})}}catch(e){B.e(e)}finally{B.f()}d["file-system-configuration"]=q}var U=null==e||null===(l=e.customizations)||void 0===l?void 0:l.subscription;return U?(U.rhc?d["register-system"]="register-now-rhc":U.insights?d["register-system"]="register-now-insights":d["register-system"]="register-now",d["subscription-activation-key"]=U["activation-key"],d["subscription-organization-id"]=U.organization,insights.chrome.isProd()?(d["subscription-server-url"]="subscription.rhsm.redhat.com",d["subscription-base-url"]="https://cdn.redhat.com/"):(d["subscription-server-url"]="subscription.rhsm.stage.redhat.com",d["subscription-base-url"]="https://cdn.stage.redhat.com/")):d["register-system"]="register-later",d}}(v),b=function(e){if(e){var t,n=e.image_requests[0].upload_request,a=["image-output"];return"aws"===n.type?a.push("aws-target-env"):"azure"===n.type?a.push("azure-target-env"):"gcp"===n.type&&a.push("google-cloud-target-env"),le(null==e?void 0:e.distribution)&&a.push("registration"),insights.chrome.isBeta()?(a.push("File system configuration","packages","repositories"),(null===(t=e.customizations)||void 0===t?void 0:t.payload_repositories)&&a.push("packages-content-sources")):a.push("File system configuration","packages"),a.push("image-name"),a}return[]}(v),y=function(){return l((0,Ot.y)(""))};return(0,c.useEffect)((function(){insights.chrome.isBeta()&&a((0,je.WM)())}),[]),u().createElement(pt,{onClose:y,onSubmit:function(e){var t=e.values,n=e.setIsSaving;n((function(){return!0}));var r=function(e){var t,n,a,r,i,l,s,c,u={packages:null===(t=e["selected-packages"])||void 0===t?void 0:t.map((function(e){return e.name}))};if((null===(n=e["custom-repositories"])||void 0===n?void 0:n.length)>0&&(u.payload_repositories=(0,o.Z)(e["custom-repositories"])),"register-now-rhc"===e["register-system"]?u.subscription={"activation-key":e["subscription-activation-key"],insights:!0,rhc:!0,organization:Number(e["subscription-organization-id"]),"server-url":e["subscription-server-url"],"base-url":e["subscription-base-url"]}:"register-now-insights"===e["register-system"]?u.subscription={"activation-key":e["subscription-activation-key"],insights:!0,organization:Number(e["subscription-organization-id"]),"server-url":e["subscription-server-url"],"base-url":e["subscription-base-url"]}:"register-now"===e["register-system"]&&(u.subscription={"activation-key":e["subscription-activation-key"],insights:!1,organization:Number(e["subscription-organization-id"]),"server-url":e["subscription-server-url"],"base-url":e["subscription-base-url"]}),"manual"===e["file-system-config-radio"]){u.filesystem=[];var m,d=Dt(e["file-system-configuration"]);try{for(d.s();!(m=d.n()).done;){var p=m.value;u.filesystem.push({mountpoint:p.mountpoint,min_size:p.size*p.unit})}}catch(e){d.e(e)}finally{d.f()}}var g=[];if(null!==(a=e["target-environment"])&&void 0!==a&&a.aws){var f="aws-target-type-source"===e["aws-target-type"]?{share_with_sources:[e["aws-sources-select"]]}:{share_with_accounts:[e["aws-account-id"]]},v={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"aws",upload_request:{type:"aws",options:f}}],customizations:u};g.push(v)}if(null!==(r=e["target-environment"])&&void 0!==r&&r.gcp){var h="";switch(e["google-account-type"]){case"googleAccount":h="user:".concat(e["google-email"]);break;case"serviceAccount":h="serviceAccount:".concat(e["google-email"]);break;case"googleGroup":h="group:".concat(e["google-email"]);break;case"domain":h="domain:".concat(e["google-domain"])}var b={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"gcp",upload_request:{type:"gcp",options:{share_with_accounts:[h]}}}],customizations:u};g.push(b)}if(null!==(i=e["target-environment"])&&void 0!==i&&i.azure){var y={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"azure",upload_request:{type:"azure",options:{tenant_id:e["azure-tenant-id"],subscription_id:e["azure-subscription-id"],resource_group:e["azure-resource-group"]}}}],customizations:u};g.push(y)}if(null!==(l=e["target-environment"])&&void 0!==l&&l.vsphere){var E={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vsphere",upload_request:{type:"aws.s3",options:{}}}],customizations:u};g.push(E)}if(null!==(s=e["target-environment"])&&void 0!==s&&s["guest-image"]){var T={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"guest-image",upload_request:{type:"aws.s3",options:{}}}],customizations:u};g.push(T)}if(null!==(c=e["target-environment"])&&void 0!==c&&c["image-installer"]){var w={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"image-installer",upload_request:{type:"aws.s3",options:{}}}],customizations:u};g.push(w)}return g}(t);Promise.all(r.map((function(e){return I.Z.composeImage(e).then((function(t){a((0,_t.tE)({compose:zt(zt({},t),{},{request:e,image_status:{status:"pending"}}),insert:!0}))}))}))).then((function(){l((0,Ot.y)("")),a((0,d.wN)({variant:"success",title:"Your image is being created"})),n(!1)})).catch((function(e){a((0,d.wN)({variant:"danger",title:"Your image could not be created",description:"Status code "+e.response.status+": "+e.response.statusText})),n(!1)}))},defaultArch:"x86_64",customValidatorMapper:{fileSystemConfigurationValidator:At,targetEnvironmentValidator:Pt},schema:{fields:[{component:m.Z.WIZARD,name:"image-builder-wizard",className:"imageBuilder",isDynamic:!0,inModal:!0,onKeyDown:function(e){!function(e,t){"Escape"===e.key&&t()}(e,y)},buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release","custom-repositories"],description:u().createElement(u().Fragment,null,"Image builder allows you to create a custom image and push it to target environments. ",u().createElement(St.Z,null)),fields:[kt,n,et,ht,Tt,bt,yt,wt,Zt,Ct,xt],initialState:{activeStep:(null==f||null===(t=f.state)||void 0===t?void 0:t.initialStep)||"image-output",activeStepIndex:b.length,maxStepIndex:b.length,prevSteps:b}}]},initialValues:h})}},77310:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(93264),r=n.n(a),i=n(3669),o=n(50470);const l=function(){return r().createElement(i.Button,{component:"a",target:"_blank",variant:"link",icon:r().createElement(o.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/creating_customized_rhel_images_using_the_image_builder_service/index"},"Documentation")}},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{},45467:()=>{},81754:()=>{},70347:()=>{},11452:()=>{},34946:()=>{},10497:()=>{},32857:()=>{},93818:()=>{},94498:()=>{},10108:()=>{},54476:()=>{},28992:()=>{},80897:()=>{},30187:()=>{},40837:()=>{},90479:()=>{},78752:()=>{},74282:()=>{},98379:()=>{},25238:()=>{},1508:()=>{},91993:()=>{},99624:()=>{},36974:()=>{},27479:()=>{},66822:()=>{},93661:()=>{},56024:()=>{},67761:()=>{},43390:()=>{},22143:()=>{},314:()=>{},49854:()=>{},40209:()=>{},87234:()=>{},38299:()=>{},72816:()=>{},11177:()=>{}}]);
//# sourceMappingURL=../sourcemaps/802.c93b92c3834a5aa8386bb8dde11508e8.js.map