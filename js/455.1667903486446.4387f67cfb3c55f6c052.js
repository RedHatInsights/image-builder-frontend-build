"use strict";(self.webpackChunkimage_builder=self.webpackChunkimage_builder||[]).push([[455],{38803:(e,t,n)=>{n.d(t,{Z:()=>D});var r=n(75418),a=n.n(r),o=n(86706),s=n(61390),i=n(80785),c=n(29439),u=n(75857),l=n(87462),p=n(93433),d=n(4942),m=n(45697),h=n.n(m),g=n(83215),f=n(84564),v=n(34046),y=n(20573),b=n(58061),_=n(89136),w=n(52500),O=n(68224),x=n(55808);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=(0,y.P1)([_.$L,_.Kh],(function(e,t){var n=new Set;return n.add(e.region),t.map((function(t){t.region&&t.share_with_accounts[0]===e.share_with_accounts[0]&&"failure"!==t.status&&n.add(t.region)})),n})),E=function(e){var t=e.composeId,n=e.handleClose,i=e.handleToggle,d=e.isOpen,m=e.setIsOpen,h=(0,o.I0)(),y=(0,s.useNavigate)(),S=(0,r.useState)(!1),E=(0,c.Z)(S,2),I=E[0],Z=E[1],j=(0,r.useState)([]),C=(0,c.Z)(j,2),A=C[0],D=C[1],q="Clone this image",T=(0,r.useState)("default"),R=(0,c.Z)(T,2),U=R[0],L=R[1],H=(0,r.useState)("Select at least one region to share to."),M=(0,c.Z)(H,1)[0],N=(0,o.v9)((function(e){return(0,_.$L)(e,t)})),B=(0,o.v9)((function(e){return k(e,t)})),F=(0,r.useState)(function(e){return b.Wp.map((function(t){return P(P({},t),{},{disabled:e.has(t.value)})}))}(B)),V=(0,c.Z)(F,1)[0];return a().createElement(u.Form,null,a().createElement("span",{id:q,hidden:!0},"Select a region"),a().createElement(u.FormGroup,{label:"Select region",isRequired:!0,validated:U,helperTextInvalid:M,helperTextInvalidIcon:a().createElement(f.ZP,null),labelIcon:a().createElement(u.Popover,{headerContent:a().createElement("div",null,"Sharing images to other regions"),bodyContent:a().createElement("div",null,"Your image will be built, uploaded to AWS, and shared to the regions you select. The shared image will expire within 14 days. To permanently access the image, copy the image, which will be shared to your account by Red Hat, to your own AWS account.")},a().createElement("button",{type:"button","aria-label":"More info for name field",onClick:function(e){return e.preventDefault()},"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},a().createElement(v.ZP,{noVerticalAlign:!0})))},a().createElement(u.Select,{variant:u.SelectVariant.typeaheadMulti,typeAheadAriaLabel:"Select a region",onToggle:i,onSelect:function(e,t){var n;A.includes(t)?(n=A.filter((function(e){return e!==t})),D(n)):(n=[].concat((0,p.Z)(A),[t]),D(n)),0===n.length?L("error"):L("default")},onClear:function(){D([]),m(!1),L("error")},selections:A,isOpen:d,"aria-labelledby":q,placeholderText:"Select a region",menuAppendTo:"parent",validated:U,maxHeight:"25rem"},V.map((function(e,t){return a().createElement(u.SelectOption,(0,l.Z)({isDisabled:e.disabled,key:t,value:e.value},e.description&&{description:e.description}))})))),a().createElement(u.ActionGroup,null,a().createElement(u.Button,{onClick:function(){Z(!0);var e=A.map((function(e){return{region:e,share_with_accounts:[N.share_with_accounts[0]]}}));Promise.all(e.map((function(e){return w.Z.cloneImage(t,e).then((function(n){h((0,O.$0)({clone:P(P({},n),{},{request:e,image_status:{status:"pending"}}),parent:t}))}))}))).then((function(){y((0,x.y)("")),h((0,g.wN)({variant:"success",title:"Your image is being shared"})),Z(!1)})).catch((function(e){y((0,x.y)("")),h((0,g.wN)({variant:"danger",title:"Your image could not be created",description:"Status code ".concat(e.response.status,": ").concat(e.response.statusText)}))}))},variant:"primary",key:"share",isDisabled:0===A.length||I,isLoading:I},"Share"),a().createElement(u.Button,{variant:"link",onClick:n,key:"cancel"},"Cancel")))};E.propTypes={composeId:h().string,handleClose:h().func,handleToggle:h().func,isOpen:h().bool,setIsOpen:h().bool};const I=E,Z=function(){var e,t=(0,s.useNavigate)(),n=(0,s.useLocation)(),o=function(){return t((0,x.y)(""))},i=(0,r.useState)(!1),l=(0,c.Z)(i,2),p=l[0],d=l[1],m=null==n||null===(e=n.state)||void 0===e?void 0:e.composeId,h=function(e){return d(e)};return a().createElement(u.Modal,{isOpen:!0,variant:"small","aria-label":"Share to new region",onClose:o,title:"Share to new region",description:"Configure new regions for this image that will run on your AWS. All the regions will launch with the same configuration.",onEscapePress:function(){p?h(p):o()}},a().createElement(I,{composeId:m,handleClose:o,handleToggle:h,isOpen:p,setIsOpen:d}))};var j=(0,r.lazy)((function(){return Promise.all([n.e(6),n.e(405)]).then(n.bind(n,71405))})),C=(0,r.lazy)((function(){return Promise.all([n.e(883),n.e(6),n.e(232)]).then(n.bind(n,44850))})),A=function(){return a().createElement(s.Routes,null,a().createElement(s.Route,{path:(0,x.y)("imagewizard/*"),element:a().createElement(C,null)}),a().createElement(s.Route,{path:(0,x.y)("*"),element:a().createElement(j,null)}),a().createElement(s.Route,{path:(0,x.y)("share/*"),element:a().createElement(Z,null)}))};const D=function(e){var t=(0,s.useNavigate)(),n=(0,o.oR)();return(0,r.useEffect)((function(){document.title="Image Builder | Red Hat Insights",insights.chrome.init(),insights.chrome.identifyApp("image-builder");var e=insights.chrome.on("APP_NAVIGATION",(function(e){return t("/".concat(e.navId))}));return function(){e()}}),[]),a().createElement(a().Fragment,null,a().createElement(i.ZP,{store:n}),a().createElement(A,{childProps:e}))}},55808:(e,t,n)=>{function r(e){var t="/",n=e.split("/");return n.shift(),"beta"===n[0]&&(n.shift(),t="/beta/"),"".concat(t)}function a(e){return"/insights/image-builder/".concat(e)}n.d(t,{e:()=>r,y:()=>a})},52500:(e,t,n)=>{n.d(t,{Z:()=>E});var r,a=n(4942),o=n(45987),s=n(15861),i=n(87757),c=n.n(i),u=n(9669),l=n.n(u),p=n(58061),d=(r={},(0,a.Z)(r,p.F2,[{name:"baseos",distribution_arch:"x86_64",url:"https://cdn.redhat.com/content/dist/rhel8/8.6/x86_64/baseos/os"},{distribution_arch:"x86_64",name:"appstream",url:"https://cdn.redhat.com/content/dist/rhel8/8.6/x86_64/appstream/os"},{distribution_arch:"x86_64",name:"google-compute-engine",url:"https://packages.cloud.google.com/yum/repos/google-compute-engine-el8-x86_64-stable"},{distribution_arch:"x86_64",name:"rhel-86-google-cloud-sdk",url:"https://packages.cloud.google.com/yum/repos/cloud-sdk-el8-x86_64"}]),(0,a.Z)(r,p.PV,[{name:"baseos",distribution_arch:"x86_64",url:"https://cdn.redhat.com/content/dist/rhel9/9.0/x86_64/baseos/os"},{distribution_arch:"x86_64",name:"appstream",url:"https://cdn.redhat.com/content/dist/rhel9/9.0/x86_64/appstream/os"},{distribution_arch:"x86_64",name:"google-compute-engine",url:"https://packages.cloud.google.com/yum/repos/google-compute-engine-el9-x86_64-stable"},{distribution_arch:"x86_64",name:"google-cloud-sdk",url:"https://packages.cloud.google.com/yum/repos/cloud-sdk-el9-x86_64"}]),(0,a.Z)(r,"centos-8",[{name:"baseos",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/"},{name:"appstream",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/"},{name:"extras",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/8-stream/extras/x86_64/os/"},{name:"google-compute-engine",distribution_arch:"x86_64",url:"https://packages.cloud.google.com/yum/repos/google-compute-engine-el8-x86_64-stable"},{name:"google-cloud-sdk",distribution_arch:"x86_64",url:"https://packages.cloud.google.com/yum/repos/cloud-sdk-el8-x86_64"}]),(0,a.Z)(r,"centos-9",[{name:"baseos",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/9-stream/BaseOS/x86_64/os/"},{name:"appstream",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/9-stream/AppStream/x86_64/os/"},{name:"extras",distribution_arch:"x86_64",url:"http://mirror.centos.org/centos/9-stream/extras/x86_64/os/"},{name:"google-compute-engine",distribution_arch:"x86_64",url:"https://packages.cloud.google.com/yum/repos/google-compute-engine-el9-x86_64-stable"},{name:"google-cloud-sdk",distribution_arch:"x86_64",url:"https://packages.cloud.google.com/yum/repos/cloud-sdk-el9-x86_64"}]),r),m=["package_name"];function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={headers:{"Content-Type":"application/json"}};function v(){return(v=(0,s.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().post(p.DO.concat("/compose"),t,f);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=(0,s.Z)(c().mark((function e(t,n){var r,a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams({limit:t,offset:n}),a="/composes?"+r.toString(),e.next=4,l().get(p.DO.concat(a));case 4:return o=e.sent,e.abrupt("return",o.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=(0,s.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/composes/"+t,e.next=3,l().get(p.DO.concat(n));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,s.Z)(c().mark((function e(t,n,r,a){var o,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new URLSearchParams({distribution:t,architecture:n,search:r}),a&&o.append("limit",a),s="/packages?"+o.toString(),e.next=5,l().get(p.DO.concat(s));case 5:return i=e.sent,e.abrupt("return",i.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=(0,s.Z)(c().mark((function e(t,n){var r,a,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d[t].map((function(e){return e.url})),a={urls:r,search:n},e.next=5,l().post(p.Hp.concat("/rpms/names"),a,f);case 5:return s=e.sent,i=s.data.map((function(e){return g({name:e.package_name},(0,o.Z)(e,m))})),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=(0,s.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(p.DO.concat("/version"));case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=(0,s.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(p.UD.concat("/activation_keys"));case 3:return t=e.sent,e.abrupt("return",t.data.body);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=(0,s.Z)(c().mark((function e(t,n,r){var a,o,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({limit:n,offset:r}),o="/composes/".concat(t,"/clones?").concat(a),e.next=4,l().get(p.DO.concat(o));case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=(0,s.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/clones/".concat(t),e.next=3,l().get(p.DO.concat(n));case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=(0,s.Z)(c().mark((function e(t,n){var r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/composes/".concat(t,"/clone"),e.next=3,l().post(p.DO.concat(r),n,f);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const E={cloneImage:function(e,t){return k.apply(this,arguments)},composeImage:function(e){return v.apply(this,arguments)},getClones:function(e,t,n){return S.apply(this,arguments)},getCloneStatus:function(e){return P.apply(this,arguments)},getComposes:function(e,t){return y.apply(this,arguments)},getComposeStatus:function(e){return b.apply(this,arguments)},getPackages:function(e,t,n,r){return _.apply(this,arguments)},getPackagesContentSources:function(e,t){return w.apply(this,arguments)},getVersion:function(){return O.apply(this,arguments)},getActivationKeys:function(){return x.apply(this,arguments)}}},58061:(e,t,n)=>{n.d(t,{DO:()=>o,F2:()=>c,Hp:()=>i,LB:()=>f,NF:()=>h,PV:()=>u,UD:()=>s,Wp:()=>g,at:()=>d,fI:()=>l,g7:()=>p,rh:()=>m});var r,a=n(4942),o="/api/image-builder/v1",s="/api/rhsm/v2",i="/api/content-sources/v1",c="rhel-86",u="rhel-90",l=Math.pow(1024,1),p=Math.pow(1024,2),d=Math.pow(1024,3),m=(r={},(0,a.Z)(r,c,"Red Hat Enterprise Linux (RHEL) 8"),(0,a.Z)(r,u,"Red Hat Enterprise Linux (RHEL) 9"),(0,a.Z)(r,"centos-8","CentOS Stream 8"),(0,a.Z)(r,"centos-9","CentOS Stream 9"),r),h="us-east-1",g=[{description:"US East (Ohio)",value:"us-east-2"},{description:"US East (N. Virginia)",value:"us-east-1"},{description:"US West (N. California)",value:"us-west-1"},{description:"US West (Oregon)",value:"us-west-2"},{description:"Africa (Cape Town)",value:"af-south-1"},{description:"Asia Pacific (Hong Kong)",value:"ap-east-1"},{description:"Asia Pacific (Jakarta)",value:"ap-southeast-3"},{description:"Asia Pacific (Mumbai)",value:"ap-south-1"},{description:"Asia Pacific (Osaka)",value:"ap-northeast-3"},{description:"Asia Pacific (Seoul)",value:"ap-northeast-2"},{description:"Asia Pacific (Singapore)",value:"ap-southeast-1"},{description:"Asia Pacific (Sydney)",value:"ap-southeast-2"},{description:"Asia Pacific (Tokyo)",value:"ap-northeast-1"},{description:"Canada (Central)",value:"ca-central-1"},{description:"Europe (Frankfurt)",value:"eu-central-1"},{description:"Europe (Ireland)",value:"eu-west-1"},{description:"Europe (London)",value:"eu-west-2"},{description:"Europe (Milan)",value:"eu-south-1"},{description:"Europe (Paris)",value:"eu-west-3"},{description:"Europe (Stockholm)",value:"eu-north-1"},{description:"Middle East (Bahrain)",value:"me-south-1"},{description:"Middle East (UAE)",value:"me-central-1"},{description:"South America (SÃ£o Paolo)",value:"sa-east-1"}],f=6},68224:(e,t,n)=>{n.d(t,{$0:()=>c,IZ:()=>u,ZP:()=>l,d0:()=>s});var r=n(4942);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var o=(0,n(75072).oM)({name:"clones",initialState:{allIds:[],byId:{},error:null},reducers:{cloneAdded:function(e,t){e.allIds.includes(t.payload.clone.id)||e.allIds.push(t.payload.clone.id),e.byId[t.payload.clone.id]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.payload.clone),e.byId[t.payload.clone.id].parent=t.payload.parent,e.error=null},cloneUpdatedStatus:function(e,t){var n={status:t.payload.status.status,upload_status:t.payload.status};e.byId[t.payload.id].image_status=n}}}),s=function(e,t){var n,r,a,o,s,i=e.clones.byId[t];return void 0!==i?{created_at:i.created_at,id:i.id,region:i.request.region,ami:null===(n=i.image_status)||void 0===n||null===(r=n.upload_status)||void 0===r||null===(a=r.options)||void 0===a?void 0:a.ami,share_with_accounts:i.request.share_with_accounts,status:null===(o=i.image_status)||void 0===o?void 0:o.status,uploadStatus:null===(s=i.image_status)||void 0===s?void 0:s.upload_status,parent:i.parent,imageType:"ami",isClone:!0}:null},i=o.actions,c=i.cloneAdded,u=i.cloneUpdatedStatus;const l=o.reducer},89136:(e,t,n)=>{n.d(t,{$L:()=>c,$P:()=>l,H0:()=>g,Hj:()=>d,Kh:()=>u,Po:()=>f,ZP:()=>v,fl:()=>p,tE:()=>h});var r=n(93433),a=n(75072),o=n(20573),s=n(68224),i=(0,a.oM)({name:"composes",initialState:{count:0,allIds:[],byId:{},error:null},reducers:{composeAdded:function(e,t){e.allIds.includes(t.payload.compose.id)||(t.payload.insert?e.allIds.unshift(t.payload.compose.id):e.allIds.push(t.payload.compose.id)),e.byId[t.payload.compose.id]=t.payload.compose,e.byId[t.payload.compose.id].clones||(e.byId[t.payload.compose.id].clones=[]),e.error=null},composesUpdatedCount:function(e,t){e.count=t.payload.count},composeUpdatedStatus:function(e,t){e.byId[t.payload.id].image_status=t.payload.status}},extraReducers:function(e){e.addCase("clones/cloneAdded",(function(e,t){e.byId[t.payload.parent].clones.push(t.payload.clone.id)}))}}),c=function(e,t){var n,a,o,s,i,c,u,l,p,d=e.composes.byId[t];return void 0!==d?{created_at:d.created_at,id:d.id,imageName:d.image_name||d.id,region:null===(n=d.image_status)||void 0===n||null===(a=n.upload_status)||void 0===a||null===(o=a.options)||void 0===o?void 0:o.region,ami:null===(s=d.image_status)||void 0===s||null===(i=s.upload_status)||void 0===i||null===(c=i.options)||void 0===c?void 0:c.ami,share_with_accounts:null===(u=d.request.image_requests[0].upload_request)||void 0===u?void 0:u.options.share_with_accounts,status:null===(l=d.image_status)||void 0===l?void 0:l.status,clones:(0,r.Z)(d.clones),imageType:d.request.image_requests[0].image_type,uploadType:d.request.image_requests[0].upload_request.type,uploadOptions:d.request.image_requests[0].upload_request.options,uploadStatus:null===(p=d.image_status)||void 0===p?void 0:p.upload_status,request:d.request,isClone:!1}:null},u=function(e,t){var n=e.composes.byId[t];return 0!==n.clones.length?n.clones.map((function(t){var n,r,a,o,s=e.clones.byId[t];return{created_at:s.created_at,id:s.id,region:s.request.region,ami:null===(n=s.image_status)||void 0===n||null===(r=n.upload_status)||void 0===r||null===(a=r.options)||void 0===a?void 0:a.ami,share_with_accounts:s.request.share_with_accounts,status:null===(o=s.image_status)||void 0===o?void 0:o.status}})):[]},l=function(e,t){return e.composes.allIds.includes(t)?c(e,t):(0,s.d0)(e,t)},p=(0,o.P1)([c,u],(function(e,t){return[e].concat((0,r.Z)(t))})),d=(0,o.P1)([p],(function(e){return e.map((function(e){return e.status}))})),m=i.actions,h=m.composeAdded,g=m.composesUpdatedCount,f=m.composeUpdatedStatus;const v=i.reducer},30319:(e,t,n)=>{n.d(t,{h:()=>l});var r=n(75072),a=n(38756),o=n.n(a),s=n(83215),i=n(68224),c=n(89136),u={clones:i.ZP,composes:c.ZP,notifications:s.ee},l=(0,r.xC)({reducer:u,middleware:function(e){return e().concat(o())}})}}]);
//# sourceMappingURL=../sourcemaps/455.b011df4b33a6f89d03c0b6b75a0cd009.js.map