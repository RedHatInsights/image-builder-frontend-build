(self.webpackChunkimage_builder=self.webpackChunkimage_builder||[]).push([[935],{25403:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>it});var a=n(4942),r=n(29439),i=n(15861),o=n(87757),l=n.n(o),s=n(75418),c=n.n(s),u=n(87462),m=n(45987),d=n(79442),p=n(67850),g=n(80124),f=n(75857),v=n(45697),h=n.n(v),y=n(31006),b=n(34046),E=n(48880),T=n(96354),x=n(64124),w=n(58061);const S=function(e){switch(e){case w.F2:case w.PV:return!0;default:return!1}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["target-environment"],n=e.release,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.skipAws,i=a.skipGoogle,o=a.skipAzure;return!r&&null!=t&&t.aws?"aws-target-env":!i&&null!=t&&t.gcp?"google-cloud-target-env":!o&&null!=t&&t.azure?"ms-azure-target-env":S(n)?"registration":"File system configuration"};var Z=function(e){var t=e.id,n=e.formFields,a=e.formRef,r=e.title,i=e.customTitle,o=e.showTitle,l=e.showTitles;return c().createElement("div",{id:t,ref:a,className:"pf-c-form"},(l&&!1!==o||o)&&(i||c().createElement(f.Title,{headingLevel:"h1",size:"xl"},r)),n)};Z.propTypes={id:h().string,title:h().node,customTitle:h().node,formFields:h().array.isRequired,formOptions:h().shape({renderForm:h().func.isRequired}).isRequired,showTitles:h().bool,showTitle:h().bool,formRef:h().oneOfType([h().func,h().shape({current:h().instanceOf(Element)})])};const I=Z;var L={googleAccount:"Google account",serviceAccount:"Service account",googleGroup:"Google group",domain:"Domain"},O=function(e){var t=e.appendTo;return c().createElement(f.Popover,{appendTo:t,hasAutoWidth:!0,maxWidth:"35rem",headerContent:"Valid account types",flipBehavior:["right","bottom","top","left"],bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"The following account types can have an image shared with them:"),c().createElement(f.TextList,{className:"pf-u-ml-0"},c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google account:")," A Google account represents a developer, an administrator, or any other person who interacts with Google Cloud. e.g., ",c().createElement("em",null,"`alice@gmail.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Service account:")," A service account is an account for an application instead of an individual end user. e.g.,"," ",c().createElement("em",null,"`myapp@appspot.gserviceaccount.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google group:")," A Google group is a named collection of Google accounts and service accounts. e.g.,"," ",c().createElement("em",null,"`admins@example.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google Workspace domain/Cloud Identity domain:")," A Google workspace or cloud identity domain represents a virtual group of all the Google accounts in an organization. These domains represent your organization's internet domain name. e.g.,"," ",c().createElement("em",null,"`mycompany.com`"),".")))},c().createElement(f.Button,{variant:"plain","aria-label":"Account info","aria-describedby":"google-account-type",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))};O.propTypes={appendTo:h().any};const C={StepTemplate:I,id:"wizard-target-gcp",title:"Google Cloud Platform",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Google Cloud Platform"),name:"google-cloud-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return k(t,{skipGoogle:!0,skipAws:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"google-cloud-text-component",label:c().createElement(f.Text,null,"Your image will be uploaded to Google Cloud Platform and shared with the email you provide below. ",c().createElement("br",null),"The image should be copied to your account within 14 days.")},{component:"radio-popover",label:"Type",isRequired:!0,Popover:O,name:"google-account-type",initialValue:"googleAccount",options:Object.entries(L).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return{label:"domain"===n?"Google Workspace domain or Cloud Identity domain":a,value:n,autoFocus:"googleAccount"===n}})),validate:[{type:x.Z.REQUIRED}]},{component:T.Z.TEXT_FIELD,name:"google-email","data-testid":"input-google-email",type:"text",label:"Email address",condition:{or:[{when:"google-account-type",is:"googleAccount"},{when:"google-account-type",is:"serviceAccount"},{when:"google-account-type",is:"googleGroup"},{when:"google-account-type",is:null}]},isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",message:"Please enter a valid email address"}]},{component:T.Z.TEXT_FIELD,name:"google-domain",type:"text",label:"Domain",condition:{when:"google-account-type",is:"domain"},isRequired:!0,validate:[{type:x.Z.REQUIRED}]}]};function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var A=function(e){var t=(0,u.Z)({},e);return c().createElement(y.TableComposable,{"aria-label":"File system configuration table",variant:"compact"},c().createElement(y.Thead,null,c().createElement(y.Tr,null,c().createElement(y.Th,null,"Mount point"),c().createElement(y.Th,null,"Type"),c().createElement(y.Th,null,"Minimum size"))),c().createElement(y.Tbody,{"data-testid":"file-system-configuration-tbody-review"},t.fsc.map((function(e,t){return c().createElement(y.Tr,{key:t},c().createElement(y.Td,{className:"pf-m-width-60"},e.mountpoint),c().createElement(y.Td,{className:"pf-m-width-10"},"xfs"),c().createElement(y.Td,{className:"pf-m-width-30"},e.size," ",e.unit===w.at?"GiB":e.unit===w.g7?"MiB":"KiB"))}))))};A.propTypes={fsc:h().arrayOf(h().object).isRequired};const _=function(){var e,t,n,a,o,u,m,d,p,g,v,h,y,T,x,k,Z,I,O,C,_,P,D,R,N,V,j,q,F,B,G,M,U,W,H,X,K,Q,$,Y,J,ee,te,ne,ae,re,ie,oe,le,se,ce,ue,me,de,pe,ge,fe,ve,he,ye,be,Ee=(0,s.useState)(0),Te=(0,r.Z)(Ee,2),xe=Te[0],we=Te[1],Se=(0,s.useState)(),ke=(0,r.Z)(Se,2),Ze=ke[0],Ie=ke[1],Le=(0,s.useState)(),Oe=(0,r.Z)(Le,2),Ce=Oe[0],ze=Oe[1],Ae=(0,E.default)(),_e=Ae.change,Pe=Ae.getState;return(0,s.useEffect)((function(){var e,t,n,a,r,o,s=null===(e=Pe())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["register-system"];if("register-now"!==s&&"register-now-insights"!==s||(0,i.Z)(l().mark((function e(){var t,n,a,r,i,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a?void 0:a.getUser();case 2:o=e.sent,s=null==o||null===(r=o.identity)||void 0===r||null===(i=r.internal)||void 0===i?void 0:i.org_id,Ie(s),_e("subscription-organization-id",s);case 6:case"end":return e.stop()}}),e)})))(),"manual"===(null===(n=Pe())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["file-system-config-toggle"])&&null!==(r=Pe())&&void 0!==r&&null!==(o=r.values)&&void 0!==o&&o["file-system-configuration"]){var c,u=0,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(Pe().values["file-system-configuration"]);try{for(m.s();!(c=m.n()).done;){var d=c.value;u+=d.size*d.unit}}catch(e){m.e(e)}finally{m.f()}u=(u/w.at).toFixed(1),ze(u<1?"Less than 1 GiB":"".concat(u," GiB"))}})),c().createElement(c().Fragment,null,c().createElement(f.Text,null,'Review the information and click "Create image" to create the image using the following criteria.'),c().createElement(f.DescriptionList,{isCompact:!0,isHorizontal:!0},c().createElement(f.DescriptionListGroup,null,(null===(e=Pe())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["image-name"])&&c().createElement(c().Fragment,null,c().createElement(f.DescriptionListTerm,null,"Image name"),c().createElement(f.DescriptionListDescription,null,null===(n=Pe())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["image-name"])),c().createElement(f.DescriptionListTerm,null,"Release"),c().createElement(f.DescriptionListDescription,null,w.rh[null===(o=Pe())||void 0===o||null===(u=o.values)||void 0===u?void 0:u.release]))),c().createElement(f.Tabs,{isFilled:!0,activeKey:xe,onSelect:function(e,t){we(t)},className:"pf-u-w-75"},c().createElement(f.Tab,{eventKey:0,title:c().createElement(f.TabTitleText,null,"Target environment"),"data-testid":"tab-target",autoFocus:!0},c().createElement(f.List,{isPlain:!0,iconSize:"large"},(null===(m=Pe())||void 0===m||null===(d=m.values)||void 0===d||null===(p=d["target-environment"])||void 0===p?void 0:p.aws)&&c().createElement(f.ListItem,{icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Amazon Web Services"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Account ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(g=Pe())||void 0===g||null===(v=g.values)||void 0===v?void 0:v["aws-account-id"])))),(null===(h=Pe())||void 0===h||null===(y=h.values)||void 0===y||null===(T=y["target-environment"])||void 0===T?void 0:T.gcp)&&c().createElement(f.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Google Cloud Platform"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},null==L?void 0:L[null===(x=Pe())||void 0===x||null===(k=x.values)||void 0===k?void 0:k["google-account-type"]]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},(null===(Z=Pe())||void 0===Z||null===(I=Z.values)||void 0===I?void 0:I["google-email"])||(null===(O=Pe())||void 0===O||null===(C=O.values)||void 0===C?void 0:C["google-domain"]))))),(null===(_=Pe())||void 0===_||null===(P=_.values)||void 0===P||null===(D=P["target-environment"])||void 0===D?void 0:D.azure)&&c().createElement(f.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Microsoft Azure"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(R=Pe())||void 0===R||null===(N=R.values)||void 0===N?void 0:N["azure-subscription-id"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Tenant ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(V=Pe())||void 0===V||null===(j=V.values)||void 0===j?void 0:j["azure-tenant-id"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Resource group"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(q=Pe())||void 0===q||null===(F=q.values)||void 0===F?void 0:F["azure-resource-group"])))),(null===(B=Pe())||void 0===B||null===(G=B.values)||void 0===G||null===(M=G["target-environment"])||void 0===M?void 0:M.vsphere)&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"VMWare"))),(null===(U=Pe())||void 0===U||null===(W=U.values)||void 0===W||null===(H=W["target-environment"])||void 0===H?void 0:H["guest-image"])&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Virtualization - Guest image"))),(null===(X=Pe())||void 0===X||null===(K=X.values)||void 0===K||null===(Q=K["target-environment"])||void 0===Q?void 0:Q["image-installer"])&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Bare metal - Installer"))))),S(null===($=Pe())||void 0===$||null===(Y=$.values)||void 0===Y?void 0:Y.release)&&c().createElement(f.Tab,{eventKey:1,title:c().createElement(f.TabTitleText,null,"Registration"),"data-testid":"tab-registration"},"register-later"===(null===(J=Pe())||void 0===J||null===(ee=J.values)||void 0===ee?void 0:ee["register-system"])&&c().createElement(f.TextContent,null,c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},"Register the system later"))),("register-now"===(null===(te=Pe())||void 0===te||null===(ne=te.values)||void 0===ne?void 0:ne["register-system"])||"register-now-insights"===(null===(ae=Pe())||void 0===ae||null===(re=ae.values)||void 0===re?void 0:re["register-system"]))&&c().createElement(f.TextContent,null,c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},"register-now-insights"===(null===(ie=Pe())||void 0===ie||null===(oe=ie.values)||void 0===oe?void 0:oe["register-system"])&&"Register with Subscriptions and Red Hat Insights","register-now"===(null===(le=Pe())||void 0===le||null===(se=le.values)||void 0===se?void 0:se["register-system"])&&"Register with Subscriptions"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Activation key"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(ce=Pe())||void 0===ce||null===(ue=ce.values)||void 0===ue?void 0:ue["subscription-activation-key"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Organization ID"),void 0!==Ze?c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"organization-id"},Ze):c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},c().createElement(f.Spinner,null))))),c().createElement(f.Tab,{eventKey:2,title:c().createElement(f.TabTitleText,null,"System configuration"),"data-testid":"tab-system"},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"File system configuration"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Partitioning"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"partitioning-auto-manual"},"manual"===(null===(me=Pe())||void 0===me||null===(de=me.values)||void 0===de?void 0:de["file-system-config-toggle"])?"Manual":"Automatic","manual"===(null===(pe=Pe())||void 0===pe||null===(ge=pe.values)||void 0===ge?void 0:ge["file-system-config-toggle"])&&c().createElement(c().Fragment,null," ",c().createElement(f.Popover,{position:"bottom",headerContent:"Partitions",hasAutoWidth:!0,minWidth:"30rem",bodyContent:c().createElement(A,{fsc:Pe().values["file-system-configuration"]})},c().createElement(f.Button,{"data-testid":"file-system-configuration-popover",variant:"link","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info"},"View partitions")))),"manual"===(null===(fe=Pe())||void 0===fe||null===(ve=fe.values)||void 0===ve?void 0:ve["file-system-config-toggle"])&&c().createElement(c().Fragment,null,c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Image size (minimum)",c().createElement(f.Popover,{hasAutoWidth:!0,bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},c().createElement(f.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},Ce))),c().createElement(f.Text,{component:f.TextVariants.h3},"Packages"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Chosen"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"chosen-packages-count"},(null===(he=Pe())||void 0===he||null===(ye=he.values)||void 0===ye||null===(be=ye["selected-packages"])||void 0===be?void 0:be.length)||0))))))};var P=n(41693),D=["label","isRequired"];function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){var t=e.label,n=e.isRequired,i=(0,m.Z)(e,D),o=(0,E.default)(),l=o.getState,u=o.change,d=(0,P.Z)(N({label:t,isRequired:n},i)).input,p=(0,s.useState)({aws:!1,azure:!1,gcp:!1,vsphere:!1,"guest-image":!1,"image-installer":!1}),g=(0,r.Z)(p,2),v=g[0],h=g[1];(0,s.useEffect)((function(){var e,t;null!==(e=l())&&void 0!==e&&null!==(t=e.values)&&void 0!==t&&t[d.name]&&h(l().values[d.name])}),[]);var y=function(e){return h((function(t){var n=N(N({},t),{},(0,a.Z)({},e,!t[e]));return u(d.name,n),n}))},b=function(e,t){" "===e.key&&y(t)};return c().createElement(c().Fragment,null,c().createElement(f.FormGroup,{isRequired:n,label:t,"data-testid":"target-select"},c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Public cloud"),"data-testid":"target-public"},c().createElement("div",{className:"tiles"},c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-aws",title:"Amazon Web Services",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"}),onClick:function(){return y("aws")},onKeyDown:function(e){return b(e,"aws")},isSelected:v.aws,isStacked:!0,isDisplayLarge:!0}),c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-google",title:"Google Cloud Platform",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"}),onClick:function(){return y("gcp")},isSelected:v.gcp,onKeyDown:function(e){return b(e,"gcp")},isStacked:!0,isDisplayLarge:!0}),c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-azure",title:"Microsoft Azure",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"}),onClick:function(){return y("azure")},onKeyDown:function(e){return b(e,"azure")},isSelected:v.azure,isStacked:!0,isDisplayLarge:!0}))),c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Private cloud"),"data-testid":"target-private"},c().createElement(f.Checkbox,{label:"VMWare",isChecked:v.vsphere,onChange:function(){return y("vsphere")},"aria-label":"VMWare checkbox",id:"checkbox-vmware",name:"VMWare","data-testid":"checkbox-vmware"})),c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Other"),"data-testid":"target-other"},c().createElement(f.Checkbox,{label:"Virtualization - Guest image",isChecked:v["guest-image"],onChange:function(){return y("guest-image")},"aria-label":"Virtualization guest image checkbox",id:"checkbox-guest-image",name:"Virtualization guest image","data-testid":"checkbox-guest-image"}),c().createElement(f.Checkbox,{label:"Bare metal - Installer",isChecked:v["image-installer"],onChange:function(){return y("image-installer")},"aria-label":"Bare metal installer checkbox",id:"checkbox-image-installer",name:"Bare metal installer","data-testid":"checkbox-image-installer"}))))};V.propTypes={label:h().node,isRequired:h().bool},V.defaultProps={label:"",isRequired:!1};const j=V;var q=n(93433),F=n(87248),B=n(70196),G=n(5866),M=n(6569),U=n(95511),W=["defaultArch"];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.defaultArch,n=(0,m.Z)(e,W),a=(0,E.default)(),o=a.change,u=a.getState,d=(0,P.Z)(n).input,p=(0,s.useState)(void 0),g=(0,r.Z)(p,2),v=g[0],h=g[1],y=(0,s.useState)(void 0),b=(0,r.Z)(y,2),T=b[0],x=b[1],w=(0,s.useState)(void 0),S=(0,r.Z)(w,2),k=S[0],Z=S[1],I=(0,s.useState)([]),L=(0,r.Z)(I,2),O=L[0],C=L[1],z=(0,s.useState)(!0),A=(0,r.Z)(z,2),_=A[0],D=A[1],R=(0,s.useState)([]),N=(0,r.Z)(R,2),V=N[0],j=N[1],H=(0,s.useState)(!0),K=(0,r.Z)(H,2),Q=K[0],$=K[1],Y=(0,s.useState)(""),J=(0,r.Z)(Y,2),ee=J[0],te=J[1];(0,s.useEffect)((function(){var e,t,n=null===(e=u())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["selected-packages"];n&&j(n)}),[]);var ne=(0,s.useCallback)((function(e){return function(t,n){return t=t.name.toLowerCase(),n=n.name.toLowerCase(),t===e?-1:n===e?1:t.startsWith(e)&&!n.startsWith(e)?-1:n.startsWith(e)&&!t.startsWith(e)?1:t<n?-1:n<t?1:0}})),ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T,n=e.sort(ne(t));C(n)},re=function(e){var t=e.sort(ne(k));j(t)},ie=function(e){return e.filter((function(e){return!V.some((function(t){return e.name===t.name}))}))},oe=function(){var e=(0,i.Z)(l().mark((function e(){var n,a,r,i,o,s,c,m,d,p;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[null===(n=u())||void 0===n||null===(a=n.values)||void 0===a?void 0:a.release,(null===(r=u())||void 0===r||null===(i=r.values)||void 0===i?void 0:i.architecture)||t,v],e.next=3,F.Z.getPackages.apply(F.Z,s);case 3:if(c=e.sent,m=c.data,d=c.meta,(null===(o=m)||void 0===o?void 0:o.length)!==d.count){e.next=10;break}return e.abrupt("return",m);case 10:if(!m){e.next=16;break}return e.next=13,F.Z.getPackages.apply(F.Z,s.concat([d.count]));case 13:return p=e.sent,m=p.data,e.abrupt("return",m);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=(0,i.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(v),e.next=3,oe();case 3:(t=e.sent)?(n=ie(t),ae(n,v),D(!!n.length)):(C([]),D(!1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(e){"Enter"===e.key&&"available"===ee&&(e.stopPropagation(),le())};(0,s.useEffect)((function(){return document.addEventListener("keydown",se,!0),function(){document.removeEventListener("keydown",se,!0)}}));var ce=function(e,t){return void 0===e||!!t.some((function(t){return t.name.includes(e)}))},ue=function(e,t){return!(!e||t.name.includes(e))},me=function(e,t){re(t),ae(e),D(ce(T,e)),$(ce(k,t)),o(d.name,t.map((function(e){return{name:e.name,summary:e.summary}})))},de=function(e,t,n){if(n){var a=(0,q.Z)(V);a[t].selected=!V[t].selected,re(a)}else{var r=(0,q.Z)(O);r[t].selected=!O[t].selected,ae(r)}},pe=(0,s.useRef)(null);return(0,s.useEffect)((function(){var e;null===(e=pe.current)||void 0===e||e.focus()}),[]),c().createElement(f.DualListSelector,null,c().createElement(f.DualListSelectorPane,{title:"Available packages",searchInput:c().createElement(f.SearchInput,{placeholder:"Search for a package","data-testid":"search-available-pkgs-input",value:v,ref:pe,onFocus:function(){return te("available")},onBlur:function(){return te("")},onChange:function(e){return h(e)},submitSearchButtonLabel:"Search button for available packages",onSearch:le,resetButtonLabel:"Clear available packages search",onClear:function(){h(void 0),x(void 0),C([]),D(!0)}})},c().createElement(f.DualListSelectorList,{"data-testid":"available-pkgs-list"},O.length?O.map((function(e,t){return e.isHidden?null:c().createElement(f.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return de(0,t,!1)}},c().createElement(f.TextContent,{key:"".concat(e.name,"-").concat(t)},c().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),c().createElement("small",null,e.summary)))})):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},_?c().createElement(c().Fragment,null,"Search above to add additional",c().createElement("br",null),"packages to your image"):"No packages found"))),c().createElement(f.DualListSelectorControlsWrapper,{"aria-label":"Selector controls"},c().createElement(f.DualListSelectorControl,{isDisabled:!O.some((function(e){return e.selected})),onClick:function(){return e=[],t=O.filter((function(t){return!t.selected||(t.selected=!1,t.isHidden=ue(k,t),e.push(t),!1)})),n=[].concat(e,(0,q.Z)(V)),void me(t,n);var e,t,n},"aria-label":"Add selected",tooltipContent:"Add selected"},c().createElement(U.ZP,null)),c().createElement(f.DualListSelectorControl,{isDisabled:!O.length,onClick:function(){return e=O.map((function(e){return X(X({},e),{},{selected:!1,isHidden:ue(k,e)})})),t=[].concat((0,q.Z)(e),(0,q.Z)(V)),void me([],t);var e,t},"aria-label":"Add all",tooltipContent:"Add all"},c().createElement(M.ZP,null)),c().createElement(f.DualListSelectorControl,{isDisabled:!V.length||!Q,onClick:function(){return e=V.filter((function(e){return e.isHidden})),t=void 0===T?[]:V.filter((function(e){return!e.isHidden&&e.name.includes(T)})).map((function(e){return X(X({},e),{},{selected:!1})})),n=[].concat((0,q.Z)(t),(0,q.Z)(O)),void me(n,e);var e,t,n},"aria-label":"Remove all",tooltipContent:"Remove all"},c().createElement(B.ZP,null)),c().createElement(f.DualListSelectorControl,{onClick:function(){return e=[],t=V.filter((function(t){return!t.selected||(t.selected=!1,t.isHidden=!1,t.name.includes(T)&&e.push(t),!1)})),n=[].concat(e,(0,q.Z)(O)),void me(n,t);var e,t,n},isDisabled:!V.some((function(e){return e.selected}))||!Q,"aria-label":"Remove selected",tooltipContent:"Remove selected"},c().createElement(G.ZP,null))),c().createElement(f.DualListSelectorPane,{title:"Chosen packages",searchInput:c().createElement(f.SearchInput,{placeholder:"Search for a package","data-testid":"search-chosen-pkgs-input",value:k,onFocus:function(){return te("chosen")},onBlur:function(){return te("")},onChange:function(e){return function(e){var t=!1,n=V.map((function(n){return n.name.includes(e)?(n.isHidden=!1,t=!0):n.isHidden=!0,n}));Z(e),$(t),re(n)}(e)},resetButtonLabel:"Clear chosen packages search",onClear:function(){Z(void 0),re(V.map((function(e){return X(X({},e),{},{isHidden:!1})}))),$(!0)}}),isChosen:!0},c().createElement(f.DualListSelectorList,{"data-testid":"chosen-pkgs-list"},V.length?Q?V.map((function(e,t){return e.isHidden?null:c().createElement(f.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return de(0,t,!0)}},c().createElement(f.TextContent,{key:"".concat(e.name,"-").concat(t)},c().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),c().createElement("small",null,e.summary)))})):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages found"):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages added"))))};K.propTypes={defaultArch:h().string};const Q=K;var $=n(41626),Y=["Popover"],J=function(e){var t=e.Popover,n=(0,m.Z)(e,Y),a=(0,s.useRef)();return c().createElement($.Z,(0,u.Z)({},n,{label:c().createElement("span",{ref:a,className:"ins-c-image--builder__popover"},n.label,c().createElement(t,null))}))};J.propTypes={Popover:h().elementType.isRequired,label:h().node};const ee=J,te=function(){var e,t,n=null===(e=(0,(0,E.default)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["azure-tenant-id"],a=new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i");return c().createElement(f.FormGroup,null,c().createElement(f.Button,{component:"a",target:"_blank",variant:"secondary",isDisabled:!a.test(n),href:"https://login.microsoftonline.com/"+n+"/oauth2/v2.0/authorize?client_id=b94bb246-b02c-4985-9c22-d44e66f657f4&scope=openid&response_type=code&response_mode=query&redirect_uri=https://portal.azure.com"},"Authorize Image Builder"))};var ne=n(50470);const ae=function(){var e=(0,s.useState)(!0),t=(0,r.Z)(e,2),n=t[0],a=t[1];return c().createElement(c().Fragment,null,c().createElement(f.ExpandableSection,{className:"azureAuthExpandable",toggleText:c().createElement(f.Title,{headingLevel:"h3"},"Authorizing an Azure account"),onToggle:function(){return a(!n)},isExpanded:n},c().createElement(f.Text,null,'To authorize Image Builder to push images to Microsoft Azure, the account owner must configure Image Builder as an authorized application for a specific tenant ID and give it the role of "Contributor" to at least one resource group.',c().createElement("br",null)),c().createElement("small",null,c().createElement(f.Button,{component:"a",target:"_blank",variant:"link",icon:c().createElement(ne.ZP,null),iconPosition:"right",isInline:!0,href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow"},"Learn more about OAuth 2.0"))))};var re=["label","isRequired"],ie=function(e){var t,n,a=e.label,i=e.isRequired,o=(0,m.Z)(e,re),l=(0,E.default)(),u=l.change,d=l.getState,p=(0,P.Z)(o).input,g=(0,s.useState)([]),v=(0,r.Z)(g,2),h=v[0],y=v[1],b=(0,s.useState)(!1),T=(0,r.Z)(b,2),x=T[0],w=T[1],S=(0,s.useState)(!1),k=(0,r.Z)(S,2),Z=k[0],I=k[1],L=(0,s.useState)(null===(t=d())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["subscription-activation-key"]),O=(0,r.Z)(L,2),C=O[0],z=O[1];return(0,s.useEffect)((function(){I(!0),F.Z.getActivationKeys().then((function(e){y(e),I(!1)}))}),[]),c().createElement(f.FormGroup,{isRequired:i,label:a,"data-testid":"subscription-activation-key"},c().createElement(f.Select,{variant:f.SelectVariant.typeahead,onToggle:function(){return w(!x)},onSelect:function(e,t){z(t),w(!1),u(p.name,t)},onClear:function(){z(),u(p.name,void 0)},selections:C,isOpen:x,placeholderText:"Select activation key",typeAheadAriaLabel:"Select activation key"},Z&&c().createElement(f.SelectOption,{isNoResultsOption:!0,"data-testid":"activation-keys-loading"},c().createElement(f.Spinner,{isSVG:!0,size:"lg"})),h.map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e.name})}))))};ie.propTypes={label:h().node,isRequired:h().bool},ie.defaultProps={label:"",isRequired:!1};const oe=ie;var le=n(54915),se=n(70710),ce=n(20777),ue=n(26246),me=n(44586),de=n(26470),pe=n.n(de);function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var fe=function(e){var t=(0,u.Z)({},e),n=["/app","/data","/home","/opt","/srv","/tmp","/usr","/usr/local","/var","/"],a=(0,s.useState)(!1),i=(0,r.Z)(a,2),o=i[0],l=i[1],m=(0,s.useState)("/"),d=(0,r.Z)(m,2),p=d[0],g=d[1],v=(0,s.useState)(""),h=(0,r.Z)(v,2),y=h[0],b=h[1];return(0,s.useEffect)((function(){var e,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(n);try{for(a.s();!(e=a.n()).done;){var r=e.value;if(t.mountpoint.startsWith(r))return g(r),void b(t.mountpoint.substring(r.length))}}catch(e){a.e(e)}finally{a.f()}}),[]),(0,s.useEffect)((function(){var e=y,n=p;e&&("/"!==n&&"/"!==e[0]&&(e="/"+e),n+=e),t.onChange(pe().normalize(n))}),[p,y]),c().createElement(c().Fragment,null,c().createElement(f.Select,{className:"pf-u-w-50",isOpen:o,onToggle:function(e){l(e)},onSelect:function(e,t){g(t),l(!1)},selections:p,variant:f.SelectVariant.single},n.map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e})}))),"/"!==p&&c().createElement(f.TextInput,{className:"pf-u-w-50",type:"text",value:y,"aria-label":"Mount point suffix text input",onChange:function(e){return b(e)}}))};fe.propTypes={mountpoint:h().string.isRequired,onChange:h().func.isRequired};const ve=fe;var he=function(e){var t=(0,u.Z)({},e),n=(0,s.useState)(!1),a=(0,r.Z)(n,2),i=a[0],o=a[1],l=(0,s.useState)(t.unit||w.at),m=(0,r.Z)(l,2),d=m[0],p=m[1],g=(0,s.useState)(t.size||1),v=(0,r.Z)(g,2),h=v[0],y=v[1];return(0,s.useEffect)((function(){t.onChange(h,d)}),[d,h]),c().createElement(c().Fragment,null,c().createElement(f.TextInput,{className:"pf-u-w-50",type:"text",value:h,"aria-label":"Size text input",onChange:function(e){return y(isNaN(parseInt(e))?0:parseInt(e))}}),c().createElement(f.Select,{className:"pf-u-w-50",isOpen:i,onToggle:function(e){o(e)},onSelect:function(e,t){switch(t){case"KiB":p(w.fI);break;case"MiB":p(w.g7);break;case"GiB":p(w.at)}o(!1)},selections:d===w.fI?"KiB":d===w.g7?"MiB":"GiB",variant:f.SelectVariant.single,"aria-label":"Unit select"},["KiB","MiB","GiB"].map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e})}))))};he.propTypes={size:h().number.isRequired,unit:h().number.isRequired,onChange:h().func.isRequired};const ye=he;function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xe={id:(0,me.Z)(),mountpoint:"/",fstype:"xfs",size:10,unit:w.at};const we=function(e){var t,n,a,i,o,l,m=(0,u.Z)({},e),d=(0,E.default)(),p=d.change,g=d.getState,v=(0,P.Z)(m).input,h=(0,s.useState)(null),T=(0,r.Z)(h,2),x=T[0],S=T[1],k=(0,s.useState)(null),Z=(0,r.Z)(k,2),I=Z[0],L=Z[1],O=(0,s.useState)(!1),C=(0,r.Z)(O,2),z=C[0],A=C[1],_=(0,s.useState)([xe.id]),D=(0,r.Z)(_,2),R=D[0],N=D[1],V=(0,s.useState)([]),j=(0,r.Z)(V,2),F=j[0],B=j[1],G=(0,s.useRef)(),M=(0,s.useState)([xe]),U=(0,r.Z)(M,2),W=U[0],H=U[1];(0,s.useEffect)((function(){var e,t,n=null===(e=g())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["file-system-configuration"];if(n){var a=[],r=[];n.map((function(e){var t=(0,me.Z)();a.push({id:t,mountpoint:e.mountpoint,fstype:"xfs",size:e.size,unit:e.unit}),r.push(t)})),H(a),N(r)}}),[]),(0,s.useEffect)((function(){p(v.name,R.map((function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Te(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(W);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.id===e)return{mountpoint:a.mountpoint,size:a.size,unit:a.unit}}}catch(e){n.e(e)}finally{n.f()}})))}),[W,R]);var X=function(e){var t=G.current,n=Array.from(t.children);if(!n.map((function(e){return e.id})).every((function(t,n){return t===e[n]}))){for(;t.firstChild;)t.removeChild(t.lastChild);e.forEach((function(e){t.appendChild(n.find((function(t){return t.id===e})))}))}},K=function(e){e.preventDefault();var t=e.target.closest("tr");if(!t||!G.current.contains(t))return null;var n=t.id,a=Array.from(G.current.children).findIndex((function(e){return e.id===n}));if(a!==I){var r=function(e,t,n){var a=e.indexOf(t);if(a===n)return e;var r=e.splice(a,1);return e.splice(n,0,r[0]),e}((0,q.Z)(R),x,a);X(r),L(a),B(r)}},Q=function(e){var t=G.current.getBoundingClientRect();return e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height},$=function(e){Q(e)&&N(F)},Y=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.id),e.currentTarget.classList.add(ue.Z.modifiers.ghostRow),e.currentTarget.setAttribute("aria-pressed","true"),S(e.currentTarget.id),A(!0)},J=function(e){e.target.classList.remove(ue.Z.modifiers.ghostRow),e.target.setAttribute("aria-pressed","false"),S(null),L(null),A(!1)};return c().createElement(c().Fragment,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Configure partitions")),W.length>1&&(null===(t=g())||void 0===t||null===(n=t.errors)||void 0===n||null===(a=n["file-system-configuration"])||void 0===a?void 0:a.duplicates)&&c().createElement(f.Alert,{variant:"danger",isInline:!0,title:"Duplicate mount points: All mount points must be unique. Remove the duplicate or choose a new mount point."}),W.length>=1&&!1===(null===(i=g())||void 0===i||null===(o=i.errors)||void 0===o||null===(l=o["file-system-configuration"])||void 0===l?void 0:l.root)&&c().createElement(f.Alert,{variant:"danger",isInline:!0,title:"No root partition configured."}),c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Partitions have been generated and given default values based on best practices from Red Hat, and your selections in previous steps of the wizard.")),c().createElement(y.TableComposable,{"aria-label":"File system table",className:z&&ue.Z.modifiers.dragOver,variant:"compact"},c().createElement(y.Thead,null,c().createElement(y.Tr,null,c().createElement(y.Th,null),c().createElement(y.Th,null,"Mount point"),c().createElement(y.Th,null,"Type"),c().createElement(y.Th,null,"Minimum size",c().createElement(f.Popover,{hasAutoWidth:!0,bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},c().createElement(f.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))),c().createElement(y.Th,null))),c().createElement(y.Tbody,{ref:G,onDragOver:K,onDrop:K,onDragLeave:function(e){Q(e)||(X(R),L(null))},"data-testid":"file-system-configuration-tbody"},W.map((function(e,t){var n,a;return c().createElement(y.Tr,{key:t,id:e.id,draggable:!0,onDrop:$,onDragEnd:J,onDragStart:Y},c().createElement(y.Td,{draggableRow:{id:"draggable-row-".concat(e.id)}}),c().createElement(y.Td,{className:"pf-m-width-30"},c().createElement(ve,{key:e.id+"-mountpoint",mountpoint:e.mountpoint,onChange:function(t){return function(e,t){for(var n=(0,q.Z)(W),a=0;a<n.length;a++)if(n[a].id===e){var r=Ee({},n[a]);r.mountpoint=t,n.splice(a,1,r);break}H(n)}(e.id,t)}}),(null===(n=g().errors["file-system-configuration"])||void 0===n?void 0:n.duplicates)&&-1!==(null===(a=g().errors["file-system-configuration"])||void 0===a?void 0:a.duplicates.indexOf(e.mountpoint))&&c().createElement(f.Alert,{variant:"danger",isInline:!0,isPlain:!0,title:"Duplicate mount point."})),c().createElement(y.Td,{className:"pf-m-width-20"},e.fstype),c().createElement(y.Td,{className:"pf-m-width-30"},c().createElement(ye,{key:e.id+"-sizeunit",size:e.size,unit:e.unit,onChange:function(t,n){return function(e,t,n){for(var a=(0,q.Z)(W),r=0;r<a.length;r++)if(a[r].id===e){var i=Ee({},a[r]);i.size=t,i.unit=n,a.splice(r,1,i);break}H(a)}(e.id,t,n)}})),c().createElement(y.Td,{className:"pf-m-width-10"},c().createElement(f.Button,{variant:"link",icon:c().createElement(se.ZP,null),onClick:function(){return function(e){var t=W.map((function(e){return e.id})).indexOf(e),n=(0,q.Z)(W);n.splice(t,1);var a=R.indexOf(e),r=(0,q.Z)(R);r.splice(a,1),H(n),N(r)}(e.id)}})))})))),c().createElement(f.TextContent,null,c().createElement(f.Button,{"data-testid":"file-system-add-partition",className:"pf-u-text-align-left",variant:"link",icon:c().createElement(ce.ZP,null),onClick:function(){var e=(0,me.Z)();H(W.concat([{id:e,mountpoint:"/home",fstype:"xfs",size:1,unit:w.at}])),N(R.concat([e]))}},"Add partition")))},Se=function(e){var t,n,a=(0,u.Z)({},e),i=(0,E.default)(),o=i.change,l=i.getState,m=(0,P.Z)(a).input,d=(0,s.useState)((null===(t=l())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["file-system-config-toggle"])||"auto"),p=(0,r.Z)(d,2),g=p[0],v=p[1];(0,s.useEffect)((function(){o(m.name,g)}),[g]);var h=function(e,t){v(t.currentTarget.id)};return c().createElement(c().Fragment,null,c().createElement(f.ToggleGroup,{"data-testid":"fsc-paritioning-toggle","aria-label":"Automatic partitioning toggle"},c().createElement(f.ToggleGroupItem,{onChange:h,text:"Use automatic partitioning",buttonId:"auto",isSelected:"auto"===g}),c().createElement(f.ToggleGroupItem,{onChange:h,text:"Manually configure partitions",buttonId:"manual",isSelected:"manual"===g,"data-testid":"file-system-config-toggle-manual"})))};var ke=["label","isRequired"],Ze=function(e){var t,n,a=e.label,i=e.isRequired,o=(0,m.Z)(e,ke),l=(0,E.default)(),u=l.change,d=l.getState,p=(0,P.Z)(o).input,g=(0,s.useState)(!1),v=(0,r.Z)(g,2),h=v[0],y=v[1];return c().createElement(f.FormGroup,{isRequired:i,label:a},c().createElement(f.Select,{variant:f.SelectVariant.single,onToggle:function(){return y(!h)},onSelect:function(e,t){u(p.name,t),y(!1)},onClear:function(){u(p.name,null)},selections:w.rh[null===(t=d())||void 0===t||null===(n=t.values)||void 0===n?void 0:n[p.name]],isOpen:h},Object.entries(w.rh).filter((function(e){var t=(0,r.Z)(e,1)[0];return!!insights.chrome.isBeta()||S(t)})).map((function(e,t){var n=(0,r.Z)(e,2),a=n[0],i=n[1];return c().createElement(f.SelectOption,{key:t,value:a},i)}))))};Ze.propTypes={label:h().node,isRequired:h().bool};const Ie=Ze;var Le=["schema","onSubmit","onClose","customComponentMapper","customValidatorMapper","defaultArch","className"];function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=function(e){var t=e.schema,n=e.onSubmit,a=e.onClose,r=e.customComponentMapper,i=e.customValidatorMapper,o=e.defaultArch,l=e.className,s=(0,m.Z)(e,Le);return t?c().createElement(d.Z,(0,u.Z)({initialValues:s.initialValues,schema:t,className:"image-builder".concat(l?" ".concat(l):""),subscription:{values:!0},FormTemplate:function(e){return c().createElement(p.ZP,(0,u.Z)({},e,{showFormControls:!1}))},onSubmit:function(e){return n(e)},validatorMapper:Ce({},i),componentMapper:Ce(Ce({},g.YS),{},{review:_,output:j,select:le.Z,"package-selector":{component:Q,defaultArch:o},"radio-popover":ee,"azure-auth-expandable":ae,"azure-auth-button":te,"activation-keys":oe,"file-system-config-toggle":Se,"file-system-configuration":we,"image-output-release-select":Ie},r),onCancel:a},s)):c().createElement(f.Spinner,null)};ze.propTypes={schema:h().object,onSubmit:h().func.isRequired,onClose:h().func.isRequired,customComponentMapper:h().shape((0,a.Z)({},h().string,h().oneOfType([h().node,h().shape({component:h().node})]))),customValidatorMapper:h().shape((0,a.Z)({},h().string,h().func)),defaultArch:h().string,className:h().string,initialValues:h().object};const Ae=ze;var _e=n(14194),Pe=n(77310),De=n(86706),Re=n(18247),Ne=n(83215);const Ve={StepTemplate:I,id:"wizard-target-aws",title:"Amazon Web Services",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Amazon Web Service"),name:"aws-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return k(t,{skipAws:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"plain-text-component",label:c().createElement("p",null,"Your image will be uploaded to AWS and shared with the account you provide below. ",c().createElement("br",null),"The image should be copied to your account within 14 days.")},{component:T.Z.TEXT_FIELD,name:"aws-account-id",className:"pf-u-w-25","data-testid":"aws-account-id",type:"text",label:"AWS account ID",isRequired:!0,autoFocus:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.EXACT_LENGTH,threshold:12}]}]},je={StepTemplate:I,id:"wizard-target-msazure",title:"Microsoft Azure",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Microsoft Azure"),name:"ms-azure-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return k(t,{skipAws:!0,skipGoogle:!0,skipAzure:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"azure-description",label:c().createElement(f.Text,null,"Image Builder sends an image to an authorized Azure account.")},{component:"azure-auth-expandable",name:"azure-auth-expandable"},{component:T.Z.PLAIN_TEXT,name:"azure-destination",label:c().createElement(c().Fragment,null,c().createElement(f.Title,{headingLevel:"h2"},"Destination"),c().createElement(f.Text,null,"Your image will be uploaded to the resource group in the subscription you specify."))},{component:T.Z.TEXT_FIELD,name:"azure-tenant-id",className:"pf-u-w-50","data-testid":"azure-tenant-id",type:"text",label:"Tenant ID",required:!0,isRequired:!0,autoFocus:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid tenant ID"}]},{component:"azure-auth-button",name:"azure-auth-button","data-testid":"azure-auth-button",required:!0,isRequired:!0},{component:T.Z.TEXT_FIELD,name:"azure-subscription-id",className:"pf-u-w-50","data-testid":"azure-subscription-id",type:"text",label:"Subscription ID",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid subscription ID"}]},{component:T.Z.TEXT_FIELD,name:"azure-resource-group",className:"pf-u-w-50","data-testid":"azure-resource-group",type:"text",label:"Resource group",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[-\w._()]+[-\w_()]$/,message:"Resource group names only allow alphanumeric characters, periods, underscores, hyphens, and parenthesis and cannot end in a period"}]}]},qe={StepTemplate:I,id:"wizard-systemconfiguration-packages",title:"Packages",name:"packages",substepOf:"System Configuration",nextStep:"image-name",fields:[{component:T.Z.PLAIN_TEXT,name:"packages-text-component",label:c().createElement(f.Text,null,"Add optional additional packages to your image by searching available packages.")},{component:"package-selector",name:"selected-packages",label:"Available options"}]};var Fe=function(){return c().createElement(f.Popover,{hasAutoWidth:!0,maxWidth:"35rem",bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Activation keys allow you to register a system with appropriate subscriptions and system purpose attached."))},c().createElement(f.Button,{variant:"plain","aria-label":"Activation key popover","aria-describedby":"subscription-activation-key",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))};const Be={StepTemplate:I,id:"wizard-registration",title:"Registration",name:"registration",nextStep:"File system configuration",fields:[{component:T.Z.RADIO,label:"Register images with Red Hat",name:"register-system",initialValue:"register-now-insights",options:[{label:"Register and connect image instances with Red Hat",description:"Includes Subscriptions and Red Hat Insights",value:"register-now-insights","data-testid":"radio-register-now-insights",autoFocus:!0},{label:"Register image instances only",description:"Includes Subscriptions only",value:"register-now",className:"pf-u-mt-sm","data-testid":"radio-register-now"},{label:"Register later",value:"register-later",className:"pf-u-mt-sm","data-testid":"radio-register-later"}]},{component:"activation-keys",name:"subscription-activation-key",required:!0,label:c().createElement(c().Fragment,null,"Activation key to use for this image",c().createElement(Fe,null)),condition:{or:[{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]},isRequired:!0,validate:[{type:x.Z.REQUIRED}]},{component:T.Z.PLAIN_TEXT,name:"subscription-activation-description",label:c().createElement(c().Fragment,null,"Create and manage activation keys in the",c().createElement(f.Button,{component:"a",target:"_blank",variant:"link",icon:c().createElement(ne.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/"},"Customer Portal")),condition:{or:[{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]}},{component:T.Z.PLAIN_TEXT,name:"subscription-register-later",label:c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Register Later"),c().createElement(f.Text,null,"On initial boot, systems will need to be registered manually before having access to updates or Red Hat services."),c().createElement(f.Text,null,"Registering now is recommended.")),condition:{or:[{when:"register-system",is:"register-later"}]}}]};var Ge=n(6468),Me=n(70363),Ue=function(e){var t=e.buttonLabels,n=t.cancel,a=t.submit,i=t.back,o=(0,s.useState)(!1),l=(0,r.Z)(o,2),u=l[0],m=l[1],d=(0,s.useContext)(Me.default),p=d.handlePrev,g=d.formOptions;return c().createElement(Ge.lP,null,(function(){return c().createElement(c().Fragment,null,c().createElement(f.Button,{variant:"primary",type:"button",isDisabled:!g.valid||g.getState().validating||u,isLoading:u,onClick:function(){g.onSubmit({values:g.getState().values,setIsSaving:m})}},u?"Creating image":a),c().createElement(f.Button,{type:"button",variant:"secondary",onClick:p,isDisabled:u},i),c().createElement("div",{className:"pf-c-wizard__footer-cancel"},c().createElement(f.Button,{type:"button",variant:"link",onClick:g.onCancel,isDisabled:u},n)))}))};Ue.propTypes={buttonLabels:h().shape({cancel:h().node,submit:h().node,back:h().node}),isSaving:h().bool};const We={StepTemplate:I,id:"wizard-review",name:"review",title:"Review",buttons:Ue,fields:[{name:"review",component:"review"}]},He={StepTemplate:I,id:"wizard-imageoutput",title:"Image output",name:"image-output",nextStep:function(e){var t=e.values;return k(t)},fields:[{component:T.Z.PLAIN_TEXT,name:"image-output-plain-text",label:c().createElement(f.Text,null,"Image builder allows you to create a custom image and push it to target environments.",c().createElement("br",null),c().createElement(Pe.Z,null))},{component:"image-output-release-select",label:"Release",name:"release",initialValue:w.PV,isRequired:!0,validate:[{type:x.Z.REQUIRED}]},{component:"output",name:"target-environment",label:"Select target environments",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:"targetEnvironmentValidator"}]}]},Xe={StepTemplate:I,id:"wizard-systemconfiguration-filesystem",title:"File system configuration",name:"File system configuration",substepOf:"System Configuration",nextStep:"packages",fields:[{component:T.Z.PLAIN_TEXT,name:"file-system-configuration-text-component",label:c().createElement(c().Fragment,null,c().createElement(f.Text,null,"Red Hat recommends using automatic partitioning for most installations."),c().createElement(f.Text,null,"Alternatively, you may manually configure the file system of your image by adding, removing, and editing partitions."))},{component:"file-system-config-toggle",name:"file-system-config-toggle",label:"File system configurations toggle"},{component:"file-system-configuration",name:"file-system-configuration",label:"File system configurations",validate:[{type:"fileSystemConfigurationValidator"},{type:x.Z.REQUIRED}],condition:{when:"file-system-config-toggle",is:"manual"}}]},Ke={StepTemplate:I,id:"wizard-details",name:"image-name",title:"Name image",nextStep:"review",fields:[{component:T.Z.PLAIN_TEXT,name:"plain-text-component",label:c().createElement("p",null,"Optionally enter a name for your image. All images will have a UUID.")},{component:T.Z.TEXT_FIELD,name:"image-name",type:"text",label:"Image name",autoFocus:!0,validate:[{type:x.Z.MAX_LENGTH,threshold:100}]}]};function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const $e=function(){return function(e){if(e){var t,n={},a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(e);try{for(a.s();!(t=a.n()).done;){var i=t.value.mountpoint;i in n?n[i]++:n[i]=1}}catch(e){a.e(e)}finally{a.f()}for(var o=[],l=0,s=Object.entries(n);l<s.length;l++){var c=(0,r.Z)(s[l],2),u=c[0];c[1]>1&&o.push(u)}var m=n["/"]>=1;return 0===o.length&&m?void 0:{duplicates:o===[]?void 0:o,root:m}}}},Ye=function(){return function(e){if(e)return Object.values(e).reduce((function(e,t){return t||e}),!1)?void 0:"Please select an image"}};function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var at=function(e){var t,n;return e%w.at==0?(t=e/w.at,n=w.at):e%w.g7==0?(t=e/w.g7,n=w.g7):e%w.fI==0&&(t=e/w.fI,n=w.fI),[t,n]},rt=function(){var e=(0,i.Z)(l().mark((function e(t,n,a){var r,i,o,s,c,u,m,d,p,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[t,n,a],e.next=3,F.Z.getPackages.apply(F.Z,i);case 3:if(o=e.sent,s=o.data,c=o.meta,(null===(r=s[0])||void 0===r?void 0:r.name)!==a){e.next=10;break}u=null===(m=s[0])||void 0===m?void 0:m.summary,e.next=17;break;case 10:if((null===(d=s)||void 0===d?void 0:d.length)===c.count){e.next=15;break}return e.next=13,F.Z.getPackages.apply(F.Z,i.concat([c.count]));case 13:p=e.sent,s=p.data;case 15:g=s.find((function(e){return a===e.name})),u=null==g?void 0:g.summary;case 17:return e.abrupt("return",u||"");case 18:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();const it=function(){var e,t,n=(0,De.I0)(),a=(0,_e.useNavigate)(),o=(0,_e.useLocation)(),s=null==o||null===(e=o.state)||void 0===e?void 0:e.composeRequest,u=function(e){if(e){var t,n,a,o,s,c,u=e.image_requests[0],m=u.upload_request,d={};if(d["image-name"]=e.image_name,d.release=null==e?void 0:e.distribution,d["target-environment"]={aws:!1,azure:!1,gcp:!1,"guest-image":!1},s="aws.s3"===m.type?u.image_type:m.type,d["target-environment"][s]=!0,"aws"===s)d["aws-account-id"]=null==m||null===(c=m.options)||void 0===c?void 0:c.share_with_accounts[0];else if("azure"===s){var p,g,f;d["azure-tenant-id"]=null==m||null===(p=m.options)||void 0===p?void 0:p.tenant_id,d["azure-subscription-id"]=null==m||null===(g=m.options)||void 0===g?void 0:g.subscription_id,d["azure-resource-group"]=null==m||null===(f=m.options)||void 0===f?void 0:f.resource_group}else if("gcp"===s){var v,h=(null==m||null===(v=m.options)||void 0===v?void 0:v.share_with_accounts[0]).split(":"),y=(0,r.Z)(h,2),b=y[0],E=y[1];switch(b){case"user":d["google-account-type"]="googleAccount",d["google-email"]=E;break;case"serviceAccount":d["google-account-type"]="serviceAccount",d["google-email"]=E;break;case"group":d["google-account-type"]="googleGroup",d["google-email"]=E;break;case"domain":d["google-account-type"]="domain",d["google-domain"]=E}}var T=[];null==e||null===(t=e.customizations)||void 0===t||null===(n=t.packages)||void 0===n||n.forEach(function(){var t=(0,i.Z)(l().mark((function t(n){var a,r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt(null==e?void 0:e.distribution,null==u?void 0:u.architecture,n);case 2:a=t.sent,r={name:n,summary:a},T.push(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d["selected-packages"]=T;var x=null==e||null===(a=e.customizations)||void 0===a?void 0:a.filesystem;if(x){d["file-system-config-toggle"]="manual";var w,S=[],k=tt(x);try{for(k.s();!(w=k.n()).done;){var Z=w.value,I=at(Z.min_size),L=(0,r.Z)(I,2),O=L[0],C=L[1];S.push({mountpoint:Z.mountpoint,size:O,unit:C})}}catch(e){k.e(e)}finally{k.f()}d["file-system-configuration"]=S}var z=null==e||null===(o=e.customizations)||void 0===o?void 0:o.subscription;return z?(z.insights?d["register-system"]="register-now-insights":d["register-system"]="register-now",d["subscription-activation-key"]=z["activation-key"],d["subscription-organization-id"]=z.organization):d["register-system"]="register-later",d}}(s),m=function(e){if(e){var t=e.image_requests[0].upload_request,n=["image-output"];return"aws"===t.type?n.push("aws-target-env"):"azure"===t.type?n.push("azure-target-env"):"gcp"===t.type&&n.push("google-cloud-target-env"),S(null==e?void 0:e.distribution)&&n.push("registration"),n.concat(["File system configuration","packages","image-name"])}return[]}(s),d=function(){return a("/")};return c().createElement(Ae,{onClose:d,onSubmit:function(e){var t=e.values,r=e.setIsSaving;r((function(){return!0}));var i=function(e){var t,n,a,r,i,o,l,s={packages:null===(t=e["selected-packages"])||void 0===t?void 0:t.map((function(e){return e.name}))};if("register-now-insights"===e["register-system"]?s.subscription={"activation-key":e["subscription-activation-key"],insights:!0,organization:Number(e["subscription-organization-id"]),"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/"}:"register-now"===e["register-system"]&&(s.subscription={"activation-key":e["subscription-activation-key"],insights:!1,organization:Number(e["subscription-organization-id"]),"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/"}),"manual"===e["file-system-config-toggle"]){s.filesystem=[];var c,u=tt(e["file-system-configuration"]);try{for(u.s();!(c=u.n()).done;){var m=c.value;s.filesystem.push({mountpoint:m.mountpoint,min_size:m.size*m.unit})}}catch(e){u.e(e)}finally{u.f()}}var d=[];if(null!==(n=e["target-environment"])&&void 0!==n&&n.aws){var p={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"ami",upload_request:{type:"aws",options:{share_with_accounts:[e["aws-account-id"]]}}}],customizations:s};d.push(p)}if(null!==(a=e["target-environment"])&&void 0!==a&&a.gcp){var g="";switch(e["google-account-type"]){case"googleAccount":g="user:".concat(e["google-email"]);break;case"serviceAccount":g="serviceAccount:".concat(e["google-email"]);break;case"googleGroup":g="group:".concat(e["google-email"]);break;case"domain":g="domain:".concat(e["google-domain"])}var f={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"gcp",upload_request:{type:"gcp",options:{share_with_accounts:[g]}}}],customizations:s};d.push(f)}if(null!==(r=e["target-environment"])&&void 0!==r&&r.azure){var v={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vhd",upload_request:{type:"azure",options:{tenant_id:e["azure-tenant-id"],subscription_id:e["azure-subscription-id"],resource_group:e["azure-resource-group"]}}}],customizations:s};d.push(v)}if(null!==(i=e["target-environment"])&&void 0!==i&&i.vsphere){var h={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vsphere",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(h)}if(null!==(o=e["target-environment"])&&void 0!==o&&o["guest-image"]){var y={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"guest-image",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(y)}if(null!==(l=e["target-environment"])&&void 0!==l&&l["image-installer"]){var b={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"image-installer",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(b)}return d}(t);Promise.all(i.map((function(e){return F.Z.composeImage(e).then((function(t){n((0,Re.tE)(et(et({},t),{},{request:e,image_status:{status:"pending"}}),!0))}))}))).then((function(){a("/"),n((0,Ne.wN)({variant:"success",title:"Your image is being created"})),r(!1)})).catch((function(e){n((0,Ne.wN)({variant:"danger",title:"Your image could not be created",description:"Status code "+e.response.status+": "+e.response.statusText})),r(!1)}))},defaultArch:"x86_64",customValidatorMapper:{fileSystemConfigurationValidator:$e,targetEnvironmentValidator:Ye},schema:{fields:[{component:T.Z.WIZARD,name:"image-builder-wizard",className:"image_builder",isDynamic:!0,inModal:!0,onKeyDown:function(e){!function(e,t){"Escape"===e.key&&t()}(e,d)},buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release"],description:c().createElement(c().Fragment,null,"Image builder allows you to create a custom image and push it to target environments. ",c().createElement(Pe.Z,null)),fields:[He,Ve,C,je,Be,qe,Xe,Ke,We],initialState:{activeStep:(null==o||null===(t=o.state)||void 0===t?void 0:t.initialStep)||"image-output",activeStepIndex:m.length,maxStepIndex:m.length,prevSteps:m}}]},initialValues:u})}},77310:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(75418),r=n.n(a),i=n(75857),o=n(50470);const l=function(){return r().createElement(i.Button,{component:"a",target:"_blank",variant:"link",icon:r().createElement(o.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/uploading_a_customized_rhel_system_image_to_cloud_environments/index"},"Documentation")}},87248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var a=n(15861),r=n(87757),i=n.n(r),o=n(9669),l=n.n(o),s=n(58061),c={headers:{"Content-Type":"application/json"}};function u(){return(u=(0,a.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().post(s.DO.concat("/compose"),t,c);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,a.Z)(i().mark((function e(t,n){var a,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({limit:t,offset:n}),r="/composes?"+a.toString(),e.next=4,l().get(s.DO.concat(r));case 4:return o=e.sent,e.abrupt("return",o.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=(0,a.Z)(i().mark((function e(t){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/composes/"+t,e.next=3,l().get(s.DO.concat(n));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=(0,a.Z)(i().mark((function e(t,n,a,r){var o,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new URLSearchParams({distribution:t,architecture:n,search:a}),r&&o.append("limit",r),c="/packages?"+o.toString(),e.next=5,l().get(s.DO.concat(c));case 5:return u=e.sent,e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=(0,a.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(s.DO.concat("/version"));case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=(0,a.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(s.UD.concat("/activation_keys"));case 3:return t=e.sent,e.abrupt("return",t.data.body);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const v={composeImage:function(e){return u.apply(this,arguments)},getComposes:function(e,t){return m.apply(this,arguments)},getComposeStatus:function(e){return d.apply(this,arguments)},getPackages:function(e,t,n,a){return p.apply(this,arguments)},getVersion:function(){return g.apply(this,arguments)},getActivationKeys:function(){return f.apply(this,arguments)}}},58061:(e,t,n)=>{"use strict";n.d(t,{DO:()=>i,F2:()=>l,PV:()=>s,UD:()=>o,at:()=>m,fI:()=>c,g7:()=>u,rh:()=>d});var a,r=n(4942),i="/api/image-builder/v1",o="/api/rhsm/v2",l="rhel-86",s="rhel-90",c=Math.pow(1024,1),u=Math.pow(1024,2),m=Math.pow(1024,3),d=(a={},(0,r.Z)(a,l,"Red Hat Enterprise Linux (RHEL) 8"),(0,r.Z)(a,s,"Red Hat Enterprise Linux (RHEL) 9"),(0,r.Z)(a,"centos-8","CentOS Stream 8"),(0,r.Z)(a,"centos-9","CentOS Stream 9"),a)},18247:(e,t,n)=>{"use strict";n.d(t,{dD:()=>m,s1:()=>u,tE:()=>s});var a=n(15861),r=n(87757),i=n.n(r),o=n(87248),l=n(26698),s=function(e,t){return{type:l.Z.COMPOSE_ADDED,payload:{compose:e,insert:t}}},c=function(e,t){return{type:l.Z.COMPOSE_UPDATED_STATUS,payload:{id:e,status:t}}},u=function(e){return function(){var t=(0,a.Z)(i().mark((function t(n){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.Z.getComposeStatus(e);case 2:a=t.sent,n(c(e,a.image_status));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},m=function(e,t){return function(){var n=(0,a.Z)(i().mark((function n(a){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.Z.getComposes(e,t);case 2:(r=n.sent).data.map((function(e){a(s(e,!1)),a(u(e.id))})),a((i=r.meta.count,{type:l.Z.COMPOSES_UPDATED_COUNT,payload:{count:i}}));case 5:case"end":return n.stop()}var i}),n)})));return function(e){return n.apply(this,arguments)}}()}},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{}}]);
//# sourceMappingURL=../sourcemaps/935.ed2b1a222a60d94568ae9029adefe97c.js.map