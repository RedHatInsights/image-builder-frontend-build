(self.webpackChunkimage_builder=self.webpackChunkimage_builder||[]).push([[456],{38347:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tt});var a=n(4942),r=n(29439),i=n(15861),o=n(87757),l=n.n(o),s=n(75418),c=n.n(s),u=n(87462),m=n(45987),d=n(79442),p=n(67850),g=n(80124),f=n(75857),v=n(45697),h=n.n(v),y=n(31006),b=n(34046),E=n(48880),T=n(96354),x=n(64124),w=n(58061);const S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["target-environment"],n=e.release,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.skipAws,i=a.skipGoogle,o=a.skipAzure;return!r&&null!=t&&t.aws?"aws-target-env":!i&&null!=t&&t.gcp?"google-cloud-target-env":!o&&null!=t&&t.azure?"ms-azure-target-env":n===w.F2?"registration":"File system configuration"};var k=n(77310),I=function(e){var t=e.id,n=e.formFields,a=e.formRef,r=e.title,i=e.customTitle,o=e.showTitle,l=e.showTitles;return c().createElement("div",{id:t,ref:a,className:"pf-c-form"},(l&&!1!==o||o)&&(i||c().createElement(f.Title,{headingLevel:"h1",size:"xl"},r)),n)};I.propTypes={id:h().string,title:h().node,customTitle:h().node,formFields:h().array.isRequired,formOptions:h().shape({renderForm:h().func.isRequired}).isRequired,showTitles:h().bool,showTitle:h().bool,formRef:h().oneOfType([h().func,h().shape({current:h().instanceOf(Element)})])};const Z=I;var L,C=(L={},(0,a.Z)(L,w.F2,"Red Hat Enterprise Linux (RHEL) 8"),(0,a.Z)(L,"centos-8","CentOS Stream 8"),(0,a.Z)(L,"centos-9","CentOS Stream 9"),L);const z={StepTemplate:Z,id:"wizard-imageoutput",title:"Image output",name:"image-output",nextStep:function(e){var t=e.values;return S(t)},fields:[{component:T.Z.PLAIN_TEXT,name:"image-output-plain-text",label:c().createElement(f.Text,null,"Image builder allows you to create a custom image and push it to target environments.",c().createElement("br",null),c().createElement(k.Z,null))},{component:T.Z.SELECT,label:"Release",name:"release",simpleValue:!0,initialValue:w.F2,options:Object.entries(C).map((function(e){var t=(0,r.Z)(e,2),n=t[0];return{label:t[1],value:n}})),isRequired:!0,validate:[{type:x.Z.REQUIRED}]},{component:"output",name:"target-environment",label:"Select target environments",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:"targetEnvironmentValidator"}]}]};var A={googleAccount:"Google account",serviceAccount:"Service account",googleGroup:"Google group",domain:"Domain"},O=function(e){var t=e.appendTo;return c().createElement(f.Popover,{appendTo:t,hasAutoWidth:!0,maxWidth:"35rem",headerContent:"Valid account types",flipBehavior:["right","bottom","top","left"],bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"The following account types can have an image shared with them:"),c().createElement(f.TextList,{className:"pf-u-ml-0"},c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google account:")," A Google account represents a developer, an administrator, or any other person who interacts with Google Cloud. e.g., ",c().createElement("em",null,"`alice@gmail.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Service account:")," A service account is an account for an application instead of an individual end user. e.g., ",c().createElement("em",null,"`myapp@appspot.gserviceaccount.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google group:")," A Google group is a named collection of Google accounts and service accounts. e.g., ",c().createElement("em",null,"`admins@example.com`"),"."),c().createElement(f.TextListItem,null,c().createElement("strong",null,"Google Workspace domain/Cloud Identity domain:")," A Google workspace or cloud identity domain represents a virtual group of all the Google accounts in an organization. These domains represent your organization's internet domain name. e.g., ",c().createElement("em",null,"`mycompany.com`"),".")))},c().createElement(f.Button,{variant:"plain","aria-label":"Account info","aria-describedby":"google-account-type",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))};O.propTypes={appendTo:h().any};const _={StepTemplate:Z,id:"wizard-target-gcp",title:"Google Cloud Platform",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Google Cloud Platform"),name:"google-cloud-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return S(t,{skipGoogle:!0,skipAws:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"google-cloud-text-component",label:c().createElement(f.Text,null,"Your image will be uploaded to Google Cloud Platform and shared with the email you provide below. ",c().createElement("br",null),"The image should be copied to your account within 14 days.")},{component:"radio-popover",label:"Type",isRequired:!0,Popover:O,name:"google-account-type",initialValue:"googleAccount",options:Object.entries(A).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return{label:"domain"===n?"Google Workspace domain or Cloud Identity domain":a,value:n,autoFocus:"googleAccount"===n}})),validate:[{type:x.Z.REQUIRED}]},{component:T.Z.TEXT_FIELD,name:"google-email","data-testid":"input-google-email",type:"text",label:"Email address",condition:{or:[{when:"google-account-type",is:"googleAccount"},{when:"google-account-type",is:"serviceAccount"},{when:"google-account-type",is:"googleGroup"},{when:"google-account-type",is:null}]},isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",message:"Please enter a valid email address"}]},{component:T.Z.TEXT_FIELD,name:"google-domain",type:"text",label:"Domain",condition:{when:"google-account-type",is:"domain"},isRequired:!0,validate:[{type:x.Z.REQUIRED}]}]};function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var P=function(e){var t=(0,u.Z)({},e);return c().createElement(y.TableComposable,{"aria-label":"File system configuration table",variant:"compact"},c().createElement(y.Thead,null,c().createElement(y.Tr,null,c().createElement(y.Th,null,"Mount point"),c().createElement(y.Th,null,"Type"),c().createElement(y.Th,null,"Minimum size"))),c().createElement(y.Tbody,{"data-testid":"file-system-configuration-tbody-review"},t.fsc.map((function(e,t){return c().createElement(y.Tr,{key:t},c().createElement(y.Td,{className:"pf-m-width-60"},e.mountpoint),c().createElement(y.Td,{className:"pf-m-width-10"},"xfs"),c().createElement(y.Td,{className:"pf-m-width-30"},e.size," ",e.unit===w.at?"GiB":e.unit===w.g7?"MiB":"KiB"))}))))};P.propTypes={fsc:h().arrayOf(h().object).isRequired};const R=function(){var e,t,n,a,o,u,m,d,p,g,v,h,y,T,x,S,k,I,Z,L,z,O,_,R,N,V,j,F,q,B,G,M,U,W,X,H,K,Q,$,Y,J,ee,te,ne,ae,re,ie,oe,le,se,ce,ue,me,de,pe,ge,fe,ve,he,ye,be,Ee=(0,s.useState)(0),Te=(0,r.Z)(Ee,2),xe=Te[0],we=Te[1],Se=(0,s.useState)(),ke=(0,r.Z)(Se,2),Ie=ke[0],Ze=ke[1],Le=(0,s.useState)(),Ce=(0,r.Z)(Le,2),ze=Ce[0],Ae=Ce[1],Oe=(0,E.default)(),_e=Oe.change,De=Oe.getState;return(0,s.useEffect)((function(){var e,t,n,a,r,o,s=null===(e=De())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["register-system"];if("register-now"!==s&&"register-now-insights"!==s||(0,i.Z)(l().mark((function e(){var t,n,a,r,i,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=insights)||void 0===t||null===(n=t.chrome)||void 0===n||null===(a=n.auth)||void 0===a?void 0:a.getUser();case 2:o=e.sent,s=null==o||null===(r=o.identity)||void 0===r||null===(i=r.internal)||void 0===i?void 0:i.org_id,Ze(s),_e("subscription-organization-id",s);case 6:case"end":return e.stop()}}),e)})))(),"manual"===(null===(n=De())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["file-system-config-toggle"])&&null!==(r=De())&&void 0!==r&&null!==(o=r.values)&&void 0!==o&&o["file-system-configuration"]){var c,u=0,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(De().values["file-system-configuration"]);try{for(m.s();!(c=m.n()).done;){var d=c.value;u+=d.size*d.unit}}catch(e){m.e(e)}finally{m.f()}u=(u/w.at).toFixed(1),Ae(u<1?"Less than 1 GiB":"".concat(u," GiB"))}})),c().createElement(c().Fragment,null,c().createElement(f.Text,null,'Review the information and click "Create image" to create the image using the following criteria.'),c().createElement(f.DescriptionList,{isCompact:!0,isHorizontal:!0},c().createElement(f.DescriptionListGroup,null,(null===(e=De())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["image-name"])&&c().createElement(c().Fragment,null,c().createElement(f.DescriptionListTerm,null,"Image name"),c().createElement(f.DescriptionListDescription,null,null===(n=De())||void 0===n||null===(a=n.values)||void 0===a?void 0:a["image-name"])),c().createElement(f.DescriptionListTerm,null,"Release"),c().createElement(f.DescriptionListDescription,null,null==C?void 0:C[null===(o=De())||void 0===o||null===(u=o.values)||void 0===u?void 0:u.release]))),c().createElement(f.Tabs,{isFilled:!0,activeKey:xe,onSelect:function(e,t){we(t)},className:"pf-u-w-75"},c().createElement(f.Tab,{eventKey:0,title:c().createElement(f.TabTitleText,null,"Target environment"),"data-testid":"tab-target",autoFocus:!0},c().createElement(f.List,{isPlain:!0,iconSize:"large"},(null===(m=De())||void 0===m||null===(d=m.values)||void 0===d||null===(p=d["target-environment"])||void 0===p?void 0:p.aws)&&c().createElement(f.ListItem,{icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Amazon Web Services"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Account ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(g=De())||void 0===g||null===(v=g.values)||void 0===v?void 0:v["aws-account-id"])))),(null===(h=De())||void 0===h||null===(y=h.values)||void 0===y||null===(T=y["target-environment"])||void 0===T?void 0:T.gcp)&&c().createElement(f.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Google Cloud Platform"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},null==A?void 0:A[null===(x=De())||void 0===x||null===(S=x.values)||void 0===S?void 0:S["google-account-type"]]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},(null===(k=De())||void 0===k||null===(I=k.values)||void 0===I?void 0:I["google-email"])||(null===(Z=De())||void 0===Z||null===(L=Z.values)||void 0===L?void 0:L["google-domain"]))))),(null===(z=De())||void 0===z||null===(O=z.values)||void 0===O||null===(_=O["target-environment"])||void 0===_?void 0:_.azure)&&c().createElement(f.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"})},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Microsoft Azure"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(R=De())||void 0===R||null===(N=R.values)||void 0===N?void 0:N["azure-subscription-id"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Tenant ID"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(V=De())||void 0===V||null===(j=V.values)||void 0===j?void 0:j["azure-tenant-id"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Resource group"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(F=De())||void 0===F||null===(q=F.values)||void 0===q?void 0:q["azure-resource-group"])))),(null===(B=De())||void 0===B||null===(G=B.values)||void 0===G||null===(M=G["target-environment"])||void 0===M?void 0:M.vsphere)&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"VMWare"))),(null===(U=De())||void 0===U||null===(W=U.values)||void 0===W||null===(X=W["target-environment"])||void 0===X?void 0:X["guest-image"])&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Virtualization - Guest image"))),(null===(H=De())||void 0===H||null===(K=H.values)||void 0===K||null===(Q=K["target-environment"])||void 0===Q?void 0:Q["image-installer"])&&c().createElement(f.ListItem,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Bare metal - Installer"))))),(null===($=De())||void 0===$||null===(Y=$.values)||void 0===Y?void 0:Y.release.includes("rhel"))&&c().createElement(f.Tab,{eventKey:1,title:c().createElement(f.TabTitleText,null,"Registration"),"data-testid":"tab-registration"},"register-later"===(null===(J=De())||void 0===J||null===(ee=J.values)||void 0===ee?void 0:ee["register-system"])&&c().createElement(f.TextContent,null,c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},"Register the system later"))),("register-now"===(null===(te=De())||void 0===te||null===(ne=te.values)||void 0===ne?void 0:ne["register-system"])||"register-now-insights"===(null===(ae=De())||void 0===ae||null===(re=ae.values)||void 0===re?void 0:re["register-system"]))&&c().createElement(f.TextContent,null,c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Subscription"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},"register-now-insights"===(null===(ie=De())||void 0===ie||null===(oe=ie.values)||void 0===oe?void 0:oe["register-system"])&&"Register with Subscriptions and Red Hat Insights","register-now"===(null===(le=De())||void 0===le||null===(se=le.values)||void 0===se?void 0:se["register-system"])&&"Register with Subscriptions"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Activation key"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},null===(ce=De())||void 0===ce||null===(ue=ce.values)||void 0===ue?void 0:ue["subscription-activation-key"]),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Organization ID"),void 0!==Ie?c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"organization-id"},Ie):c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},c().createElement(f.Spinner,null))))),c().createElement(f.Tab,{eventKey:2,title:c().createElement(f.TabTitleText,null,"System configuration"),"data-testid":"tab-system"},c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"File system configuration"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Partitioning"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"partitioning-auto-manual"},"manual"===(null===(me=De())||void 0===me||null===(de=me.values)||void 0===de?void 0:de["file-system-config-toggle"])?"Manual":"Automatic","manual"===(null===(pe=De())||void 0===pe||null===(ge=pe.values)||void 0===ge?void 0:ge["file-system-config-toggle"])&&c().createElement(c().Fragment,null," ",c().createElement(f.Popover,{position:"bottom",headerContent:"Partitions",hasAutoWidth:!0,minWidth:"30rem",bodyContent:c().createElement(P,{fsc:De().values["file-system-configuration"]})},c().createElement(f.Button,{"data-testid":"file-system-configuration-popover",variant:"link","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info"},"View partitions")))),"manual"===(null===(fe=De())||void 0===fe||null===(ve=fe.values)||void 0===ve?void 0:ve["file-system-config-toggle"])&&c().createElement(c().Fragment,null,c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Image size (minimum)",c().createElement(f.Popover,{hasAutoWidth:!0,bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},c().createElement(f.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},ze))),c().createElement(f.Text,{component:f.TextVariants.h3},"Packages"),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Chosen"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd,"data-testid":"chosen-packages-count"},(null===(he=De())||void 0===he||null===(ye=he.values)||void 0===ye||null===(be=ye["selected-packages"])||void 0===be?void 0:be.length)||0))))))};var N=n(41693),V=["label","isRequired"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.label,n=e.isRequired,i=(0,m.Z)(e,V),o=(0,E.default)(),l=o.getState,u=o.change,d=(0,N.Z)(F({label:t,isRequired:n},i)).input,p=(0,s.useState)({aws:!1,azure:!1,gcp:!1,vsphere:!1,"guest-image":!1,"image-installer":!1}),g=(0,r.Z)(p,2),v=g[0],h=g[1];(0,s.useEffect)((function(){var e,t;null!==(e=l())&&void 0!==e&&null!==(t=e.values)&&void 0!==t&&t[d.name]&&h(l().values[d.name])}),[]);var y=function(e){return h((function(t){var n=F(F({},t),{},(0,a.Z)({},e,!t[e]));return u(d.name,n),n}))},b=function(e,t){" "===e.key&&y(t)};return c().createElement(c().Fragment,null,c().createElement(f.FormGroup,{isRequired:n,label:t,"data-testid":"target-select"},c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Public cloud"),"data-testid":"target-public"},c().createElement("div",{className:"tiles"},c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-aws",title:"Amazon Web Services",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"}),onClick:function(){return y("aws")},onKeyDown:function(e){return b(e,"aws")},isSelected:v.aws,isStacked:!0,isDisplayLarge:!0}),c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-google",title:"Google Cloud Platform",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"}),onClick:function(){return y("gcp")},isSelected:v.gcp,onKeyDown:function(e){return b(e,"gcp")},isStacked:!0,isDisplayLarge:!0}),c().createElement(f.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-azure",title:"Microsoft Azure",icon:c().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"}),onClick:function(){return y("azure")},onKeyDown:function(e){return b(e,"azure")},isSelected:v.azure,isStacked:!0,isDisplayLarge:!0}))),c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Private cloud"),"data-testid":"target-private"},c().createElement(f.Checkbox,{label:"VMWare",isChecked:v.vsphere,onChange:function(){return y("vsphere")},"aria-label":"VMWare checkbox",id:"checkbox-vmware",name:"VMWare","data-testid":"checkbox-vmware"})),c().createElement(f.FormGroup,{label:c().createElement(f.Text,{component:f.TextVariants.small},"Other"),"data-testid":"target-other"},c().createElement(f.Checkbox,{label:"Virtualization - Guest image",isChecked:v["guest-image"],onChange:function(){return y("guest-image")},"aria-label":"Virtualization guest image checkbox",id:"checkbox-guest-image",name:"Virtualization guest image","data-testid":"checkbox-guest-image"}),c().createElement(f.Checkbox,{label:"Bare metal - Installer",isChecked:v["image-installer"],onChange:function(){return y("image-installer")},"aria-label":"Bare metal installer checkbox",id:"checkbox-image-installer",name:"Bare metal installer","data-testid":"checkbox-image-installer"}))))};q.propTypes={label:h().node,isRequired:h().bool},q.defaultProps={label:"",isRequired:!1};const B=q;var G=n(93433),M=n(87248),U=n(70196),W=n(5866),X=n(6569),H=n(95511),K=["defaultArch"],Q=function(e){return e.map((function(e){return{name:e.name,summary:e.summary}}))},$=function(e){var t=e.defaultArch,n=(0,m.Z)(e,K),a=(0,E.default)(),o=a.change,u=a.getState,d=(0,N.Z)(n).input,p=(0,s.useRef)(),g=(0,s.useState)([]),v=(0,r.Z)(g,2),h=v[0],y=v[1],b=(0,s.useState)(!0),T=(0,r.Z)(b,2),x=T[0],w=T[1],S=(0,s.useState)([]),k=(0,r.Z)(S,2),I=k[0],Z=k[1],L=(0,s.useState)(!0),C=(0,r.Z)(L,2),z=C[0],A=C[1],O=(0,s.useState)(""),_=(0,r.Z)(O,2),D=_[0],P=_[1],R=(0,s.useState)(""),V=(0,r.Z)(R,2),j=V[0],F=V[1];(0,s.useEffect)((function(){var e,t,n=null===(e=u())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["selected-packages"];n&&Z(n)}),[]);var q=(0,s.useCallback)((function(e){return function(t,n){return t=t.name.toLowerCase(),n=n.name.toLowerCase(),t===e?-1:n===e?1:t.startsWith(e)&&!n.startsWith(e)?-1:n.startsWith(e)&&!t.startsWith(e)?1:t<n?-1:n<t?1:0}})),B=(0,s.useCallback)((function(e){var t=e.sort(q(p.current));y(t)})),$=(0,s.useCallback)((function(e){return e.filter((function(e){return!I.some((function(t){return e.name===t.name}))}))})),Y=function(){var e=(0,i.Z)(l().mark((function e(){var n,a,r,i,o,s,c,m,d,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[null===(n=u())||void 0===n||null===(a=n.values)||void 0===a?void 0:a.release,(null===(r=u())||void 0===r||null===(i=r.values)||void 0===i?void 0:i.architecture)||t,p.current],e.next=3,M.Z.getPackages.apply(M.Z,s);case 3:if(c=e.sent,m=c.data,d=c.meta,(null===(o=m)||void 0===o?void 0:o.length)!==d.count){e.next=10;break}return e.abrupt("return",m);case 10:if(!m){e.next=16;break}return e.next=13,M.Z.getPackages.apply(M.Z,s.concat([d.count]));case 13:return g=e.sent,m=g.data,e.abrupt("return",m);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,i.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:(t=e.sent)?(n=$(t),B(n),w(!0)):(y([]),w(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=!1,t=I.map((function(t){return t.name.includes(D)?(t.isHidden=!1,e=!0):t.isHidden=!0,t}));A(e),Z(t)},te=function(e){"Enter"===e.key&&("available"===j?(e.stopPropagation(),J()):"chosen"===j&&(e.stopPropagation(),ee()))};(0,s.useEffect)((function(){return document.addEventListener("keydown",te,!0),function(){document.removeEventListener("keydown",te,!0)}}));var ne=function(e){var t=e?I:h,n=(e?h:I).filter((function(e){return!e.selected||(e.selected=!1,t.push(e),!1)}));e?(B(n),Z(t),o(d.name,Q(t))):(Z(n),B(h),o(d.name,Q(n)))},ae=function(e){var t=[];e?(t=[].concat((0,G.Z)(h.filter((function(e){return!e.isHidden}))),(0,G.Z)(I)),Z(t),B((0,G.Z)(h.filter((function(e){return e.isHidden}))))):(t=(0,G.Z)(I.filter((function(e){return e.isHidden}))),B([].concat((0,G.Z)(I.filter((function(e){return!e.isHidden}))),(0,G.Z)(h))),Z(t)),o(d.name,Q(t))},re=function(e,t,n){if(n){var a=(0,G.Z)(I);a[t].selected=!I[t].selected,Z(a)}else{var r=(0,G.Z)(h);r[t].selected=!h[t].selected,B(r)}},ie=(0,s.useRef)(null);return(0,s.useEffect)((function(){var e;null===(e=ie.current)||void 0===e||e.focus()}),[]),c().createElement(f.DualListSelector,null,c().createElement(f.DualListSelectorPane,{title:"Available packages",searchInput:c().createElement(f.SearchInput,{placeholder:"Search for a package","data-testid":"search-available-pkgs-input",value:p.current,ref:ie,onFocus:function(){return F("available")},onBlur:function(){return F("")},onChange:function(e){p.current=e}}),actions:[c().createElement(f.Button,{"aria-label":"Search button for available packages",key:"availableSearchButton","data-testid":"search-available-pkgs-button",onClick:J},"Search")]},c().createElement(f.DualListSelectorList,{"data-testid":"available-pkgs-list"},h.length?h.map((function(e,t){return e.isHidden?null:c().createElement(f.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return re(0,t,!1)}},c().createElement(f.TextContent,{key:"".concat(e.name,"-").concat(t)},c().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),c().createElement("small",null,e.summary)))})):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},x?c().createElement(c().Fragment,null,"Search above to add additional",c().createElement("br",null),"packages to your image"):"No packages found"))),c().createElement(f.DualListSelectorControlsWrapper,{"aria-label":"Selector controls"},c().createElement(f.DualListSelectorControl,{isDisabled:!h.some((function(e){return e.selected})),onClick:function(){return ne(!0)},"aria-label":"Add selected",tooltipContent:"Add selected"},c().createElement(H.ZP,null)),c().createElement(f.DualListSelectorControl,{isDisabled:!h.length,onClick:function(){return ae(!0)},"aria-label":"Add all",tooltipContent:"Add all"},c().createElement(X.ZP,null)),c().createElement(f.DualListSelectorControl,{isDisabled:!I.length||!z,onClick:function(){return ae(!1)},"aria-label":"Remove all",tooltipContent:"Remove all"},c().createElement(U.ZP,null)),c().createElement(f.DualListSelectorControl,{onClick:function(){return ne(!1)},isDisabled:!I.some((function(e){return e.selected}))||!z,"aria-label":"Remove selected",tooltipContent:"Remove selected"},c().createElement(W.ZP,null))),c().createElement(f.DualListSelectorPane,{title:"Chosen packages",searchInput:c().createElement(f.SearchInput,{placeholder:"Search for a package","data-testid":"search-chosen-pkgs-input",value:D,onFocus:function(){return F("chosen")},onBlur:function(){return F("")},onChange:function(e){return P(e)}}),actions:[c().createElement(f.Button,{"aria-label":"Search button for selected packages",key:"selectedSearchButton","data-testid":"search-chosen-pkgs-button",onClick:ee},"Search")],isChosen:!0},c().createElement(f.DualListSelectorList,{"data-testid":"chosen-pkgs-list"},I.length?z?I.map((function(e,t){return e.isHidden?null:c().createElement(f.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return re(0,t,!0)}},c().createElement(f.TextContent,{key:"".concat(e.name,"-").concat(t)},c().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),c().createElement("small",null,e.summary)))})):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages found"):c().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages added"))))};$.propTypes={defaultArch:h().string};const Y=$;var J=n(41626),ee=["Popover"],te=function(e){var t=e.Popover,n=(0,m.Z)(e,ee),a=(0,s.useRef)();return c().createElement(J.Z,(0,u.Z)({},n,{label:c().createElement("span",{ref:a,className:"ins-c-image--builder__popover"},n.label,c().createElement(t,null))}))};te.propTypes={Popover:h().elementType.isRequired,label:h().node};const ne=te,ae=function(){var e,t,n=null===(e=(0,(0,E.default)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["azure-tenant-id"],a=new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i");return c().createElement(f.FormGroup,null,c().createElement(f.Button,{component:"a",target:"_blank",variant:"secondary",isDisabled:!a.test(n),href:"https://login.microsoftonline.com/"+n+"/oauth2/v2.0/authorize?client_id=b94bb246-b02c-4985-9c22-d44e66f657f4&scope=openid&response_type=code&response_mode=query&redirect_uri=https://portal.azure.com"},"Authorize Image Builder"))};var re=n(50470);const ie=function(){var e=(0,s.useState)(!0),t=(0,r.Z)(e,2),n=t[0],a=t[1];return c().createElement(c().Fragment,null,c().createElement(f.ExpandableSection,{className:"azureAuthExpandable",toggleText:c().createElement(f.Title,{headingLevel:"h3"},"Authorizing an Azure account"),onToggle:function(){return a(!n)},isExpanded:n},c().createElement(f.Text,null,'To authorize Image Builder to push images to Microsoft Azure, the account owner must configure Image Builder as an authorized application for a specific tenant ID and give it the role of "Contributor" to at least one resource group.',c().createElement("br",null)),c().createElement("small",null,c().createElement(f.Button,{component:"a",target:"_blank",variant:"link",icon:c().createElement(re.ZP,null),iconPosition:"right",isInline:!0,href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow"},"Learn more about OAuth 2.0"))))};var oe=function(e){var t,n,a=e.label,i=e.isRequired,o=(0,E.default)(),l=o.change,u=o.getState,m=(0,s.useState)([]),d=(0,r.Z)(m,2),p=d[0],g=d[1],v=(0,s.useState)(!1),h=(0,r.Z)(v,2),y=h[0],b=h[1],T=(0,s.useState)(!1),x=(0,r.Z)(T,2),w=x[0],S=x[1],k=(0,s.useState)(null===(t=u())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["subscription-activation-key"]),I=(0,r.Z)(k,2),Z=I[0],L=I[1];return(0,s.useEffect)((function(){S(!0),M.Z.getActivationKeys().then((function(e){g(e),S(!1)}))}),[]),c().createElement(f.FormGroup,{isRequired:i,label:a,"data-testid":"subscription-activation-key"},c().createElement(f.Select,{variant:f.SelectVariant.typeahead,onToggle:function(){return b(!y)},onSelect:function(e,t){L(t),b(!1),l("subscription-activation-key",t)},onClear:function(){L(),l("subscription-activation-key",void 0)},selections:Z,isOpen:y,placeholderText:"Select activation key",typeAheadAriaLabel:"Select activation key"},w&&c().createElement(f.SelectOption,{isNoResultsOption:!0,"data-testid":"activation-keys-loading"},c().createElement(f.Spinner,{isSVG:!0,size:"lg"})),p.map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e.name})}))))};oe.propTypes={label:h().node,isRequired:h().bool},oe.defaultProps={label:"",isRequired:!1};const le=oe;var se=n(54915),ce=n(70710),ue=n(20777),me=n(26246),de=n(44586),pe=n(26470),ge=n.n(pe);function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ve=function(e){var t=(0,u.Z)({},e),n=["/home","/opt","/srv","/usr","/usr/local","/var","/app","/data","/"],a=(0,s.useState)(!1),i=(0,r.Z)(a,2),o=i[0],l=i[1],m=(0,s.useState)("/"),d=(0,r.Z)(m,2),p=d[0],g=d[1],v=(0,s.useState)(""),h=(0,r.Z)(v,2),y=h[0],b=h[1];return(0,s.useEffect)((function(){var e,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(n);try{for(a.s();!(e=a.n()).done;){var r=e.value;if(t.mountpoint.startsWith(r))return g(r),void b(t.mountpoint.substring(r.length))}}catch(e){a.e(e)}finally{a.f()}}),[]),(0,s.useEffect)((function(){var e=y,n=p;e&&("/"!==n&&"/"!==e[0]&&(e="/"+e),n+=e),t.onChange(ge().normalize(n))}),[p,y]),c().createElement(c().Fragment,null,c().createElement(f.Select,{className:"pf-u-w-50",isOpen:o,onToggle:function(e){l(e)},onSelect:function(e,t){g(t),l(!1)},selections:p,variant:f.SelectVariant.single},n.map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e})}))),"/"!==p&&c().createElement(f.TextInput,{className:"pf-u-w-50",type:"text",value:y,"aria-label":"Mount point suffix text input",onChange:function(e){return b(e)}}))};ve.propTypes={mountpoint:h().string.isRequired,onChange:h().func.isRequired};const he=ve;var ye=function(e){var t=(0,u.Z)({},e),n=(0,s.useState)(!1),a=(0,r.Z)(n,2),i=a[0],o=a[1],l=(0,s.useState)(t.unit||w.at),m=(0,r.Z)(l,2),d=m[0],p=m[1],g=(0,s.useState)(t.size||1),v=(0,r.Z)(g,2),h=v[0],y=v[1];return(0,s.useEffect)((function(){t.onChange(h,d)}),[d,h]),c().createElement(c().Fragment,null,c().createElement(f.TextInput,{className:"pf-u-w-50",type:"text",value:h,"aria-label":"Size text input",onChange:function(e){return y(isNaN(parseInt(e))?0:parseInt(e))}}),c().createElement(f.Select,{className:"pf-u-w-50",isOpen:i,onToggle:function(e){o(e)},onSelect:function(e,t){switch(t){case"KiB":p(w.fI);break;case"MiB":p(w.g7);break;case"GiB":p(w.at)}o(!1)},selections:d===w.fI?"KiB":d===w.g7?"MiB":"GiB",variant:f.SelectVariant.single,"aria-label":"Unit select"},["KiB","MiB","GiB"].map((function(e,t){return c().createElement(f.SelectOption,{key:t,value:e})}))))};ye.propTypes={size:h().number.isRequired,unit:h().number.isRequired,onChange:h().func.isRequired};const be=ye;function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var we={id:(0,de.Z)(),mountpoint:"/",fstype:"xfs",size:10,unit:w.at};const Se=function(e){var t,n,a,i,o,l,m=(0,u.Z)({},e),d=(0,E.default)(),p=d.change,g=d.getState,v=(0,N.Z)(m).input,h=(0,s.useState)(null),T=(0,r.Z)(h,2),x=T[0],S=T[1],k=(0,s.useState)(null),I=(0,r.Z)(k,2),Z=I[0],L=I[1],C=(0,s.useState)(!1),z=(0,r.Z)(C,2),A=z[0],O=z[1],_=(0,s.useState)([we.id]),D=(0,r.Z)(_,2),P=D[0],R=D[1],V=(0,s.useState)([]),j=(0,r.Z)(V,2),F=j[0],q=j[1],B=(0,s.useRef)(),M=(0,s.useState)([we]),U=(0,r.Z)(M,2),W=U[0],X=U[1];(0,s.useEffect)((function(){var e,t,n=null===(e=g())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["file-system-configuration"];if(n){var a=[],r=[];n.map((function(e){var t=(0,de.Z)();a.push({id:t,mountpoint:e.mountpoint,fstype:"xfs",size:e.size,unit:e.unit}),r.push(t)})),X(a),R(r)}}),[]),(0,s.useEffect)((function(){p(v.name,P.map((function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(W);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.id===e)return{mountpoint:a.mountpoint,size:a.size,unit:a.unit}}}catch(e){n.e(e)}finally{n.f()}})))}),[W,P]);var H=function(e){var t=B.current,n=Array.from(t.children);if(!n.map((function(e){return e.id})).every((function(t,n){return t===e[n]}))){for(;t.firstChild;)t.removeChild(t.lastChild);e.forEach((function(e){t.appendChild(n.find((function(t){return t.id===e})))}))}},K=function(e){e.preventDefault();var t=e.target.closest("tr");if(!t||!B.current.contains(t))return null;var n=t.id,a=Array.from(B.current.children).findIndex((function(e){return e.id===n}));if(a!==Z){var r=function(e,t,n){var a=e.indexOf(t);if(a===n)return e;var r=e.splice(a,1);return e.splice(n,0,r[0]),e}((0,G.Z)(P),x,a);H(r),L(a),q(r)}},Q=function(e){var t=B.current.getBoundingClientRect();return e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height},$=function(e){Q(e)&&R(F)},Y=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.id),e.currentTarget.classList.add(me.Z.modifiers.ghostRow),e.currentTarget.setAttribute("aria-pressed","true"),S(e.currentTarget.id),O(!0)},J=function(e){e.target.classList.remove(me.Z.modifiers.ghostRow),e.target.setAttribute("aria-pressed","false"),S(null),L(null),O(!1)};return c().createElement(c().Fragment,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Configure partitions")),W.length>1&&(null===(t=g())||void 0===t||null===(n=t.errors)||void 0===n||null===(a=n["file-system-configuration"])||void 0===a?void 0:a.duplicates)&&c().createElement(f.Alert,{variant:"danger",isInline:!0,title:"Duplicate mount points: All mount points must be unique. Remove the duplicate or choose a new mount point."}),W.length>=1&&!1===(null===(i=g())||void 0===i||null===(o=i.errors)||void 0===o||null===(l=o["file-system-configuration"])||void 0===l?void 0:l.root)&&c().createElement(f.Alert,{variant:"danger",isInline:!0,title:"No root partition configured."}),c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Partitions have been generated and given default values based on best practices from Red Hat, and your selections in previous steps of the wizard.")),c().createElement(y.TableComposable,{"aria-label":"File system table",className:A&&me.Z.modifiers.dragOver,variant:"compact"},c().createElement(y.Thead,null,c().createElement(y.Tr,null,c().createElement(y.Th,null),c().createElement(y.Th,null,"Mount point"),c().createElement(y.Th,null,"Type"),c().createElement(y.Th,null,"Minimum size",c().createElement(f.Popover,{hasAutoWidth:!0,bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Image Builder may extend this size based on requirements, selected packages, and configurations."))},c().createElement(f.Button,{variant:"plain","aria-label":"File system configuration info","aria-describedby":"file-system-configuration-info",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))),c().createElement(y.Th,null))),c().createElement(y.Tbody,{ref:B,onDragOver:K,onDrop:K,onDragLeave:function(e){Q(e)||(H(P),L(null))},"data-testid":"file-system-configuration-tbody"},W.map((function(e,t){var n,a;return c().createElement(y.Tr,{key:t,id:e.id,draggable:!0,onDrop:$,onDragEnd:J,onDragStart:Y},c().createElement(y.Td,{draggableRow:{id:"draggable-row-".concat(e.id)}}),c().createElement(y.Td,{className:"pf-m-width-30"},c().createElement(he,{key:e.id+"-mountpoint",mountpoint:e.mountpoint,onChange:function(t){return function(e,t){for(var n=(0,G.Z)(W),a=0;a<n.length;a++)if(n[a].id===e){var r=Te({},n[a]);r.mountpoint=t,n.splice(a,1,r);break}X(n)}(e.id,t)}}),(null===(n=g().errors["file-system-configuration"])||void 0===n?void 0:n.duplicates)&&-1!==(null===(a=g().errors["file-system-configuration"])||void 0===a?void 0:a.duplicates.indexOf(e.mountpoint))&&c().createElement(f.Alert,{variant:"danger",isInline:!0,isPlain:!0,title:"Duplicate mount point."})),c().createElement(y.Td,{className:"pf-m-width-20"},e.fstype),c().createElement(y.Td,{className:"pf-m-width-30"},c().createElement(be,{key:e.id+"-sizeunit",size:e.size,unit:e.unit,onChange:function(t,n){return function(e,t,n){for(var a=(0,G.Z)(W),r=0;r<a.length;r++)if(a[r].id===e){var i=Te({},a[r]);i.size=t,i.unit=n,a.splice(r,1,i);break}X(a)}(e.id,t,n)}})),c().createElement(y.Td,{className:"pf-m-width-10"},c().createElement(f.Button,{variant:"link",icon:c().createElement(ce.ZP,null),onClick:function(){return function(e){var t=W.map((function(e){return e.id})).indexOf(e),n=(0,G.Z)(W);n.splice(t,1);var a=P.indexOf(e),r=(0,G.Z)(P);r.splice(a,1),X(n),R(r)}(e.id)}})))})))),c().createElement(f.TextContent,null,c().createElement(f.Button,{"data-testid":"file-system-add-partition",className:"pf-u-text-align-left",variant:"link",icon:c().createElement(ue.ZP,null),onClick:function(){var e=(0,de.Z)();X(W.concat([{id:e,mountpoint:"/home",fstype:"xfs",size:1,unit:w.at}])),R(P.concat([e]))}},"Add partition")))},ke=function(e){var t,n,a=(0,u.Z)({},e),i=(0,E.default)(),o=i.change,l=i.getState,m=(0,N.Z)(a).input,d=(0,s.useState)((null===(t=l())||void 0===t||null===(n=t.values)||void 0===n?void 0:n["file-system-config-toggle"])||"auto"),p=(0,r.Z)(d,2),g=p[0],v=p[1];(0,s.useEffect)((function(){o(m.name,g)}),[g]);var h=function(e,t){v(t.currentTarget.id)};return c().createElement(c().Fragment,null,c().createElement(f.ToggleGroup,{"data-testid":"fsc-paritioning-toggle","aria-label":"Automatic partitioning toggle"},c().createElement(f.ToggleGroupItem,{onChange:h,text:"Use automatic partitioning",buttonId:"auto",isSelected:"auto"===g}),c().createElement(f.ToggleGroupItem,{onChange:h,text:"Manually configure partitions",buttonId:"manual",isSelected:"manual"===g,"data-testid":"file-system-config-toggle-manual"})))};var Ie=["schema","onSubmit","onClose","customComponentMapper","customValidatorMapper","defaultArch","className"];function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(e){var t=e.schema,n=e.onSubmit,a=e.onClose,r=e.customComponentMapper,i=e.customValidatorMapper,o=e.defaultArch,l=e.className,s=(0,m.Z)(e,Ie);return t?c().createElement(d.Z,(0,u.Z)({initialValues:s.initialValues,schema:t,className:"image-builder".concat(l?" ".concat(l):""),subscription:{values:!0},FormTemplate:function(e){return c().createElement(p.ZP,(0,u.Z)({},e,{showFormControls:!1}))},onSubmit:function(e){return n(e)},validatorMapper:Le({},i),componentMapper:Le(Le({},g.YS),{},{review:R,output:B,select:se.Z,"package-selector":{component:Y,defaultArch:o},"radio-popover":ne,"azure-auth-expandable":ie,"azure-auth-button":ae,"activation-keys":le,"file-system-config-toggle":ke,"file-system-configuration":Se},r),onCancel:a},s)):c().createElement(f.Spinner,null)};Ce.propTypes={schema:h().object,onSubmit:h().func.isRequired,onClose:h().func.isRequired,customComponentMapper:h().shape((0,a.Z)({},h().string,h().oneOfType([h().node,h().shape({component:h().node})]))),customValidatorMapper:h().shape((0,a.Z)({},h().string,h().func)),defaultArch:h().string,className:h().string,initialValues:h().object};const ze=Ce;var Ae=n(14194),Oe=n(28216),_e=n(18247),De=n(83215);const Pe={StepTemplate:Z,id:"wizard-target-aws",title:"Amazon Web Services",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Amazon Web Service"),name:"aws-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return S(t,{skipAws:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"plain-text-component",label:c().createElement("p",null,"Your image will be uploaded to AWS and shared with the account you provide below. ",c().createElement("br",null),"The image should be copied to your account within 14 days.")},{component:T.Z.TEXT_FIELD,name:"aws-account-id",className:"pf-u-w-25","data-testid":"aws-account-id",type:"text",label:"AWS account ID",isRequired:!0,autoFocus:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.EXACT_LENGTH,threshold:12}]}]},Re={StepTemplate:Z,id:"wizard-target-msazure",title:"Microsoft Azure",customTitle:c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"Target environment - Microsoft Azure"),name:"ms-azure-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return S(t,{skipAws:!0,skipGoogle:!0,skipAzure:!0})},fields:[{component:T.Z.PLAIN_TEXT,name:"azure-description",label:c().createElement(f.Text,null,"Image Builder sends an image to an authorized Azure account.")},{component:"azure-auth-expandable",name:"azure-auth-expandable"},{component:T.Z.PLAIN_TEXT,name:"azure-destination",label:c().createElement(c().Fragment,null,c().createElement(f.Title,{headingLevel:"h2"},"Destination"),c().createElement(f.Text,null,"Your image will be uploaded to the resource group in the subscription you specify."))},{component:T.Z.TEXT_FIELD,name:"azure-tenant-id",className:"pf-u-w-50","data-testid":"azure-tenant-id",type:"text",label:"Tenant ID",required:!0,isRequired:!0,autoFocus:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid tenant ID"}]},{component:"azure-auth-button",name:"azure-auth-button","data-testid":"azure-auth-button",required:!0,isRequired:!0},{component:T.Z.TEXT_FIELD,name:"azure-subscription-id",className:"pf-u-w-50","data-testid":"azure-subscription-id",type:"text",label:"Subscription ID",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid subscription ID"}]},{component:T.Z.TEXT_FIELD,name:"azure-resource-group",className:"pf-u-w-50","data-testid":"azure-resource-group",type:"text",label:"Resource group",isRequired:!0,validate:[{type:x.Z.REQUIRED},{type:x.Z.PATTERN,pattern:/^[-\w._()]+[-\w_()]$/,message:"Resource group names only allow alphanumeric characters, periods, underscores, hyphens, and parenthesis and cannot end in a period"}]}]},Ne={StepTemplate:Z,id:"wizard-systemconfiguration-packages",title:"Packages",name:"packages",substepOf:"System Configuration",nextStep:"image-name",fields:[{component:T.Z.PLAIN_TEXT,name:"packages-text-component",label:c().createElement(f.Text,null,"Add optional additional packages to your image by searching available packages.")},{component:"package-selector",name:"selected-packages",label:"Available options"}]};var Ve=function(){return c().createElement(f.Popover,{hasAutoWidth:!0,maxWidth:"35rem",bodyContent:c().createElement(f.TextContent,null,c().createElement(f.Text,null,"Activation keys allow you to register a system with appropriate subscriptions and system purpose attached."))},c().createElement(f.Button,{variant:"plain","aria-label":"Activation key popover","aria-describedby":"subscription-activation-key",className:"pf-c-form__group-label-help"},c().createElement(b.ZP,null)))};const je={StepTemplate:Z,id:"wizard-registration",title:"Registration",name:"registration",nextStep:"File system configuration",fields:[{component:T.Z.RADIO,label:"Register images with Red Hat",name:"register-system",initialValue:"register-now-insights",options:[{label:"Register and connect image instances with Red Hat",description:"Includes Subscriptions and Red Hat Insights",value:"register-now-insights","data-testid":"radio-register-now-insights",autoFocus:!0},{label:"Register image instances only",description:"Includes Subscriptions only",value:"register-now",className:"pf-u-mt-sm","data-testid":"radio-register-now"},{label:"Register later",value:"register-later",className:"pf-u-mt-sm","data-testid":"radio-register-later"}]},{component:"activation-keys",name:"subscription-activation-key",required:!0,label:c().createElement(c().Fragment,null,"Activation key to use for this image",c().createElement(Ve,null)),condition:{or:[{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]},isRequired:!0,validate:[{type:x.Z.REQUIRED}]},{component:T.Z.PLAIN_TEXT,name:"subscription-activation-description",label:c().createElement(c().Fragment,null,"Create and manage activation keys in the ",c().createElement(f.Button,{component:"a",target:"_blank",variant:"link",icon:c().createElement(re.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/"},"Customer Portal")),condition:{or:[{when:"register-system",is:"register-now-insights"},{when:"register-system",is:"register-now"}]}},{component:T.Z.PLAIN_TEXT,name:"subscription-register-later",label:c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h3},"Register Later"),c().createElement(f.Text,null,"On initial boot, systems will need to be registered manually before having access to updates or Red Hat services."),c().createElement(f.Text,null,"Registering now is recommended.")),condition:{or:[{when:"register-system",is:"register-later"}]}}]};var Fe=n(6468),qe=n(70363),Be=function(e){var t=e.buttonLabels,n=t.cancel,a=t.submit,i=t.back,o=(0,s.useState)(!1),l=(0,r.Z)(o,2),u=l[0],m=l[1],d=(0,s.useContext)(qe.default),p=d.handlePrev,g=d.formOptions;return c().createElement(Fe.lP,null,(function(){return c().createElement(c().Fragment,null,c().createElement(f.Button,{variant:"primary",type:"button",isDisabled:!g.valid||g.getState().validating||u,isLoading:u,onClick:function(){g.onSubmit({values:g.getState().values,setIsSaving:m})}},u?"Creating image":a),c().createElement(f.Button,{type:"button",variant:"secondary",onClick:p,isDisabled:u},i),c().createElement("div",{className:"pf-c-wizard__footer-cancel"},c().createElement(f.Button,{type:"button",variant:"link",onClick:g.onCancel,isDisabled:u},n)))}))};Be.propTypes={buttonLabels:h().shape({cancel:h().node,submit:h().node,back:h().node}),isSaving:h().bool};const Ge={StepTemplate:Z,id:"wizard-review",name:"review",title:"Review",buttons:Be,fields:[{name:"review",component:"review"}]},Me={StepTemplate:Z,id:"wizard-systemconfiguration-filesystem",title:"File system configuration",name:"File system configuration",substepOf:"System Configuration",nextStep:"packages",fields:[{component:T.Z.PLAIN_TEXT,name:"file-system-configuration-text-component",label:c().createElement(c().Fragment,null,c().createElement(f.Text,null,"Red Hat recommends using automatic partitioning for most installations."),c().createElement(f.Text,null,"Alternatively, you may manually configure the file system of your image by adding, removing, and editing partitions."))},{component:"file-system-config-toggle",name:"file-system-config-toggle",label:"File system configurations toggle"},{component:"file-system-configuration",name:"file-system-configuration",label:"File system configurations",validate:[{type:"fileSystemConfigurationValidator"},{type:x.Z.REQUIRED}],condition:{when:"file-system-config-toggle",is:"manual"}}]},Ue={StepTemplate:Z,id:"wizard-details",name:"image-name",title:"Name image",nextStep:"review",fields:[{component:T.Z.PLAIN_TEXT,name:"plain-text-component",label:c().createElement("p",null,"Optionally enter a name for your image. All images will have a UUID.")},{component:T.Z.TEXT_FIELD,name:"image-name",type:"text",label:"Image name",autoFocus:!0}]};function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const Xe=function(){return function(e){if(e){var t,n={},a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(e);try{for(a.s();!(t=a.n()).done;){var i=t.value.mountpoint;i in n?n[i]++:n[i]=1}}catch(e){a.e(e)}finally{a.f()}for(var o=[],l=0,s=Object.entries(n);l<s.length;l++){var c=(0,r.Z)(s[l],2),u=c[0];c[1]>1&&o.push(u)}var m=n["/"]>=1;return 0===o.length&&m?void 0:{duplicates:o===[]?void 0:o,root:m}}}},He=function(){return function(e){if(e)return Object.values(e).reduce((function(e,t){return t||e}),!1)?void 0:"Please select an image"}};function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ye(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Je=function(e){var t,n;return e%w.at==0?(t=e/w.at,n=w.at):e%w.g7==0?(t=e/w.g7,n=w.g7):e%w.fI==0&&(t=e/w.fI,n=w.fI),[t,n]},et=function(){var e=(0,i.Z)(l().mark((function e(t,n,a){var r,i,o,s,c,u,m,d,p,g;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[t,n,a],e.next=3,M.Z.getPackages.apply(M.Z,i);case 3:if(o=e.sent,s=o.data,c=o.meta,(null===(r=s[0])||void 0===r?void 0:r.name)!==a){e.next=10;break}u=null===(m=s[0])||void 0===m?void 0:m.summary,e.next=17;break;case 10:if((null===(d=s)||void 0===d?void 0:d.length)===c.count){e.next=15;break}return e.next=13,M.Z.getPackages.apply(M.Z,i.concat([c.count]));case 13:p=e.sent,s=p.data;case 15:g=s.find((function(e){return a===e.name})),u=null==g?void 0:g.summary;case 17:return e.abrupt("return",u||"");case 18:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();const tt=function(){var e,t,n=(0,Oe.I0)(),a=(0,Ae.useNavigate)(),o=(0,Ae.useLocation)(),s=null==o||null===(e=o.state)||void 0===e?void 0:e.composeRequest,u=function(e){if(e){var t,n,a,o,s,c,u=e.image_requests[0],m=u.upload_request,d={};if(d["image-name"]=e.image_name,d.release=null==e?void 0:e.distribution,d["target-environment"]={aws:!1,azure:!1,gcp:!1,"guest-image":!1},s="aws.s3"===m.type?u.image_type:m.type,d["target-environment"][s]=!0,"aws"===s)d["aws-account-id"]=null==m||null===(c=m.options)||void 0===c?void 0:c.share_with_accounts[0];else if("azure"===s){var p,g,f;d["azure-tenant-id"]=null==m||null===(p=m.options)||void 0===p?void 0:p.tenant_id,d["azure-subscription-id"]=null==m||null===(g=m.options)||void 0===g?void 0:g.subscription_id,d["azure-resource-group"]=null==m||null===(f=m.options)||void 0===f?void 0:f.resource_group}else if("gcp"===s){var v,h=(null==m||null===(v=m.options)||void 0===v?void 0:v.share_with_accounts[0]).split(":"),y=(0,r.Z)(h,2),b=y[0],E=y[1];switch(b){case"user":d["google-account-type"]="googleAccount",d["google-email"]=E;break;case"serviceAccount":d["google-account-type"]="serviceAccount",d["google-email"]=E;break;case"group":d["google-account-type"]="googleGroup",d["google-email"]=E;break;case"domain":d["google-account-type"]="domain",d["google-domain"]=E}}var T=[];null==e||null===(t=e.customizations)||void 0===t||null===(n=t.packages)||void 0===n||n.forEach(function(){var t=(0,i.Z)(l().mark((function t(n){var a,r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,et(null==e?void 0:e.distribution,null==u?void 0:u.architecture,n);case 2:a=t.sent,r={name:n,summary:a},T.push(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d["selected-packages"]=T;var x=null==e||null===(a=e.customizations)||void 0===a?void 0:a.filesystem;if(x){d["file-system-config-toggle"]="manual";var w,S=[],k=$e(x);try{for(k.s();!(w=k.n()).done;){var I=w.value,Z=Je(I.min_size),L=(0,r.Z)(Z,2),C=L[0],z=L[1];S.push({mountpoint:I.mountpoint,size:C,unit:z})}}catch(e){k.e(e)}finally{k.f()}d["file-system-configuration"]=S}var A=null==e||null===(o=e.customizations)||void 0===o?void 0:o.subscription;return A?(A.insights?d["register-system"]="register-now-insights":d["register-system"]="register-now",d["subscription-activation-key"]=A["activation-key"],d["subscription-organization-id"]=A.organization):d["register-system"]="register-later",d}}(s),m=function(e){if(e){var t=e.image_requests[0].upload_request,n=["image-output"];return"aws"===t.type?n.push("aws-target-env"):"azure"===t.type?n.push("azure-target-env"):"gcp"===t.type&&n.push("google-cloud-target-env"),(null==e?void 0:e.distribution)===w.F2&&n.push("registration"),n.concat(["File system configuration","packages","image-name"])}return[]}(s),d=function(){return a("/")};return c().createElement(ze,{onClose:d,onSubmit:function(e){var t=e.values,r=e.setIsSaving;r((function(){return!0}));var i=function(e){var t,n,a,r,i,o,l,s={packages:null===(t=e["selected-packages"])||void 0===t?void 0:t.map((function(e){return e.name}))};if("register-now-insights"===e["register-system"]?s.subscription={"activation-key":e["subscription-activation-key"],insights:!0,organization:Number(e["subscription-organization-id"]),"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/"}:"register-now"===e["register-system"]&&(s.subscription={"activation-key":e["subscription-activation-key"],insights:!1,organization:Number(e["subscription-organization-id"]),"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/"}),"manual"===e["file-system-config-toggle"]){s.filesystem=[];var c,u=$e(e["file-system-configuration"]);try{for(u.s();!(c=u.n()).done;){var m=c.value;s.filesystem.push({mountpoint:m.mountpoint,min_size:m.size*m.unit})}}catch(e){u.e(e)}finally{u.f()}}var d=[];if(null!==(n=e["target-environment"])&&void 0!==n&&n.aws){var p={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"ami",upload_request:{type:"aws",options:{share_with_accounts:[e["aws-account-id"]]}}}],customizations:s};d.push(p)}if(null!==(a=e["target-environment"])&&void 0!==a&&a.gcp){var g="";switch(e["google-account-type"]){case"googleAccount":g="user:".concat(e["google-email"]);break;case"serviceAccount":g="serviceAccount:".concat(e["google-email"]);break;case"googleGroup":g="group:".concat(e["google-email"]);break;case"domain":g="domain:".concat(e["google-domain"])}var f={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vhd",upload_request:{type:"gcp",options:{share_with_accounts:[g]}}}],customizations:s};d.push(f)}if(null!==(r=e["target-environment"])&&void 0!==r&&r.azure){var v={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vhd",upload_request:{type:"azure",options:{tenant_id:e["azure-tenant-id"],subscription_id:e["azure-subscription-id"],resource_group:e["azure-resource-group"]}}}],customizations:s};d.push(v)}if(null!==(i=e["target-environment"])&&void 0!==i&&i.vsphere){var h={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"vsphere",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(h)}if(null!==(o=e["target-environment"])&&void 0!==o&&o["guest-image"]){var y={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"guest-image",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(y)}if(null!==(l=e["target-environment"])&&void 0!==l&&l["image-installer"]){var b={distribution:e.release,image_name:null==e?void 0:e["image-name"],image_requests:[{architecture:"x86_64",image_type:"image-installer",upload_request:{type:"aws.s3",options:{}}}],customizations:s};d.push(b)}return d}(t);Promise.all(i.map((function(e){return M.Z.composeImage(e).then((function(t){n((0,_e.tE)(Qe(Qe({},t),{},{request:e,image_status:{status:"pending"}}),!0))}))}))).then((function(){a("/"),n((0,De.wN)({variant:"success",title:"Your image is being created"})),r(!1)})).catch((function(e){n((0,De.wN)({variant:"danger",title:"Your image could not be created",description:"Status code "+e.response.status+": "+e.response.statusText})),r(!1)}))},defaultArch:"x86_64",customValidatorMapper:{fileSystemConfigurationValidator:Xe,targetEnvironmentValidator:He},schema:{fields:[{component:T.Z.WIZARD,name:"image-builder-wizard",className:"image_builder",isDynamic:!0,inModal:!0,onKeyDown:function(e){!function(e,t){"Escape"===e.key&&t()}(e,d)},buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release"],description:c().createElement(c().Fragment,null,"Image builder allows you to create a custom image and push it to target environments. ",c().createElement(k.Z,null)),fields:[z,Pe,_,Re,je,Ne,Me,Ue,Ge],initialState:{activeStep:(null==o||null===(t=o.state)||void 0===t?void 0:t.initialStep)||"image-output",activeStepIndex:m.length,maxStepIndex:m.length,prevSteps:m}}]},initialValues:u})}},77310:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(75418),r=n.n(a),i=n(75857),o=n(50470);const l=function(){return r().createElement(i.Button,{component:"a",target:"_blank",variant:"link",icon:r().createElement(o.ZP,null),iconPosition:"right",isInline:!0,href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/uploading_a_customized_rhel_system_image_to_cloud_environments/index"},"Documentation")}},87248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var a=n(15861),r=n(87757),i=n.n(r),o=n(9669),l=n.n(o),s=n(58061),c={headers:{"Content-Type":"application/json"}};function u(){return(u=(0,a.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().post(s.DO.concat("/compose"),t,c);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,a.Z)(i().mark((function e(t,n){var a,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({limit:t,offset:n}),r="/composes?"+a.toString(),e.next=4,l().get(s.DO.concat(r));case 4:return o=e.sent,e.abrupt("return",o.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=(0,a.Z)(i().mark((function e(t){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/composes/"+t,e.next=3,l().get(s.DO.concat(n));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=(0,a.Z)(i().mark((function e(t,n,a,r){var o,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new URLSearchParams({distribution:t,architecture:n,search:a}),r&&o.append("limit",r),c="/packages?"+o.toString(),e.next=5,l().get(s.DO.concat(c));case 5:return u=e.sent,e.abrupt("return",u.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=(0,a.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(s.DO.concat("/version"));case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=(0,a.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(s.UD.concat("/activation_keys"));case 3:return t=e.sent,e.abrupt("return",t.data.body);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const v={composeImage:function(e){return u.apply(this,arguments)},getComposes:function(e,t){return m.apply(this,arguments)},getComposeStatus:function(e){return d.apply(this,arguments)},getPackages:function(e,t,n,a){return p.apply(this,arguments)},getVersion:function(){return g.apply(this,arguments)},getActivationKeys:function(){return f.apply(this,arguments)}}},58061:(e,t,n)=>{"use strict";n.d(t,{DO:()=>a,F2:()=>i,UD:()=>r,at:()=>s,fI:()=>o,g7:()=>l});var a="/api/image-builder/v1",r="/api/rhsm/v2",i="rhel-85",o=Math.pow(1024,1),l=Math.pow(1024,2),s=Math.pow(1024,3)},18247:(e,t,n)=>{"use strict";n.d(t,{dD:()=>m,s1:()=>u,tE:()=>s});var a=n(15861),r=n(87757),i=n.n(r),o=n(87248),l=n(26698),s=function(e,t){return{type:l.Z.COMPOSE_ADDED,payload:{compose:e,insert:t}}},c=function(e,t){return{type:l.Z.COMPOSE_UPDATED_STATUS,payload:{id:e,status:t}}},u=function(e){return function(){var t=(0,a.Z)(i().mark((function t(n){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.Z.getComposeStatus(e);case 2:a=t.sent,n(c(e,a.image_status));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},m=function(e,t){return function(){var n=(0,a.Z)(i().mark((function n(a){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.Z.getComposes(e,t);case 2:(r=n.sent).data.map((function(e){a(s(e,!1)),a(u(e.id))})),a((i=r.meta.count,{type:l.Z.COMPOSES_UPDATED_COUNT,payload:{count:i}}));case 5:case"end":return n.stop()}var i}),n)})));return function(e){return n.apply(this,arguments)}}()}},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{}}]);
//# sourceMappingURL=../sourcemaps/456.fa9e95a1e3f69bd1d25601e051b5bb44.js.map