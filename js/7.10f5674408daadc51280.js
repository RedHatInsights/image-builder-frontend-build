(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{631:function(e,t,a){(t=a(6)(!1)).push([e.i,".tiles{display:flex}.tile{flex:1 0 0px}.pf-c-tile:focus{--pf-c-tile__title--Color: var(--pf-c-tile__title--Color);--pf-c-tile__icon--Color: var(---pf-global--Color--100);--pf-c-tile--before--BorderWidth: var(--pf-global--BorderWidth--sm);--pf-c-tile--before--BorderColor: var(--pf-global--BorderColor--100)}.pf-c-tile.pf-m-selected:focus{--pf-c-tile__title--Color: var(--pf-c-tile--focus__title--Color);--pf-c-tile__icon--Color: var(--pf-c-tile--focus__icon--Color);--pf-c-tile--before--BorderWidth: var(--pf-c-tile--focus--before--BorderWidth);--pf-c-tile--before--BorderColor: var(--pf-c-tile--focus--before--BorderColor)}.provider-icon{width:1em;height:1em}\n",""]),e.exports=t},632:function(e,t,a){(t=a(6)(!1)).push([e.i,".error{color:var(--pf-global--danger-color--100)}.pf-c-content h3{margin-top:var(--pf-global--spacer--xl)}@media screen and (min-width: 576px){.pf-c-content dl{grid-template:1fr / 25% 1fr;grid-gap:var(--pf-global--spacer--sm)}}#destination-header{font-size:18px;margin-bottom:var(--pf-global--spacer--sm)}\n",""]),e.exports=t},633:function(e,t,a){(t=a(6)(!1)).push([e.i,".pf-c-wizard__nav-list{padding-right:0px}\n",""]),e.exports=t},647:function(e,t,a){var n=a(631);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0},s=a(7)(n,o);n.locals&&(e.exports=n.locals),e.hot.accept(631,(function(){var t=a(631);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var a,n=0;for(a in e){if(!t||e[a]!==t[a])return!1;n++}for(a in t)n--;return 0===n}(n.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");s(t)})),e.hot.dispose((function(){s()}))},648:function(e,t,a){var n=a(632);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0},s=a(7)(n,o);n.locals&&(e.exports=n.locals),e.hot.accept(632,(function(){var t=a(632);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var a,n=0;for(a in e){if(!t||e[a]!==t[a])return!1;n++}for(a in t)n--;return 0===n}(n.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");s(t)})),e.hot.dispose((function(){s()}))},649:function(e,t,a){var n=a(633);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0},s=a(7)(n,o);n.locals&&(e.exports=n.locals),e.hot.accept(633,(function(){var t=a(633);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var a,n=0;for(a in e){if(!t||e[a]!==t[a])return!1;n++}for(a in t)n--;return 0===n}(n.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");s(t)})),e.hot.dispose((function(){s()}))},650:function(e,t,a){"use strict";a.r(t);var n=a(642),o=a.n(n),s=a(646),i=a.n(s),r=a(81),c=a.n(r),l=a(134),u=a.n(l),p=a(192),d=a.n(p),m=a(193),h=a.n(m),b=a(455),g=a.n(b),f=a(194),v=a.n(f),S=a(143),k=a.n(S),E=a(195),y=a.n(E),w=a(22),C=a.n(w),A=a(1),N=a.n(A),D=a(127),O=a(176),P=a(636),R=a(388),z=a(424),W=a(381),_=a(353),x=a(382),j=a(377),U=a(383),I=a(391),L=(a(647),function(e){return N.a.createElement(N.a.Fragment,null,N.a.createElement(W.a,null,N.a.createElement(_.a,{headingLevel:"h2",size:"xl"},"Image output"),N.a.createElement(x.a,{isRequired:!0,label:"Release",fieldId:"release-select"},N.a.createElement(j.a,{value:e.value,onChange:function(t){return e.setRelease(t)},isRequired:!0,"aria-label":"Select release input",id:"release-select","data-testid":"release-select"},[{value:"rhel-8",label:"Red Hat Enterprise Linux (RHEL) 8.3"},{value:"centos-8",label:"CentOS Stream 8"}].map((function(e){return N.a.createElement(U.a,{key:e.value,value:e.value,label:e.label})})))),N.a.createElement(x.a,{isRequired:!0,label:"Select target environment","data-testid":"target-select"},N.a.createElement("div",{className:"tiles"},N.a.createElement(I.a,{className:"tile pf-u-mr-sm","data-testid":"upload-aws",title:"Amazon Web Services",icon:N.a.createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"}),onClick:function(){return e.toggleUploadDestination("aws")},isSelected:e.uploadDestinations.aws,isStacked:!0,isDisplayLarge:!0}),N.a.createElement(I.a,{className:"tile pf-u-mr-sm","data-testid":"upload-azure",title:"Microsoft Azure",icon:N.a.createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"}),onClick:function(){return e.toggleUploadDestination("azure")},isSelected:e.uploadDestinations.azure,isStacked:!0,isDisplayLarge:!0,isDisabled:!0}),N.a.createElement(I.a,{className:"tile","data-testid":"upload-google",title:"Google Cloud Platform",icon:N.a.createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"}),onClick:function(){return e.toggleUploadDestination("google")},isSelected:e.uploadDestinations.google,isStacked:!0,isDisplayLarge:!0,isDisabled:!0})))))});L.propTypes={toggleUploadAWS:C.a.func,uploadDestinations:C.a.object,setRelease:C.a.func,value:C.a.string,toggleUploadDestination:C.a.func};var T=L,F=a(149),q=function(e){return N.a.createElement(W.a,null,N.a.createElement(_.a,{headingLevel:"h2",size:"xl"},"Target Environment - Upload to AWS"),N.a.createElement("p",null,"Your image will be uploaded to a temporary account on Amazon Web Services. ",N.a.createElement("br",null),"The image will be shared with the account you provide below. ",N.a.createElement("br",null),"Within the next 14 days you will need to copy the shared image to your own account. After 14 days it will be unavailable and will have to be regenerated."),N.a.createElement(x.a,{isRequired:!0,label:"AWS account ID",fieldId:"aws-account-id",helperTextInvalid:e.errors["aws-account-id"]&&e.errors["aws-account-id"].value||"",validated:e.errors["aws-account-id"]?"error":"default"},N.a.createElement(F.a,{value:e.uploadAWS.options.share_with_accounts||"",type:"text","aria-label":"AWS account ID",id:"aws-account-id","data-testid":"aws-account-id",isRequired:!0,onChange:function(t){return e.setUploadOptions("aws",Object.assign(e.uploadAWS.options,{share_with_accounts:[t]}))}})))};q.propTypes={setUploadOptions:C.a.func,uploadAWS:C.a.object,errors:C.a.object};var B=q,G=a(56),H=a(386),M=a(419),J=function(e){var t=[N.a.createElement(G.a,{"aria-label":"Search button for available packages",key:"availableSearchButton",onClick:e.handlePackagesSearch},"Search")];return N.a.createElement(N.a.Fragment,null,N.a.createElement(R.a,null,N.a.createElement(_.a,{headingLevel:"h2",size:"xl"},"Additional packages"),N.a.createElement(H.a,null,"Optionally add additional packages to your ",N.a.createElement("strong",null,e.release)," image")),N.a.createElement(M.a,{className:"pf-u-mt-sm",isSearchable:!0,availableOptionsActions:t,availableOptions:e.packagesAvailableComponents,chosenOptions:e.packagesFilteredComponents,addSelected:e.packageListChange,removeSelected:e.packageListChange,addAll:e.packageListChange,removeAll:e.packageListChange,onAvailableOptionsSearchInputChanged:e.setPackagesSearchName,onChosenOptionsSearchInputChanged:e.handlePackagesFilter,filterOption:function(){return!0},id:"basicSelectorWithSearch"}))};J.propTypes={packageListChange:C.a.func,release:C.a.string,packagesAvailableComponents:C.a.arrayOf(C.a.object),packagesFilteredComponents:C.a.arrayOf(C.a.object),handlePackagesSearch:C.a.func,handlePackagesFilter:C.a.func,setPackagesSearchName:C.a.func};var Y=J,K=a(387),Q=function(e){return N.a.createElement(W.a,null,N.a.createElement(_.a,{headingLevel:"h2",size:"xl"},"Registration"),N.a.createElement(x.a,{isRequired:!0,label:"Register the system"},N.a.createElement(K.a,{name:"subscribe-now-radio",isChecked:e.subscribeNow,id:"subscribe-now-radio",label:"Embed an activation key and register systems on first boot",onChange:function(){return e.setSubscribeNow(!0)},"data-testid":"register-now-radio-button"}),N.a.createElement(K.a,{name:"subscribe-later-radio",isChecked:!e.subscribeNow,label:"Register the system later",id:"subscribe-later-radio",onChange:function(){return e.setSubscribeNow(!1)},"data-testid":"register-later-radio-button"})),e.subscribeNow&&N.a.createElement(N.a.Fragment,null,N.a.createElement(x.a,{label:"Organization ID",fieldId:"subscription-organization"},N.a.createElement(F.a,{isDisabled:!0,value:e.subscription.organization||"",type:"text",id:"subscription-organization","aria-label":"Subscription organization ID","data-testid":"organization-id"})),N.a.createElement(x.a,{isRequired:!0,label:"Activation key",fieldId:"subscription-activation",helperTextInvalid:e.errors["subscription-activation"]&&e.errors["subscription-activation"].value||"",validated:e.errors["subscription-activation"]?"error":"default"},N.a.createElement(F.a,{value:e.subscription["activation-key"]||"",type:"password","data-testid":"subscription-activation",isRequired:!0,id:"subscription-activation","aria-label":"Subscription activation key",onChange:function(t){return e.setSubscription(Object.assign(e.subscription,{"activation-key":t}))}}))))};Q.propTypes={setSubscription:C.a.func,setSubscribeNow:C.a.func,subscription:C.a.object,subscribeNow:C.a.bool,errors:C.a.object};var V=Q,X=a(389),Z=a(390),$=a(423),ee=a(116),te=(a(648),function(e){var t=N.a.createElement(N.a.Fragment,null,N.a.createElement(H.a,{id:"destination-header"},"Amazon Web Services"),N.a.createElement(X.a,{component:X.b.dl,"data-testid":"review-image-upload-aws"},N.a.createElement(Z.a,{component:Z.b.dt},"Account ID"),e.uploadAWSErrors["aws-account-id"]?N.a.createElement(Z.a,{component:Z.b.dd},N.a.createElement(ee.a,{className:"error"})," ",e.uploadAWSErrors["aws-account-id"].value):N.a.createElement(Z.a,{component:Z.b.dd},e.uploadAWS.options.share_with_accounts[0])));return N.a.createElement(N.a.Fragment,null,(Object.keys(e.uploadAWSErrors).length>0||Object.keys(e.subscriptionErrors).length>0)&&N.a.createElement($.a,{variant:"danger",className:"pf-u-mb-xl",isInline:!0,title:"Required information is missing"}),N.a.createElement(_.a,{headingLevel:"h2",size:"xl"},"Review"),N.a.createElement(R.a,null,N.a.createElement(H.a,{component:H.b.small},"Review the information and click Create image to create the image using the following criteria."),N.a.createElement(H.a,{component:H.b.h3},"Image output"),N.a.createElement(X.a,{component:X.b.dl,"data-testid":"review-image-output"},N.a.createElement(Z.a,{component:Z.b.dt},"Release"),N.a.createElement(Z.a,{component:Z.b.dd},{"rhel-8":"Red Hat Enterprise Linux (RHEL) 8.3","centos-8":"CentOS Stream 8"}[e.release])),N.a.createElement(H.a,{component:H.b.h3},"Target environment"),e.uploadDestinations.aws&&t,N.a.createElement(H.a,{component:H.b.h3},"Registration"),N.a.createElement(X.a,{component:X.b.dl,"data-testid":"review-image-registration"},N.a.createElement(Z.a,{component:Z.b.dt},"Subscription"),e.subscribeNow?N.a.createElement(Z.a,{component:Z.b.dd},"Register the system on first boot"):N.a.createElement(Z.a,{component:Z.b.dd},"Register the system later"),N.a.createElement(Z.a,{component:Z.b.dt},"Activation key"),e.subscriptionErrors["subscription-activation"]?N.a.createElement(Z.a,{component:Z.b.dd},N.a.createElement(ee.a,{className:"error"})," ",e.subscriptionErrors["subscription-activation"].value):N.a.createElement(Z.a,{component:Z.b.dd,type:"password"},"*".repeat(e.subscription["activation-key"].length)))))});te.propTypes={release:C.a.string,uploadAWS:C.a.object,uploadDestinations:C.a.object,subscription:C.a.object,subscribeNow:C.a.bool,uploadAWSErrors:C.a.object,subscriptionErrors:C.a.object};var ae=te,ne=a(366);a(649);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ie(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var re=function(e){y()(s,e);var t,a,n=(t=s,function(){var e,a=k()(t);if(ie()){var n=k()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return v()(this,e)});function s(e){var t;return d()(this,s),(t=n.call(this,e)).handlePackagesSearch=t.handlePackagesSearch.bind(g()(t)),t.handlePackagesFilter=t.handlePackagesFilter.bind(g()(t)),t.packageListChange=t.packageListChange.bind(g()(t)),t.mapPackagesToComponent=t.mapPackagesToComponent.bind(g()(t)),t.setRelease=t.setRelease.bind(g()(t)),t.setUploadOptions=t.setUploadOptions.bind(g()(t)),t.setSubscription=t.setSubscription.bind(g()(t)),t.setSubscribeNow=t.setSubscribeNow.bind(g()(t)),t.setPackagesSearchName=t.setPackagesSearchName.bind(g()(t)),t.toggleUploadDestination=t.toggleUploadDestination.bind(g()(t)),t.onStep=t.onStep.bind(g()(t)),t.onSave=t.onSave.bind(g()(t)),t.onClose=t.onClose.bind(g()(t)),t.validate=t.validate.bind(g()(t)),t.validateUploadAmazon=t.validateUploadAmazon.bind(g()(t)),t.validateSubscription=t.validateSubscription.bind(g()(t)),t.state={arch:"x86_64",imageType:"qcow2",release:"rhel-8",uploadAWS:{type:"aws",options:{share_with_accounts:[]}},uploadAzure:{type:"azure",options:{temp:""}},uploadGoogle:{type:"google",options:{temp:""}},uploadDestinations:{aws:!1,azure:!1,google:!1},subscription:{organization:null,"activation-key":null,"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/",insights:!0},subscribeNow:!0,uploadAWSErrors:{},uploadAzureErrors:{},uploadGoogleErrors:{},subscriptionErrors:{},packagesAvailableComponents:[],packagesSelectedComponents:[],packagesFilteredComponents:[],packagesSelectedNames:[],packagesSearchName:""},t}return h()(s,[{key:"componentDidMount",value:(a=u()(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,insights.chrome.auth.getUser();case 2:t=e.sent,this.setState({subscription:{organization:Number(t.identity.internal.org_id)}});case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onStep",value:function(e){"Review"===e.name&&this.validate()}},{key:"validate",value:function(){this.state.uploadDestinations.aws?this.validateUploadAmazon():this.setState({uploadAWSErrors:{},uploadAzureErrors:{},uploadGoogleErrors:{}}),this.state.subscribeNow?this.validateSubscription():this.setState({subscriptionErrors:{}})}},{key:"validateUploadAmazon",value:function(){var e={},t=this.state.uploadAWS.options.share_with_accounts;(0===t.length||12!==t[0].length||isNaN(t[0]))&&(e["aws-account-id"]={label:"AWS account ID",value:"A 12-digit number is required"}),this.setState({uploadAWSErrors:e})}},{key:"validateSubscription",value:function(){var e={};this.state.subscription["activation-key"]||(e["subscription-activation"]={label:"Activation key",value:"A value is required"}),this.setState({subscriptionErrors:e})}},{key:"setRelease",value:function(e){this.setState({release:e})}},{key:"toggleUploadDestination",value:function(e){this.setState((function(t){return se({},t,{uploadDestinations:se({},t.uploadDestinations,i()({},e,!t.uploadDestinations[e]))})}))}},{key:"setUploadOptions",value:function(e,t){switch(e){case"aws":this.setState({uploadAWS:{type:e,options:t}});break;case"azure":this.setState({uploadAzure:{type:e,options:t}});break;case"google":this.setState({uploadGoogle:{type:e,options:t}})}}},{key:"setSubscribeNow",value:function(e){this.setState({subscribeNow:e})}},{key:"setSubscription",value:function(e){this.setState({subscription:e},this.validate)}},{key:"setPackagesSearchName",value:function(e){this.setState({packagesSearchName:e})}},{key:"mapPackagesToComponent",value:function(e){return e.map((function(e){return N.a.createElement(R.a,{key:e},N.a.createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),N.a.createElement("small",null,e.summary))}))}},{key:"mapComponentToPackageName",value:function(e){return e.props.children[0].props.children}},{key:"handlePackagesSearch",value:function(){var e=this;ne.a.getPackages(this.state.release,this.state.arch,this.state.packagesSearchName).then((function(t){var a=e.mapPackagesToComponent(t.data);e.setState({packagesAvailableComponents:a})}))}},{key:"handlePackagesFilter",value:function(e){var t=this,a=this.state.packagesSelectedComponents.filter((function(a){return t.mapComponentToPackageName(a).includes(e)}));this.setState({packagesFilteredComponents:a})}},{key:"packageListChange",value:function(e,t){var a=this,n=t.map((function(e){return a.mapComponentToPackageName(e)}));this.setState({packagesAvailableComponents:e,packagesSelectedComponents:t,packagesFilteredComponents:t,packagesSelectedNames:n})}},{key:"onSave",value:function(){var e=this,t=[];Object.keys(this.state.uploadDestinations).forEach((function(a){switch(a){case"aws":var n={distribution:e.state.release,image_requests:[{architecture:e.state.arch,image_type:"ami",upload_requests:[e.state.uploadAWS]}],customizations:{subscription:e.state.subscription,packages:e.state.packagesSelectedNames}};t.push(n)}}));var a=[];t.forEach((function(t){var n=ne.a.composeImage(t).then((function(a){var n={};n[a.id]={image_status:{status:"pending"},distribution:t.distribution,architecture:t.image_requests[0].architecture,image_type:t.image_requests[0].image_type},e.props.updateCompose(n)}));a.push(n)})),Promise.all(a).then((function(){return e.props.history.push("/landing")}))}},{key:"onClose",value:function(){this.props.history.push("/landing")}},{key:"render",value:function(){var e={name:"Image output",component:N.a.createElement(T,{value:this.state.release,setRelease:this.setRelease,toggleUploadDestination:this.toggleUploadDestination,uploadDestinations:this.state.uploadDestinations})},t={name:"Amazon Web Services",component:N.a.createElement(B,{uploadAWS:this.state.uploadAWS,setUploadOptions:this.setUploadOptions,errors:this.state.uploadAWSErrors})},a=[];this.state.uploadDestinations.aws&&a.push(t),this.state.uploadDestinations.azure&&a.push({name:"Microsoft Azure"}),this.state.uploadDestinations.google&&a.push({name:"Google Cloud Platform"});var n={name:"Target environment",steps:a},s=[e].concat(o()(n.steps.length>0?[n]:[]),[{name:"Registration",component:N.a.createElement(V,{subscription:this.state.subscription,subscribeNow:this.state.subscribeNow,setSubscription:this.setSubscription,setSubscribeNow:this.setSubscribeNow,errors:this.state.subscriptionErrors})},{name:"Packages",component:N.a.createElement(Y,{packageListChange:this.packageListChange,release:this.state.release,packagesAvailableComponents:this.state.packagesAvailableComponents,packagesFilteredComponents:this.state.packagesFilteredComponents,handlePackagesSearch:this.handlePackagesSearch,handlePackagesFilter:this.handlePackagesFilter,setPackagesSearchName:this.setPackagesSearchName})},{name:"Review",component:N.a.createElement(ae,{release:this.state.release,uploadAWS:this.state.uploadAWS,uploadDestinations:this.state.uploadDestinations,subscription:this.state.subscription,subscribeNow:this.state.subscribeNow,uploadAWSErrors:this.state.uploadAWSErrors,subscriptionErrors:this.state.subscriptionErrors}),nextButtonText:"Create"}]);return N.a.createElement(N.a.Fragment,null,N.a.createElement(z.a,{title:"Create image",onNext:this.onStep,onGoToStep:this.onStep,steps:s,onClose:this.onClose,onSave:this.onSave,isOpen:!0}))}}]),s}(A.Component);re.propTypes={updateCompose:C.a.func,history:C.a.object};t.default=Object(O.connect)(null,(function(e){return{updateCompose:function(t){return e(P.a.updateCompose(t))}}}))(Object(D.o)(re))}}]);
//# sourceMappingURL=7.10f5674408daadc51280.js.map