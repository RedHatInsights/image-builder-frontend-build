(self.webpackChunkimage_builder=self.webpackChunkimage_builder||[]).push([[757],{93694:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Te});var a=n(4942),r=n(93264),o=n.n(r),i=n(87462),l=n(45987),s=n(79442),c=n(67850),u=n(80124),m=n(99421),d=n(45697),p=n.n(d),g=n(29439),v=n(48880),f=n(96354),h=n(64124),b=n(58061);const E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["target-environment"],n=e.release,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.skipAws,o=a.skipGoogle,i=a.skipAzure;return!r&&null!=t&&t.aws?"aws-target-env":!o&&null!=t&&t.google?"google-cloud-target-env":!i&&null!=t&&t.azure?"ms-azure-target-env":n===b.F?"registration":"packages"};var y,T=(y={},(0,a.Z)(y,b.F,"Red Hat Enterprise Linux (RHEL) 8"),(0,a.Z)(y,"centos-8","CentOS Stream 8"),y);const x={title:"Image output",name:"image-output",nextStep:function(e){var t=e.values;return E(t)},fields:[{component:f.Z.SELECT,label:"Release",name:"release",simpleValue:!0,initialValue:b.F,options:Object.entries(T).map((function(e){var t=(0,g.Z)(e,2),n=t[0];return{label:t[1],value:n}})),isRequired:!0,validate:[{type:h.Z.REQUIRED}]},{component:"output",name:"target-environment",label:"Select target environments",isRequired:!0,validate:[{type:h.Z.REQUIRED}]}]};var w={"subscribe-now-radio":{title:"Embed an activation key and register systems on first boot",testId:"register-now-radio-button"},"register-later-radio-button":{title:"Register the system later",testId:"register-later-radio-button"}};const S={title:"Registration",name:"registration",nextStep:"packages",fields:[{component:f.Z.PLAIN_TEXT,name:"register-explanation",label:"Register your system with subscription manager (RHSM) and insights when the image first boots."},{component:f.Z.RADIO,label:"Register the system",name:"register-system",initialValue:"register-later-radio-button",options:Object.entries(w).map((function(e){var t=(0,g.Z)(e,2),n=t[0],a=t[1];return{label:a.title,value:n,"data-testid":a.testId}}))},{component:"organization-id",name:"subscription-organization","data-testid":"organization-id",condition:{or:[{when:"register-system",is:"subscribe-now-radio"}]}},{component:f.Z.TEXT_FIELD,name:"subscription-activation","data-testid":"subscription-activation",required:!0,type:"text",label:"Activation key",condition:{or:[{when:"register-system",is:"subscribe-now-radio"}]},isRequired:!0,validate:[{type:h.Z.REQUIRED}]}]};var L=n(84213),k={googleAccount:"Google account",serviceAccount:"Service account",googleGroup:"Google group",domain:"Domain"},I=function(e){var t=e.appendTo;return o().createElement(m.Popover,{appendTo:t,hasAutoWidth:!0,maxWidth:"35rem",headerContent:"Valid account types",bodyContent:o().createElement(m.TextContent,null,o().createElement(m.Text,null,"The following account types can have an image shared with them:"),o().createElement(m.TextList,null,o().createElement(m.TextListItem,null,o().createElement("strong",null,"Google account:")," A Google account represents a developer, an administrator, or any other person who interacts with Google Cloud. e.g., ",o().createElement("em",null,"`alice@gmail.com`"),"."),o().createElement(m.TextListItem,null,o().createElement("strong",null,"Service account:")," A service account is an account for an application instead of an individual end user. e.g., ",o().createElement("em",null,"`myapp@appspot.gserviceaccount.com`"),"."),o().createElement(m.TextListItem,null,o().createElement("strong",null,"Google group:")," A Google group is a named collection of Google accounts and service accounts. e.g., ",o().createElement("em",null,"`admins@example.com`"),"."),o().createElement(m.TextListItem,null,o().createElement("strong",null,"Google Workspace domain/Cloud Identity domain:")," A Google workspace or cloud identity domain represents a virtual group of all the Google accounts in an organization. These domains represent your organization's internet domain name. e.g., ",o().createElement("em",null,"`mycompany.com`"),".")))},o().createElement(m.Button,{variant:"plain","aria-label":"Account info","aria-describedby":"google-account-type",className:"pf-c-form__group-label-help"},o().createElement(L.by,null)))};I.propTypes={appendTo:p().any};const _={title:"Google Cloud Platform",customTitle:o().createElement(m.Title,{headingLevel:"h1",size:"xl"},"Target environment - Google Cloud Platform"),name:"google-cloud-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return E(t,{skipGoogle:!0,skipAws:!0})},fields:[{component:f.Z.PLAIN_TEXT,name:"google-cloud-text-component",label:o().createElement(m.Text,null,"Your image will be uploaded to Google Cloud Platform and shared with the email you provide below. ",o().createElement("br",null),"The image should be copied to your account within 14 days.")},{component:"radio-popover",label:"Type",Popover:I,name:"google-account-type",initialValue:"googleAccount",options:Object.entries(k).map((function(e){var t=(0,g.Z)(e,2),n=t[0],a=t[1];return{label:"domain"===n?"Google Workspace domain or Cloud Identity domain":a,value:n}})),isRequired:!0,validate:[{type:h.Z.REQUIRED}]},{component:f.Z.TEXT_FIELD,name:"google-email","data-testid":"input-google-email",type:"text",label:"Email address",condition:{or:[{when:"google-account-type",is:"googleAccount"},{when:"google-account-type",is:"serviceAccount"},{when:"google-account-type",is:"googleGroup"},{when:"google-account-type",is:null}]},isRequired:!0,validate:[{type:h.Z.REQUIRED},{type:h.Z.PATTERN,pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,}$",message:"Please enter a valid email address"}]},{component:f.Z.TEXT_FIELD,name:"google-domain",type:"text",label:"Domain",condition:{when:"google-account-type",is:"domain"},isRequired:!0,validate:[{type:h.Z.REQUIRED}]}]},Z=function(){var e,t,n,a,i,l,s,c,u,d,p,f,h,b,E,y,x,S,L,I,_,Z,D,C,z,A,O,P,R,N,V,G,j,q,U,F,W,B,M,H,X,Q,K,Y,$,J,ee,te,ne,ae,re=(0,r.useState)(0),oe=(0,g.Z)(re,2),ie=oe[0],le=oe[1],se=(0,v.default)().getState;return o().createElement(o().Fragment,null,o().createElement(m.Text,null,'Review the information and click "Create image" to create the image using the following criteria.'),o().createElement(m.DescriptionList,null,o().createElement(m.DescriptionListGroup,null,o().createElement(m.DescriptionListTerm,null,"Release"),o().createElement(m.DescriptionListDescription,null,null==T?void 0:T[null===(e=se())||void 0===e||null===(t=e.values)||void 0===t?void 0:t.release]))),o().createElement(m.Tabs,{isFilled:!0,activeKey:ie,onSelect:function(e,t){le(t)},className:"pf-u-w-75"},o().createElement(m.Tab,{eventKey:0,title:o().createElement(m.TabTitleText,null,"Target environment"),"data-testid":"tab-target"},o().createElement(m.List,{isPlain:!0,iconSize:"large"},(null===(n=se())||void 0===n||null===(a=n.values)||void 0===a||null===(i=a["target-environment"])||void 0===i?void 0:i.aws)&&o().createElement(m.ListItem,{icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"})},o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Amazon Web Services"),o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Account ID"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},null===(l=se())||void 0===l||null===(s=l.values)||void 0===s?void 0:s["aws-account-id"])))),(null===(c=se())||void 0===c||null===(u=c.values)||void 0===u||null===(d=u["target-environment"])||void 0===d?void 0:d.google)&&o().createElement(m.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"})},o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Google Cloud Platform"),o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},null==k?void 0:k[null===(p=se())||void 0===p||null===(f=p.values)||void 0===f?void 0:f["google-account-type"]]),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},(null===(h=se())||void 0===h||null===(b=h.values)||void 0===b?void 0:b["google-email"])||(null===(E=se())||void 0===E||null===(y=E.values)||void 0===y?void 0:y["google-domain"]))))),(null===(x=se())||void 0===x||null===(S=x.values)||void 0===S||null===(L=S["target-environment"])||void 0===L?void 0:L.azure)&&o().createElement(m.ListItem,{className:"pf-c-list__item pf-u-mt-md",icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"})},o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Microsoft Azure"),o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Subscription ID"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},null===(I=se())||void 0===I||null===(_=I.values)||void 0===_?void 0:_["azure-subscription-id"]),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Tenant ID"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},null===(Z=se())||void 0===Z||null===(D=Z.values)||void 0===D?void 0:D["azure-tenant-id"]),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Resource group"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},null===(C=se())||void 0===C||null===(z=C.values)||void 0===z?void 0:z["azure-resource-group"])))),(null===(A=se())||void 0===A||null===(O=A.values)||void 0===O||null===(P=O["target-environment"])||void 0===P?void 0:P.vsphere)&&o().createElement(m.ListItem,null,o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"VMWare"))),(null===(R=se())||void 0===R||null===(N=R.values)||void 0===N||null===(V=N["target-environment"])||void 0===V?void 0:V["guest-image"])&&o().createElement(m.ListItem,null,o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Virtualization - Guest image"))),(null===(G=se())||void 0===G||null===(j=G.values)||void 0===j||null===(q=j["target-environment"])||void 0===q?void 0:q["image-installer"])&&o().createElement(m.ListItem,null,o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Bare metal - Installer"))))),o().createElement(m.Tab,{eventKey:1,title:o().createElement(m.TabTitleText,null,"Registration"),"data-testid":"tab-registration"},"register-later-radio-button"===(null===(U=se())||void 0===U||null===(F=U.values)||void 0===F?void 0:F["register-system"])&&o().createElement(m.TextContent,null,o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Subscription"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},"Register the system later"))),"subscribe-now-radio"===(null===(W=se())||void 0===W||null===(B=W.values)||void 0===B?void 0:B["register-system"])&&(null===(M=se())||void 0===M||null===(H=M.values)||void 0===H?void 0:H.release.includes("rhel"))&&o().createElement(m.TextContent,null,o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Subscription"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},"subscribe-now-radio"===(null===(X=se())||void 0===X||null===(Q=X.values)||void 0===Q?void 0:Q["register-system"])?"Register the system on first boot":null==w?void 0:w[null===(K=se())||void 0===K||null===(Y=K.values)||void 0===Y||null===($=Y["register-system"])||void 0===$?void 0:$.title]),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Activation key"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},null===(J=se())||void 0===J||null===(ee=J.values)||void 0===ee?void 0:ee["subscription-activation"])))),o().createElement(m.Tab,{eventKey:2,title:o().createElement(m.TabTitleText,null,"System configuration"),"data-testid":"tab-system"},o().createElement(m.TextContent,null,o().createElement(m.Text,{component:m.TextVariants.h3},"Packages"),o().createElement(m.TextList,{component:m.TextListVariants.dl},o().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Chosen"),o().createElement(m.TextListItem,{component:m.TextListItemVariants.dd,"data-testid":"chosen-packages-count"},(null===(te=se())||void 0===te||null===(ne=te.values)||void 0===ne||null===(ae=ne["selected-packages"])||void 0===ae?void 0:ae.length)||0))))))};var D=n(41693),C=["label","isRequired"];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(e){var t=e.label,n=e.isRequired,i=(0,l.Z)(e,C),s=(0,v.default)(),c=s.getState,u=s.change,d=(0,D.Z)(A({label:t,isRequired:n},i)).input,p=(0,r.useState)({aws:!1,azure:!1,google:!1,vsphere:!1,"guest-image":!1,"image-installer":!1}),f=(0,g.Z)(p,2),h=f[0],b=f[1];(0,r.useEffect)((function(){var e,t;null!==(e=c())&&void 0!==e&&null!==(t=e.values)&&void 0!==t&&t[d.name]&&b(c().values[d.name])}),[]);var E=function(e){return b((function(t){var n=A(A({},t),{},(0,a.Z)({},e,!t[e]));return u(d.name,n),n}))};return o().createElement(o().Fragment,null,o().createElement(m.FormGroup,{isRequired:n,label:t,"data-testid":"target-select"},o().createElement(m.FormGroup,{label:o().createElement(m.Text,{component:m.TextVariants.small},"Public cloud"),"data-testid":"target-public"},o().createElement("div",{className:"tiles"},o().createElement(m.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-aws",title:"Amazon Web Services",icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/aws.svg"}),onClick:function(){return E("aws")},isSelected:h.aws,isStacked:!0,isDisplayLarge:!0}),o().createElement(m.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-google",title:"Google Cloud Platform",icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/google-cloud-short.svg"}),onClick:function(){return E("google")},isSelected:h.google,isStacked:!0,isDisplayLarge:!0}),o().createElement(m.Tile,{className:"tile pf-u-mr-sm","data-testid":"upload-azure",title:"Microsoft Azure",icon:o().createElement("img",{className:"provider-icon",src:"/apps/frontend-assets/partners-icons/microsoft-azure-short.svg"}),onClick:function(){return E("azure")},isSelected:h.azure,isStacked:!0,isDisplayLarge:!0}))),o().createElement(m.FormGroup,{label:o().createElement(m.Text,{component:m.TextVariants.small},"Private cloud"),"data-testid":"target-private"},o().createElement(m.Checkbox,{label:"VMWare",isChecked:h.vsphere,onChange:function(){return E("vsphere")},"aria-label":"VMWare checkbox",id:"checkbox-vmware",name:"VMWare","data-testid":"checkbox-vmware"})),o().createElement(m.FormGroup,{label:o().createElement(m.Text,{component:m.TextVariants.small},"Other"),"data-testid":"target-other"},o().createElement(m.Checkbox,{label:"Virtualization - Guest image",isChecked:h["guest-image"],onChange:function(){return E("guest-image")},"aria-label":"Virtualization guest image checkbox",id:"checkbox-guest-image",name:"Virtualization guest image","data-testid":"checkbox-guest-image"}),o().createElement(m.Checkbox,{label:"Bare metal - Installer",isChecked:h["image-installer"],onChange:function(){return E("image-installer")},"aria-label":"Bare metal installer checkbox",id:"checkbox-image-installer",name:"Bare metal installer","data-testid":"checkbox-image-installer"}))))};O.propTypes={label:p().node,isRequired:p().bool},O.defaultProps={label:"",isRequired:!1};const P=O;var R=n(93433),N=n(15861),V=n(87757),G=n.n(V),j=n(87248),q=n(93174),U=n(94086),F=n(94949),W=n(71973),B=["defaultArch"],M=function(e){return e.map((function(e){return{name:e.name,summary:e.summary}}))},H=function(e){var t=e.defaultArch,n=(0,l.Z)(e,B),a=(0,v.default)(),i=a.change,s=a.getState,c=(0,D.Z)(n).input,u=(0,r.useRef)(),d=(0,r.useState)([]),p=(0,g.Z)(d,2),f=p[0],h=p[1],b=(0,r.useState)(!0),E=(0,g.Z)(b,2),y=E[0],T=E[1],x=(0,r.useState)([]),w=(0,g.Z)(x,2),S=w[0],L=w[1],k=(0,r.useState)(!0),I=(0,g.Z)(k,2),_=I[0],Z=I[1],C=(0,r.useState)(""),z=(0,g.Z)(C,2),A=z[0],O=z[1],P=(0,r.useState)(""),V=(0,g.Z)(P,2),H=V[0],X=V[1];(0,r.useEffect)((function(){var e,t,n=null===(e=s())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["selected-packages"];n&&L(n)}),[]);var Q=(0,r.useCallback)((function(e){return function(t,n){return t.name===e?-1:n.name===e?1:t.name.startsWith(e)&&!n.name.startsWith(e)?-1:n.name.startsWith(e)&&!t.name.startsWith(e)?1:t.name<n.name?-1:n.name<t.name?1:0}})),K=(0,r.useCallback)((function(e){var t=e.sort(Q(u.current));h(t)})),Y=(0,r.useCallback)((function(e){return e.filter((function(e){return!S.some((function(t){return e.name===t.name}))}))})),$=function(){var e=(0,N.Z)(G().mark((function e(){var n,a,r,o,i,l,c;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Z.getPackages(null===(n=s())||void 0===n||null===(a=n.values)||void 0===a?void 0:a.release,(null===(r=s())||void 0===r||null===(o=r.values)||void 0===o?void 0:o.architecture)||t,u.current);case 2:i=e.sent,(l=i.data)?(c=Y(l),K(c),T(!0)):T(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=!1,t=S.map((function(t){return t.name.includes(A)?(t.isHidden=!1,e=!0):t.isHidden=!0,t}));Z(e),L(t)},ee=function(e){"Enter"===e.key&&("available"===H?(e.stopPropagation(),$()):"chosen"===H&&(e.stopPropagation(),J()))};(0,r.useEffect)((function(){return document.addEventListener("keydown",ee,!0),function(){document.removeEventListener("keydown",ee,!0)}}));var te=function(e){var t=e?S:f,n=(e?f:S).filter((function(e){return!e.selected||(e.selected=!1,t.push(e),!1)}));e?(K(n),L(t),i(c.name,M(t))):(L(n),K(f),i(c.name,M(n)))},ne=function(e){var t=[];e?(t=[].concat((0,R.Z)(f.filter((function(e){return!e.isHidden}))),(0,R.Z)(S)),L(t),K((0,R.Z)(f.filter((function(e){return e.isHidden}))))):(t=(0,R.Z)(S.filter((function(e){return e.isHidden}))),K([].concat((0,R.Z)(S.filter((function(e){return!e.isHidden}))),(0,R.Z)(f))),L(t)),i(c.name,M(t))},ae=function(e,t,n){if(n){var a=(0,R.Z)(S);a[t].selected=!S[t].selected,L(a)}else{var r=(0,R.Z)(f);r[t].selected=!f[t].selected,K(r)}};return o().createElement(m.DualListSelector,null,o().createElement(m.DualListSelectorPane,{title:"Available packages",searchInput:o().createElement(m.SearchInput,{placeholder:"Search for a package","data-testid":"search-available-pkgs-input",value:u.current,onFocus:function(){return X("available")},onBlur:function(){return X("")},onChange:function(e){u.current=e}}),actions:[o().createElement(m.Button,{"aria-label":"Search button for available packages",key:"availableSearchButton","data-testid":"search-available-pkgs-button",onClick:$},"Search")]},o().createElement(m.DualListSelectorList,{"data-testid":"available-pkgs-list"},f.length?f.map((function(e,t){return e.isHidden?null:o().createElement(m.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return ae(0,t,!1)}},o().createElement(m.TextContent,{key:"".concat(e.name,"-").concat(t)},o().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),o().createElement("small",null,e.summary)))})):o().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},y?o().createElement(o().Fragment,null,"Search above to add additional",o().createElement("br",null),"packages to your image"):"No packages found"))),o().createElement(m.DualListSelectorControlsWrapper,{"aria-label":"Selector controls"},o().createElement(m.DualListSelectorControl,{isDisabled:!f.some((function(e){return e.selected})),onClick:function(){return te(!0)},"aria-label":"Add selected",tooltipContent:"Add selected"},o().createElement(q.oR,null)),o().createElement(m.DualListSelectorControl,{isDisabled:!f.length,onClick:function(){return ne(!0)},"aria-label":"Add all",tooltipContent:"Add all"},o().createElement(U.jN,null)),o().createElement(m.DualListSelectorControl,{isDisabled:!S.length||!_,onClick:function(){return ne(!1)},"aria-label":"Remove all",tooltipContent:"Remove all"},o().createElement(F.Yw,null)),o().createElement(m.DualListSelectorControl,{onClick:function(){return te(!1)},isDisabled:!S.some((function(e){return e.selected}))||!_,"aria-label":"Remove selected",tooltipContent:"Remove selected"},o().createElement(W.fP,null))),o().createElement(m.DualListSelectorPane,{title:"Chosen packages",searchInput:o().createElement(m.SearchInput,{placeholder:"Search for a package","data-testid":"search-chosen-pkgs-input",value:A,onFocus:function(){return X("chosen")},onBlur:function(){return X("")},onChange:function(e){return O(e)}}),actions:[o().createElement(m.Button,{"aria-label":"Search button for selected packages",key:"selectedSearchButton","data-testid":"search-chosen-pkgs-button",onClick:J},"Search")],isChosen:!0},o().createElement(m.DualListSelectorList,{"data-testid":"chosen-pkgs-list"},S.length?_?S.map((function(e,t){return e.isHidden?null:o().createElement(m.DualListSelectorListItem,{key:t,isSelected:e.selected,onOptionSelect:function(e){return ae(0,t,!0)}},o().createElement(m.TextContent,{key:"".concat(e.name,"-").concat(t)},o().createElement("span",{className:"pf-c-dual-list-selector__item-text"},e.name),o().createElement("small",null,e.summary)))})):o().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages found"):o().createElement("p",{className:"pf-u-text-align-center pf-u-mt-md"},"No packages added"))))};H.propTypes={defaultArch:p().string};const X=H;var Q=n(41626),K=["Popover"],Y=function(e){var t=e.Popover,n=(0,l.Z)(e,K),a=(0,r.useRef)();return o().createElement(Q.Z,(0,i.Z)({},n,{label:o().createElement("span",{ref:a,className:"ins-c-image--builder__popover"},n.label,o().createElement(t,null))}))};Y.propTypes={Popover:p().elementType.isRequired,label:p().node};const $=Y,J=function(){var e,t,n=null===(e=(0,(0,v.default)().getState)())||void 0===e||null===(t=e.values)||void 0===t?void 0:t["azure-tenant-id"],a=new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i");return o().createElement(m.FormGroup,null,o().createElement(m.Button,{component:"a",target:"_blank",variant:"secondary",isDisabled:!a.test(n),href:"https://login.microsoftonline.com/"+n+"/oauth2/v2.0/authorize?client_id=b94bb246-b02c-4985-9c22-d44e66f657f4&scope=openid&response_type=code&response_mode=query&redirect_uri=https://portal.azure.com"},"Authorize Image Builder"))},ee=function(){var e=(0,v.default)().change,t=(0,r.useState)(),n=(0,g.Z)(t,2),a=n[0],i=n[1];return(0,r.useEffect)((function(){return(0,N.Z)(G().mark((function t(){var n,a,r,o,l,s,c,u;return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=insights)||void 0===n||null===(a=n.chrome)||void 0===a||null===(r=a.auth)||void 0===r?void 0:r.getUser();case 2:u=t.sent,i(null==u||null===(o=u.identity)||void 0===o||null===(l=o.internal)||void 0===l?void 0:l.org_id),e("subscription-organization",null==u||null===(s=u.identity)||void 0===s||null===(c=s.internal)||void 0===c?void 0:c.org_id);case 5:case"end":return t.stop()}}),t)})))(),function(){i(void 0)}}),[]),o().createElement(m.Form,null,o().createElement(m.FormGroup,{label:"Organization ID",fieldId:"organization-id","data-testid":"organization-id"},a?o().createElement(m.TextInput,{isDisabled:!0,type:"text",id:"organization-id",name:"organization-id",value:a}):o().createElement(m.Spinner,{isSVG:!0,size:"md"})))};var te=n(54915),ne=["schema","onSubmit","onClose","customComponentMapper","defaultArch","className"];function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=function(e){var t=e.schema,n=e.onSubmit,a=e.onClose,r=e.customComponentMapper,d=e.defaultArch,p=e.className,g=(0,l.Z)(e,ne);return t?o().createElement(s.Z,(0,i.Z)({schema:t,className:"image-builder".concat(p?" ".concat(p):""),subscription:{values:!0},FormTemplate:function(e){return o().createElement(c.ZP,(0,i.Z)({},e,{showFormControls:!1}))},onSubmit:function(e){return n(e)},componentMapper:re(re({},u.YS),{},{review:Z,output:P,select:te.Z,"package-selector":{component:X,defaultArch:d},"radio-popover":$,"azure-auth-button":J,"organization-id":ee},r),onCancel:a},g)):o().createElement(m.Spinner,null)};oe.propTypes={schema:p().object,onSubmit:p().func.isRequired,onClose:p().func.isRequired,customComponentMapper:p().shape((0,a.Z)({},p().string,p().oneOfType([p().node,p().shape({component:p().node})]))),defaultArch:p().string,className:p().string};const ie=oe;var le=n(55356),se=n(15265);const ce={title:"Amazon Web Services",customTitle:o().createElement(m.Title,{headingLevel:"h1",size:"xl"},"Target environment - Amazon Web Service"),name:"aws-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return E(t,{skipAws:!0})},fields:[{component:f.Z.PLAIN_TEXT,name:"plain-text-component",label:o().createElement("p",null,"Your image will be uploaded to a temporary account on Amazon Web Services. ",o().createElement("br",null),"The image will be shared with the account you provide below. ",o().createElement("br",null),"Within the next 14 days you will need to copy the shared image to your own account. After 14 days it will be unavailable and will have to be regenerated.")},{component:f.Z.TEXT_FIELD,name:"aws-account-id",className:"pf-u-w-25","data-testid":"aws-account-id",type:"text",label:"AWS account ID",isRequired:!0,validate:[{type:h.Z.REQUIRED},{type:h.Z.EXACT_LENGTH,threshold:12}]}]},ue={title:"Microsoft Azure",customTitle:o().createElement(m.Title,{headingLevel:"h1",size:"xl"},"Target environment - Microsoft Azure"),name:"ms-azure-target-env",substepOf:"Target environment",nextStep:function(e){var t=e.values;return E(t,{skipAws:!0,skipGoogle:!0,skipAzure:!0})},fields:[{component:f.Z.PLAIN_TEXT,name:"azure-text-component",label:o().createElement(o().Fragment,null,o().createElement(m.Text,null,"Image Builder sends an image to an authorized Azure account."),o().createElement(m.Title,{headingLevel:"h3"},"Authorizing an Azure account"),o().createElement(m.Text,null,'To authorize Image Builder to push images to Microsoft Azure, the account owner must configure Image Builder as an authorized application for a specific tenant ID and give it the role of "Contributor" to at least one resource group.',o().createElement("br",null)),o().createElement("small",null,o().createElement(m.Button,{component:"a",target:"_blank",variant:"link",icon:o().createElement(se.LA,null),iconPosition:"right",isInline:!0,href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow"},"Learn more about OAuth 2.0")),o().createElement(m.Title,{headingLevel:"h2"},"Image Destination"),o().createElement(m.Text,null,"Your image will be uploaded to the resource group in the subscription you specify."))},{component:f.Z.TEXT_FIELD,name:"azure-tenant-id","data-testid":"azure-tenant-id",type:"text",label:"Tenant GUID",required:!0,isRequired:!0,validate:[{type:h.Z.REQUIRED},{type:h.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid tenant GUID"}]},{component:"azure-auth-button",name:"azure-auth-button","data-testid":"azure-auth-button",required:!0,isRequired:!0},{component:f.Z.TEXT_FIELD,name:"azure-subscription-id","data-testid":"azure-subscription-id",type:"text",label:"Subscription GUID",isRequired:!0,validate:[{type:h.Z.REQUIRED},{type:h.Z.PATTERN,pattern:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,message:"Please enter a valid subscription GUID"}]},{component:f.Z.TEXT_FIELD,name:"azure-resource-group","data-testid":"azure-resource-group",type:"text",label:"Resource group",isRequired:!0,validate:[{type:h.Z.REQUIRED},{type:h.Z.PATTERN,pattern:/^[-\w._()]+[-\w_()]$/,message:"Resource group names only allow alphanumeric characters, periods, underscores, hyphens, and parenthesis and cannot end in a period"}]}]},me={title:"Packages",name:"packages",nextStep:"review",fields:[{component:f.Z.PLAIN_TEXT,name:"packages-text-component",label:o().createElement(m.Text,null,"Add optional additional packages to your image by searching available packages.")},{component:"package-selector",name:"selected-packages",label:"Available options"}]};var de=n(6468),pe=n(70363),ge=function(e){var t=e.buttonLabels,n=t.cancel,a=t.submit,i=t.back,l=(0,r.useState)(!1),s=(0,g.Z)(l,2),c=s[0],u=s[1],d=(0,r.useContext)(pe.default),p=d.handlePrev,v=d.formOptions;return o().createElement(de.lP,null,(function(){return o().createElement(o().Fragment,null,o().createElement(m.Button,{variant:"primary",type:"button",isDisabled:!v.valid||v.getState().validating||c,isLoading:c,onClick:function(){v.onSubmit({values:v.getState().values,setIsSaving:u})}},c?"Creating image":a),o().createElement(m.Button,{type:"button",variant:"secondary",onClick:p,isDisabled:c},i),o().createElement("div",{className:"pf-c-wizard__footer-cancel"},o().createElement(m.Button,{type:"button",variant:"link",onClick:v.onCancel,isDisabled:c},n)))}))};ge.propTypes={buttonLabels:p().shape({cancel:p().node,submit:p().node,back:p().node}),isSaving:p().bool};const ve={name:"review",title:"Review",buttons:ge,fields:[{name:"review",component:"review"}]};var fe=n(28216),he=n(18247),be=n(83215);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Te=function(){var e=(0,fe.I0)(),t=(0,le.useNavigate)();return o().createElement(ie,{onClose:function(){return t("/")},onSubmit:function(n){var a=n.values,r=n.setIsSaving;r((function(){return!0}));var o=function(e){var t,n,a,r,o,i,l,s={packages:null===(t=e["selected-packages"])||void 0===t?void 0:t.map((function(e){return e.name}))};e["subscription-activation"]&&(s.subscription={"activation-key":e["subscription-activation"],insights:!0,organization:Number(e["subscription-organization"]),"server-url":"subscription.rhsm.redhat.com","base-url":"https://cdn.redhat.com/"});var c=[];if(null!==(n=e["target-environment"])&&void 0!==n&&n.aws){var u={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"ami",upload_request:{type:"aws",options:{share_with_accounts:[e["aws-account-id"]]}}}],customizations:s};c.push(u)}if(null!==(a=e["target-environment"])&&void 0!==a&&a.google){var m="";switch(e["google-account-type"]){case"googleAccount":m="user:".concat(e["google-email"]);break;case"serviceAccount":m="serviceAccount:".concat(e["google-email"]);break;case"googleGroup":m="group:".concat(e["google-email"]);break;case"domain":m="domain:".concat(e["google-domain"])}var d={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"vhd",upload_request:{type:"gcp",options:{share_with_accounts:[m]}}}],customizations:s};c.push(d)}if(null!==(r=e["target-environment"])&&void 0!==r&&r.azure){var p={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"vhd",upload_request:{type:"azure",options:{tenant_id:e["azure-tenant-id"],subscription_id:e["azure-subscription-id"],resource_group:e["azure-resource-group"]}}}],customizations:s};c.push(p)}if(null!==(o=e["target-environment"])&&void 0!==o&&o.vsphere){var g={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"vsphere",upload_request:{type:"aws.s3",options:{}}}],customizations:s};c.push(g)}if(null!==(i=e["target-environment"])&&void 0!==i&&i["guest-image"]){var v={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"guest-image",upload_request:{type:"aws.s3",options:{}}}],customizations:s};c.push(v)}if(null!==(l=e["target-environment"])&&void 0!==l&&l["image-installer"]){var f={distribution:e.release,image_requests:[{architecture:"x86_64",image_type:"image-installer",upload_request:{type:"aws.s3",options:{}}}],customizations:s};c.push(f)}return c}(a);Promise.all(o.map((function(t){return j.Z.composeImage(t).then((function(n){e((0,he.tE)(ye(ye({},n),{},{request:t,image_status:{status:"pending"}}),!0))}))}))).then((function(){t("/"),e((0,be.wN)({variant:"success",title:"Your image is being created"})),r(!1)})).catch((function(t){e((0,be.wN)({variant:"danger",title:"Your image could not be created",description:"Status code "+t.response.status+": "+t.response.statusText})),r(!1)}))},defaultArch:"x86_64",schema:{fields:[{component:f.Z.WIZARD,name:"image-builder-wizard",className:"image_builder",isDynamic:!0,inModal:!0,buttonLabels:{submit:"Create image"},showTitles:!0,title:"Create image",crossroads:["target-environment","release"],description:o().createElement(o().Fragment,null,"Create a RHEL image and push it to cloud providers. ",o().createElement(m.Button,{component:"a",target:"_blank",variant:"link",icon:o().createElement(se.LA,null),iconPosition:"right",isInline:!0,href:"\nhttps://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/uploading_a_customized_rhel_system_image_to_cloud_environments/index "},"Documentation")),fields:[x,ce,_,ue,S,me,ve]}]}})}},87248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var a=n(15861),r=n(87757),o=n.n(r),i=n(9669),l=n.n(i),s=n(58061),c={headers:{"Content-Type":"application/json"}};function u(){return(u=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().post(s.D.concat("/compose"),t,c);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,a.Z)(o().mark((function e(t,n){var a,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({limit:t,offset:n}),r="/composes?"+a.toString(),e.next=4,l().get(s.D.concat(r));case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=(0,a.Z)(o().mark((function e(t){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/composes/"+t,e.next=3,l().get(s.D.concat(n));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=(0,a.Z)(o().mark((function e(t,n,a){var r,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams({distribution:t,architecture:n,search:a}),i="/packages?"+r.toString(),e.next=4,l().get(s.D.concat(i));case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=(0,a.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,l().get(s.D.concat("/version"));case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const v={composeImage:function(e){return u.apply(this,arguments)},getComposes:function(e,t){return m.apply(this,arguments)},getComposeStatus:function(e){return d.apply(this,arguments)},getPackages:function(e,t,n){return p.apply(this,arguments)},getVersion:function(){return g.apply(this,arguments)}}},58061:(e,t,n)=>{"use strict";n.d(t,{D:()=>a,F:()=>r});var a="/api/image-builder/v1",r="rhel-85"},18247:(e,t,n)=>{"use strict";n.d(t,{tE:()=>c,ZP:()=>d});var a=n(15861),r=n(87757),o=n.n(r),i=n(87248),l=n(26698),s=function(e){return{type:l.Z.COMPOSE_FAILED,payload:{error:e}}},c=function(e,t){return{type:l.Z.COMPOSE_ADDED,payload:{compose:e,insert:t}}},u=function(e,t){return{type:l.Z.COMPOSE_UPDATED_STATUS,payload:{id:e,status:t}}},m=function(e){return function(){var t=(0,a.Z)(o().mark((function t(n){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.Z.getComposeStatus(e);case 2:a=t.sent,n(u(e,a.image_status));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};const d={composesGet:function(e,t){return function(){var n=(0,a.Z)(o().mark((function n(a){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.Z.getComposes(e,t);case 2:(r=n.sent).data.map((function(e){a(c(e,!1)),a(m(e.id))})),a((o=r.meta.count,{type:l.Z.COMPOSES_UPDATED_COUNT,payload:{count:o}}));case 5:case"end":return n.stop()}var o}),n)})));return function(e){return n.apply(this,arguments)}}()},composeStart:function(e){return function(){var t=(0,a.Z)(o().mark((function t(n){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.Z.composeImage(e),t.abrupt("return",a.then((function(t){var a=Object.assign({},t,{request:e},{image_status:{status:"pending"}});n(c(a,!0))})).catch((function(e){500===e.response.status?n(s("Error: Something went wrong serverside")):n(s("Error: Something went wrong with the compose"))})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},composeUpdated:function(e){return{type:l.Z.COMPOSE_UPDATED,payload:{compose:e}}},composeGetStatus:m,setRelease:function(e){var t=e.arch,n=e.distro;return{type:l.Z.SET_RELEASE,payload:{arch:t,distro:n}}},setUploadDestinations:function(e){var t=e.aws,n=e.azure,a=e.google;return{type:l.Z.SET_UPLOAD_DESTINATIONS,payload:{aws:t,azure:n,google:a}}},setUploadAWS:function(e){var t=e.shareWithAccounts;return{type:l.Z.SET_UPLOAD_AWS,payload:{shareWithAccounts:t}}},setUploadAzure:function(e){var t=e.tenantId,n=e.subscriptionId,a=e.resourceGroup;return{type:l.Z.SET_UPLOAD_AZURE,payload:{tenantId:t,subscriptionId:n,resourceGroup:a}}},setUploadGoogle:function(e){var t=e.accountType,n=e.shareWithAccounts;return{type:l.Z.SET_UPLOAD_GOOGLE,payload:{accountType:t,shareWithAccounts:n}}},setSelectedPackages:function(e){return{type:l.Z.SET_SELECTED_PACKAGES,payload:e}},setSubscription:function(e){var t=e.activationKey,n=e.insights,a=e.organization;return{type:l.Z.SET_SUBSCRIPTION,payload:{activationKey:t,insights:n,organization:a}}},setSubscribeNow:function(e){return{type:l.Z.SET_SUBSCRIBE_NOW,payload:e}}}},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{},70347:()=>{},11452:()=>{},10497:()=>{},32857:()=>{},93818:()=>{},94498:()=>{},54476:()=>{},28992:()=>{},40837:()=>{},90479:()=>{},78752:()=>{},74282:()=>{},25238:()=>{},91993:()=>{},99624:()=>{},36974:()=>{},27479:()=>{},93661:()=>{},56024:()=>{},43390:()=>{},314:()=>{},40209:()=>{},87234:()=>{},38299:()=>{},72816:()=>{}}]);
//# sourceMappingURL=../sourcemaps/757.87473020ee2f83c8f778f45d186098ec.js.map